<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.102.3" /><link rel="canonical" type="text/html" href="/docs/reference/blocks/google-workspace/gmail/send-email/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Send Email | Cortex</title><meta property="og:title" content="Send Email" />
<meta property="og:description" content="Blocks related to sending Emails." />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/reference/blocks/google-workspace/gmail/send-email/" /><meta property="og:site_name" content="Cortex" />

<meta itemprop="name" content="Send Email">
<meta itemprop="description" content="Blocks related to sending Emails."><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Send Email"/>
<meta name="twitter:description" content="Blocks related to sending Emails."/>





<link rel="preload" href="/scss/main.min.0891f4e5e1c0bde61105cc497e03ebcbaca32a0d8daea6962bff385b48328a50.css" as="style">
<link href="/scss/main.min.0891f4e5e1c0bde61105cc497e03ebcbaca32a0d8daea6962bff385b48328a50.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg id="Layer_4_copy" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1388 475.1" style="enable-background:new 0 0 1388 475.1"><style>.st0{fill:#3b8fce}.st1{fill:#262056}.st2{fill:#a1c429}.st3{fill:#fff}.st4{fill:url(#SVGID_1_)}.st5{opacity:.6;fill:url(#SVGID_2_)}.st6{filter:url(#Adobe_OpacityMaskFilter)}.st7{fill:url(#SVGID_4_)}.st8{mask:url(#SVGID_3_);fill:#fff}.st9{fill:#3f3f3e}</style><path class="st0" d="M122.1 231.7c0-15.7 3.6-30.5 9.9-43.8l-81.1-46.8c-22.9 43.5-28.5 93.3-15.7 141 13.5 50.3 45.7 92.3 90.8 118.3 29 16.7 56.9 24.9 89.6 26v-93.7c-52.3-4-93.5-47.6-93.5-101z"/><path class="st1" d="M223.5 130.3c34.7.0 65.3 17.5 83.6 44.1l81.1-46.8c-35.6-56.2-98-90.8-164.9-90.8-34 0-67.6 9-97.3 26.1-29 16.7-50 36.8-67.3 64.6l81.1 46.8c18.4-26.5 49-44 83.7-44z"/><path class="st2" d="M396.1 141.1 315 188c6.3 13.2 9.9 28.1 9.9 43.7.0 53.3-41.2 97-93.5 101v93.7c103.8-4.1 187-89.9 187-194.7C418.4 198.2 411.5 170 396.1 141.1z"/><g><path class="st3" d="M223.5 231.7l-65.8-38c-21 36.4-8.5 82.9 27.8 103.9 12.1 7 24 10.2 38 10.2V231.7z"/></g><g><path class="st3" d="M223.5 231.7l65.8-38c-21-36.4-67.5-48.8-103.9-27.8-12.1 7-20.8 15.7-27.8 27.8l65.9 38z"/></g><g><path class="st3" d="M223.5 231.7v76c42 0 76-34 76-76 0-14-3.2-25.9-10.2-38l-65.8 38z"/></g><g><radialGradient id="SVGID_1_" cx="223.5157" cy="231.6926" r="76.1085" gradientUnits="userSpaceOnUse"><stop offset="0" style="stop-color:#969695"/><stop offset="1" style="stop-color:#3F3F3E"/></radialGradient><path class="st4" d="M147.4 231.7c0-42 34.1-76.1 76.1-76.1s76.1 34.1 76.1 76.1-34.1 76.1-76.1 76.1C181.5 307.8 147.4 273.7 147.4 231.7z"/><linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="223.5157" y1="155.5859" x2="223.5157" y2="307.7993"><stop offset="0" style="stop-color:#FFFFFF"/><stop offset="1" style="stop-color:#3F3F3E"/></linearGradient><path class="st5" d="M147.4 231.7c0-42 34.1-76.1 76.1-76.1s76.1 34.1 76.1 76.1-34.1 76.1-76.1 76.1C181.5 307.8 147.4 273.7 147.4 231.7z"/><defs><filter id="Adobe_OpacityMaskFilter" filterUnits="userSpaceOnUse" x="177.2" y="172.1" width="92.7" height="59.5"><feColorMatrix type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"/></filter></defs><mask maskUnits="userSpaceOnUse" x="177.2" y="172.1" width="92.7" height="59.5" id="SVGID_3_"><g class="st6"><linearGradient id="SVGID_4_" gradientUnits="userSpaceOnUse" x1="220.0409" y1="123.6788" x2="220.0409" y2="238.3832"><stop offset="0" style="stop-color:#FFFFFF"/><stop offset="1" style="stop-color:#000000"/></linearGradient><rect x="158.4" y="123.7" class="st7" width="123.3" height="114.7"/></g></mask><path class="st8" d="M177.2 201.9c0-16.5 20.7-29.8 46.3-29.8s46.3 13.3 46.3 29.8c0 16.4-20.7 29.8-46.3 29.8s-46.3-13.3-46.3-29.8z"/></g><g><path class="st9" d="M549.7 146c42.6.0 62.7 24.3 62.7 24.3l-17.9 27.8s-17-17.6-42.6-17.6c-30.1.0-49.6 22.7-49.6 50.6.0 27.5 19.8 51.2 50.9 51.2 27.5.0 48-20.8 48-20.8l15.7 28.8s-23.4 26.5-67.2 26.5c-54.1.0-88.6-38.1-88.6-85.4.0-46.4 34.5-85.4 88.6-85.4z"/><path class="st9" d="M697.7 146c49.9.0 89.9 35.5 89.9 85.4.0 50.2-40 85.4-89.6 85.4-49.9.0-89.9-35.2-89.9-85.4.0-49.9 40-85.4 89.6-85.4zM698 282.3c26.3.0 48.3-20.5 48.3-50.9.0-30.1-22.1-50.9-48.3-50.9-26.6.0-48.6 20.8-48.6 50.9.0 30.4 22.1 50.9 48.6 50.9z"/><path class="st9" d="M796.6 149.8h39V178c0 6.1-.6 11.5-.6 11.5h.6c7.4-23.4 26.9-41.9 51.9-41.9 3.8.0 7.3.6 7.3.6v40s-4.2-.6-9.6-.6c-17.3.0-36.8 9.9-44.5 34.2-2.6 8-3.5 16.9-3.5 26.6V313h-40.6V149.8z"/><path class="st9" d="M904.2 105.4h40.7v47H982v32.3h-37.1v63.4c0 26.9 21.1 30.7 32.3 30.7 4.5.0 7.4-.6 7.4-.6v35.5s-4.8 1-12.5 1c-22.7.0-67.9-6.7-67.9-61.4V105.4z"/><path class="st9" d="M1065.5 146c47 0 72.3 34.2 72.3 77.4.0 4.8-1 15.7-1 15.7h-112.6c2.6 28.5 24.6 43.2 49 43.2 26.2.0 47.1-17.9 47.1-17.9l15.7 29.1s-25 23.4-65.6 23.4c-54.1.0-87.7-39-87.7-85.4C982.6 181.2 1016.9 146 1065.5 146zM1096.9 211.3c-.6-22.1-14.4-33.9-32.3-33.9-20.8.0-35.2 12.8-39 33.9h71.3z"/><path class="st9" d="M1236 230.5l52.5-80.6h-46.1l-25.3 44.5c-2.6 4.2-5.4 10.2-5.4 10.2h-.6s-2.9-6.1-5.4-10.2l-25.3-44.5h-46.1l52.5 80.6L1133 313h45.1l28.5-47.4c2.3-3.5 4.5-8.6 4.5-8.6h.6s2.3 5.1 4.5 8.6l28.5 47.4h45.1L1236 230.5z"/><g><path class="st9" d="M1313.8 149.8c9.5.0 17.2 7.7 17.2 17.4.0 9.8-7.6 17.5-17.2 17.5-9.4.0-16.9-7.7-16.9-17.5C1296.8 157.6 1304.4 149.8 1313.8 149.8zm0 32.3c8.2.0 14.4-6.5 14.4-14.9.0-8.3-6.2-14.8-14.4-14.8-8 0-14.1 6.5-14.1 14.8C1299.6 175.6 1305.8 182.1 1313.8 182.1zM1308.1 157.9h6.7c3.3.0 5.6 2.2 5.6 5.6.0 2.8-1.8 4.5-3.5 4.9v.1s.2.2.6 1.1l3.6 7.1h-3l-3.7-7.6h-3.6v7.6h-2.7V157.9zM1314.3 166.9c2 0 3.3-1.3 3.3-3.5.0-2.1-1.3-3.3-3.3-3.3h-3.5v6.8h3.5z"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Cortex</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a id="documentation" class="nav-link" href="/docs/" ><span>Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link" href="/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a id="community" class="nav-link" href="https://community.cortex.co.uk/" target="_blank" ><span>Community</span></a>
			</li>
			
			
			<li class="nav-item dropdown d-block pl-2">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Releases
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="http://v2022.docs.cortex-ia.com/">v2022 (latest)</a>
	
	<a class="dropdown-item" href="https://community.cortex.co.uk/">v7.2</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.39efe12802d34b814e8e4187eef2da9a.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="50"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/reference/blocks/google-workspace/gmail/send-email/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Send Email</h1>
<div class="lead">Blocks related to sending Emails.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-95040e1fcd955598063044871641bdbf">Send Email Using Gmail</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-95040e1fcd955598063044871641bdbf">1 - Send Email Using Gmail</h1>
    <div class="lead">Sends an email using the SMTP server hosted by Gmail.</div>
	
<figure class="block-icon">
    <img src=" /blocks/google-workspace-send-email-using-gmail-block-icon.png "
         alt="Icon"/> 
</figure>

<h1 id="send-email-using-gmail">Send Email Using Gmail</h1>
<p class="namespace">(Cortex.Blocks.GoogleWorkspace.Gmail.SendEmail.SendEmailUsingGmailBlock)</p>
<h2 id="description">Description</h2>
<p>Connects to the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted by <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> using the specified <a href="#gmail-session-details">Gmail Session Details</a>, and sends an <a href="#email-message">Email Message</a>.</p>
<p><a href="#close-session">Close Session</a> can be specified to choose whether the connection to the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted by <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> is closed or is kept open for use on subsequent Send Email Using Gmail blocks.</p>
<h2 id="examples">Examples</h2>
<p>Sending emails using a username and password is not recommended and is being phased out by <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a>. Using a username and password will currently only work for <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> accounts associated with a Google Workspace that has access enabled for less secure apps. Instead, it is recommended to use an app password or OAuth, for more information, see <a href="https://support.google.com/accounts/answer/6010255">Less Secure Apps</a>.</p>
<p>In the following examples, where a <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> is used in the <a href="#gmail-session-details">Gmail Session Details</a>, the <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property can be either the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password.</p>
<p>For more information, see <a href="#setting-credentials">Setting Credentials</a>.</p>
<h3 id="sending-an-email-to-a-single-recipient">Sending an email to a single recipient</h3>
<p>This example will send an email from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code>. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be to set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information about when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</p>
<h4 id="properties">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;:  [{&quot;Name&quot;:  null,  &quot;Address&quot;:  &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br><code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-to-multiple-recipients">Sending an email to multiple recipients</h3>
<p>This example will send an email from <code>sender@gmail.com</code> to <code>recipient1@outlook.com</code>, <code>recipient2@outlook.com</code> and <code>recipient3@outlook.com</code>. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information about when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</p>
<h4 id="properties-1">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;:  [{&quot;Name&quot;:  null,  &quot;Address&quot;:  &quot;recipient1@outlook.com&quot;},  {&quot;Name&quot;:  null,  &quot;Address&quot;:  &quot;recipient2@outlook.com&quot;}, {&quot;Name&quot;: null, &quot;Address&quot;: &quot;recipient3@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient1@outlook.com&quot;), new EmailAddress(&quot;recipient2@outlook.com&quot;), new EmailAddress(&quot;recipient3@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-1">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient1@outlook.com</code>, <code>recipient2@outlook.com</code> and <code>recipient3@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-with-a-cc-or-bcc-recipient">Sending an email with a CC or BCC recipient</h3>
<p>This example will send an email from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with <code>cc@outlook.com</code> and <code>bcc@outlook.com</code> as the <a href="/docs/reference/glossary/a-e/#cc">CC</a> and <a href="/docs/reference/glossary/a-e/#bcc">BCC</a> recipients for the email respectively. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information about when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</p>
<h4 id="properties-2">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;cc@outlook.com&quot;}], &quot;Bcc&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;bcc@outlook.com&quot;}], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;cc@outlook.com&quot;) }, bcc: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;bcc@outlook.com&quot;) }, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-2">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>. Both <code>cc@outlook.com</code> and <code>bcc@outlook.com</code> will also recieve copies of the email as they are listed as <a href="/docs/reference/glossary/a-e/#cc">CC</a> and <a href="/docs/reference/glossary/a-e/#bcc">BCC</a> recipients, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-with-multiple-cc-or-bcc-recipients">Sending an email with multiple CC or BCC recipients</h3>
<p>This example will send an email from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with <code>cc1@outlook.com</code> and <code>cc2@outlook.com</code> as the <a href="/docs/reference/glossary/a-e/#cc">CC</a> recipients and <code>bcc1@outlook.com</code> and <code>bcc2@outlook.com</code> as the <a href="/docs/reference/glossary/a-e/#bcc">BCC</a> recipients for the email. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information about when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</p>
<h4 id="properties-3">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;cc1@outlook.com&quot;}, {&quot;Name&quot;: null, &quot;Address&quot;: &quot;cc2@outlook.com&quot;}], &quot;Bcc&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;bcc1@outlook.com&quot;}, {&quot;Name&quot;: null, &quot;Address&quot;: &quot;bcc2@outlook.com&quot;}], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;cc1@outlook.com&quot;), new EmailAddress(&quot;cc2@outlook.com&quot;) }, bcc: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;bcc1@outlook.com&quot;), new EmailAddress(&quot;bcc2@outlook.com&quot;) }, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-3">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>. Both <code>cc1@outlook.com</code> and <code>cc2@outlook.com</code> will also recieve copies of the email as they are listed as <a href="/docs/reference/glossary/a-e/#cc">CC</a> recipients, and both <code>bcc1@outlook.com</code> and <code>bcc2@outlook.com</code> will recieve copies of the email as they are listed as <a href="/docs/reference/glossary/a-e/#bcc">BCC</a> recipients. Finally, the session is closed.</p>
<hr>
<h3 id="sending-an-email-with-a-different-priority">Sending an email with a different priority</h3>
<p>This example will send an email with <a href="/docs/reference/data-types/email/emailmessagepriority/#urgent">Urgent</a> priority from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code>. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information on:</p>
<ul>
<li>What priorities an email can be sent as, see <a href="/docs/reference/data-types/email/emailmessagepriority">EmailMessagePriority</a></li>
<li>The effect of changing the <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> of the <a href="#email-message">Email Message</a>, see <a href="#how-does-priority-affect-sending-an-email">How does Priority affect sending an email?</a></li>
<li>When <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</li>
</ul>
<h4 id="properties-4">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: &quot;EmailMessagePriority.Urgent&quot;, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: EmailMessagePriority.Urgent, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> is <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-4">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#urgent">Urgent</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-with-an-html-body">Sending an email with an HTML body</h3>
<p>This example will send an email with an <a href="/docs/reference/data-types/email/emailmessagebodyformat/#html">HTML</a> body from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code>. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information on:</p>
<ul>
<li>What other body formats an email can be sent with, see <a href="/docs/reference/data-types/email/emailmessagebodyformat">EmailMessageBodyFormat</a></li>
<li>The effect of changing the <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> of the <a href="#email-message">Email Message</a>, see <a href="#how-does-bodyformat-affect-sending-an-email">How does BodyFormat affect sending an email?</a></li>
<li>When <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</li>
</ul>
<h4 id="properties-5">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: &quot;EmailMessageBodyFormat.Html&quot;, &quot;Body&quot;: &quot;&lt;h1&gt;Example email body&lt;/h1&gt;&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: EmailMessageBodyFormat.Html, body: &quot;&lt;h1&gt;Example email body&lt;/h1&gt;&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br> As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> is <code>null</code>, the email will be sent with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-5">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and an <a href="/docs/reference/data-types/email/emailmessagebodyformat/#html">HTML</a> body of <code>&quot;&lt;h1&gt;Example email body&lt;/h1&gt;&quot;</code>, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-with-a-single-attachment">Sending an email with a single attachment</h3>
<p>This example will send an email with a single attachment, <code>attachment.txt</code>, from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code>. The attachment is located at <code>C:\attachment.txt</code> on the server executing the flow. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information on:</p>
<ul>
<li>Email attachments, see <a href="#attachments">Attachments</a></li>
<li>When <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</li>
</ul>
<h4 id="properties-6">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: [&quot;C:\\attachment.txt&quot;]}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: new List&lt;string&gt;(){ @&quot;C:\attachment.txt&quot; })</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.<br><br>The <a href="#attachments">Attachments</a> are added to the email by providing file paths pointing to the files to be attached to the email.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-6">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority containing a text file attachment, <code>attachment.txt</code>, is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-with-multiple-attachments">Sending an email with multiple attachments</h3>
<p>This example will send an email with mutiple attachments, <code>attachment1.txt</code> and <code>attachment2.txt</code> from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code>.  The attachments are located at the paths <code>C:\attachment1.txt</code> and <code>C:\attachment2.txt</code> on the server executing the flow. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information on:</p>
<ul>
<li>Email attachments, see <a href="#attachments">Attachments</a></li>
<li>When <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</li>
</ul>
<h4 id="properties-7">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;: [{&quot;Name&quot;: null, &quot;Address&quot;: &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: [&quot;C:\\attachment1.txt&quot;, &quot;C:\\attachment2.txt&quot;]}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: new List&lt;string&gt;(){ @&quot;C:\attachment1.txt&quot;, @&quot;C:\attachment2.txt&quot; })</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.<br><br>The <a href="#attachments">Attachments</a> are added to the email by providing file paths pointing to the files to be attached to the email.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-7">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority containing two text file attachments, <code>attachment1.txt</code> and <code>attachment2.txt</code>, is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-with-usessl-set-to-false">Sending an email with UseSsl set to false</h3>
<p>This example will send an email from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code>. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>587</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be set to <code>false</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information on when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</p>
<h4 id="properties-8">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;:  [{&quot;Name&quot;:  null,  &quot;Address&quot;:  &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br><code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 587, &quot;UseSsl&quot;: false}, &quot;Credentials&quot;: {&quot;Domain&quot;: null, &quot;Username&quot;: &quot;sender@gmail.com&quot;, &quot;Password&quot;: &quot;encryptedPassword&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 587, false), credentials: new UserCredentials(&quot;sender@gmail.com&quot;, &quot;encryptedPassword&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> can be the password associated with the username (if the account is associated with a Google Workspace with access enabled for less secure apps) or an app password, for more information, see <a href="#setting-credentials">Setting Credentials</a>.<br><br>The <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> property must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-8">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>, and then the session is closed.</p>
<hr>
<h3 id="sending-an-email-using-oauth">Sending an email using OAuth</h3>
<p>This example will send an email from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code>. The example uses the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted at <code>smtp.gmail.com</code> on <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> <code>465</code> which requires <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> to be to set to <code>true</code> within the <a href="#gmail-session-details">Gmail Session Details</a>.</p>
<p>For more information about when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</p>
<p>The authentication mechanism used in this example is OAuth, the specific authentication flow used is often referred to as &ldquo;Two-Legged OAuth&rdquo;. Therefore, for this example to work correctly:</p>
<ul>
<li>Credentials provided must be for a <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> account connected to a Google Workspace</li>
<li>Credentials in <a href="#gmail-session-details">Gmail Session Details</a> must be a <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> which requires:
<ul>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a></li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepassword">CertificatePassword</a></li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#fromaddress">FromAddress</a></li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#clientid">ClientId</a></li>
</ul>
</li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> must be a path pointing to a certificate accessible from the server executing the flow</li>
</ul>
<p>For more information on:</p>
<ul>
<li>What each of the properties in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> needs to be, see <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a></li>
<li>Using a certificate file, see <a href="#certificate-files">Certificate Files</a></li>
<li>How to set up the Gmail account so that this authentication mechanism can be used, see <a href="/docs/reference/concepts/working-with/email/authentication/#setting-up-a-gmail-account-for-oauth-authentication">Setting up a Gmail account for OAuth authentication</a></li>
</ul>
<h4 id="properties-9">Properties</h4>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#email-message">Email Message</a></td>
<td><code>($)EmailMessage</code> with value <code>{&quot;To&quot;:  [{&quot;Name&quot;:  null,  &quot;Address&quot;:  &quot;recipient@outlook.com&quot;}], &quot;From&quot;: {&quot;Name&quot;: null, &quot;Address&quot;: &quot;sender@gmail.com&quot;}, &quot;Cc&quot;: [], &quot;Bcc&quot;: [], &quot;Priority&quot;: null, &quot;Subject&quot;: &quot;Example email subject&quot;, &quot;BodyFormat&quot;: null, &quot;Body&quot;: &quot;Example email body&quot;, &quot;Attachments&quot;: []}</code><br><br>In this example <code>($)EmailMessage</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br><code>new EmailMessage(to: new List&lt;EmailAddress&gt;(){ new EmailAddress(&quot;recipient@outlook.com&quot;) }, from: new EmailAddress(&quot;sender@gmail.com&quot;), cc: null, bcc: null, priority: null, subject: &quot;Example email subject&quot;, bodyFormat: null, body: &quot;Example email body&quot;, attachments: null)</code></td>
<td><code>($)EmailMessage</code> is a variable of type <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a><br><br>As <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are <code>null</code>, the email will be sent with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body and <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority.</td>
</tr>
<tr>
<td><a href="#gmail-session-details">Gmail Session Details</a></td>
<td><code>($)GmailSessionDetails</code> with value <code>{&quot;ServerDetails&quot;: {&quot;Host&quot;: &quot;smtp.gmail.com&quot;, &quot;Port&quot;: 465, &quot;UseSsl&quot;: true}, &quot;Credentials&quot;: {&quot;CertificatePath&quot;: &quot;C:\\certificate.p12&quot;, &quot;CertificatePassword&quot;: &quot;encryptedPassword&quot;, &quot;FromAddress&quot;: &quot;sender@gmail.com&quot;, &quot;ClientId&quot;: &quot;clientId&quot;}}</code><br><br>In this example <code>($)GmailSessionDetails</code> has been set up using the following <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/expression-editor/">Expression</a>:<br><br> <code>new GmailSessionDetails(serverDetails: new ServerDetails(&quot;smtp.gmail.com&quot;, 465, true), credentials: new GmailOAuthCertificateCredentials(@&quot;C:\certificate.p12&quot;, &quot;encryptedPassword&quot;, &quot;sender@gmail.com&quot;, &quot;clientId&quot;))</code></td>
<td><code>($)GmailSessionDetails</code> is a variable of type <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a><br><br>The <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> is a path pointing to a certificate accessible from the server executing the flow.<br><br>For information on:<ul><li>What each of the properties in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> needs to be, see <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a></li><li>How to set up the <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> account so that this authentication mechanism can be used, see <a href="/docs/reference/concepts/working-with/email/authentication/#setting-up-a-gmail-account-for-oauth-authentication">Setting up a Gmail account for OAuth authentication</a></li></ul>The <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepassword">CertificatePassword</a> property  must be encrypted, for more information on how to encrypt the password, see <a href="/docs/reference/data-types/text/encryptedtext">EncryptedText</a>.</td>
</tr>
<tr>
<td><a href="#close-session">Close Session</a></td>
<td><code>($)CloseSession</code> with value <code>true</code></td>
<td><code>($)CloseSession</code> is a variable of type <a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
</tbody>
</table>
<h4 id="result-9">Result</h4>
<p>An email with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority is sent from <code>sender@gmail.com</code> to <code>recipient@outlook.com</code> with a subject of <code>&quot;Example email subject&quot;</code> and a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body of <code>&quot;Example email body&quot;</code>, and then the session is closed.</p>
<hr>
<h2 id="properties-10">Properties</h2>
<h3 id="email-message">Email Message</h3>
<p>The <a href="#email-message">Email Message</a> to send via the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted by <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> specified in the <a href="#gmail-session-details">Gmail Session Details</a>. This property contains all of the information in relation to the email to be sent, these are:</p>
<ul>
<li><a href="/docs/reference/data-types/email/emailmessage/#to">To</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#from">From</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#cc">Cc</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#bcc">Bcc</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#subject">Subject</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#body">Body</a></li>
<li><a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a></li>
</ul>
<p>Note that if the properties <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> and <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> are set to <code>null</code> when <a href="/docs/reference/data-types/email/emailmessage/#create-an-emailmessage">creating an EmailMessage using a constructor</a>, the email will be sent with <a href="/docs/reference/data-types/email/emailmessagepriority/#normal">Normal</a> priority and with a <a href="/docs/reference/data-types/email/emailmessagebodyformat/#text">Text</a> body.</p>
<p>For more detailed information on each of the properties, see <a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a>.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Type</td>
<td><a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a></td>
</tr>
<tr>
<td>Property Type</td>
<td><a href="/docs/reference/concepts/fundamentals/blocks/block-properties/what-is-a-block-property/#input-properties">Input</a></td>
</tr>
<tr>
<td>Is <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/advanced-properties/">Advanced</a></td>
<td><code>false</code></td>
</tr>
<tr>
<td>Default Editor</td>
<td><a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/literal-editor/">Literal</a></td>
</tr>
<tr>
<td>Default Value</td>
<td><a href="/docs/reference/data-types/email/emailmessage">EmailMessage</a> with value shown below:</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;To&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;Name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;Address&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;From&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;Name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;Address&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;Cc&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;Bcc&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;Priority&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;EmailMessagePriority.Normal&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;Subject&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;BodyFormat&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;EmailMessageBodyFormat.Text&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;Body&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;Attachments&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="gmail-session-details">Gmail Session Details</h3>
<p>The <a href="#gmail-session-details">Gmail Session Details</a> object that includes all of the information required to open and maintain a session with an <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted by <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a>, including:</p>
<ul>
<li><a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails/#serverdetails">ServerDetails</a> - must be provided in order to connect to an <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server. This object contains the properties <a href="/docs/reference/data-types/session-details/serverdetails/#host">Host</a>, <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> and <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a>. For more information on:
<ul>
<li>Supported server address formats, see <a href="#supported-formats-for-serverdetailshost">Supported formats for ServerDetails.Host</a>.</li>
<li>When <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>, see <a href="#setting-usessl">Setting UseSsl</a>.</li>
</ul>
</li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails/#credentials">Credentials</a> - must be provided in order to connect to an <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server. This object must be a <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> or a <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> and is used for authentication. For more information on how to configure each of these, see <a href="#setting-credentials">Setting Credentials</a>.</li>
</ul>
<p>If the <a href="#close-session">Close Session</a> property is set to <code>false</code>, then the session will be kept open and can be used in subsequent Send Email Using Gmail blocks which improves performance, see <a href="#opening-sessions">Opening Sessions</a> for more information.</p>
<p>For more detailed information on each of the properties, see <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a>.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Type</td>
<td><a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails">GmailSessionDetails</a></td>
</tr>
<tr>
<td>Property Type</td>
<td><a href="/docs/reference/concepts/fundamentals/blocks/block-properties/what-is-a-block-property/#inputoutput-properties">InputOutput</a></td>
</tr>
<tr>
<td>Is <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/advanced-properties/">Advanced</a></td>
<td><code>false</code></td>
</tr>
<tr>
<td>Default Editor</td>
<td><a href="/docs/reference/concepts/fundamentals/variables/using-variables/">Variable</a></td>
</tr>
<tr>
<td>Default Value</td>
<td><code>($)GmailSessionDetails</code> with no value</td>
</tr>
</tbody>
</table>
<h3 id="close-session">Close Session</h3>
<p><a href="#close-session">Close Session</a> can be specified to choose whether the session is closed or is kept open for use on subsequent Send Email Using Gmail blocks, this defaults to <code>false</code> if left blank, please see <a href="#closing-sessions">Closing Sessions</a> for more information.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Type</td>
<td><a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a></td>
</tr>
<tr>
<td>Property Type</td>
<td><a href="/docs/reference/concepts/fundamentals/blocks/block-properties/what-is-a-block-property/#input-properties">Input</a></td>
</tr>
<tr>
<td>Is <a href="/docs/reference/concepts/fundamentals/blocks/block-properties/advanced-properties/">Advanced</a></td>
<td><code>false</code></td>
</tr>
<tr>
<td>Default Editor</td>
<td><a href="/docs/reference/concepts/fundamentals/blocks/block-properties/property-editors/literal-editor/">Literal</a></td>
</tr>
<tr>
<td>Default Value</td>
<td><a href="/docs/reference/data-types/conditional-logic/boolean">Boolean</a> with value <code>true</code></td>
</tr>
</tbody>
</table>
<h2 id="exceptions">Exceptions</h2>
<p>The exceptions thrown by the block can be found below:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="
    
    
    https://docs.microsoft.com/en-us/dotnet/api/system.argumentexception?view=netcore-3.1
">ArgumentException</a></td>
<td>Thrown when <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> within the <a href="#email-message">Email Message</a> is not one of the specified <a href="/docs/reference/data-types/email/emailmessagebodyformat">EmailMessageBodyFormat</a> values (e.g. <code>(EmailMessageBodyFormat)10</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when <a href="/docs/reference/data-types/email/emailmessage/#priority">Priority</a> within the <a href="#email-message">Email Message</a> is not one of the specified <a href="/docs/reference/data-types/email/emailmessagepriority">EmailMessagePriority</a> values (e.g. <code>(EmailMessagePriority)10</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when a file path provided in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> is empty (i.e. <code>&quot;&quot;</code>), contains only whitespace (i.e. <code>&quot;   &quot;</code>) or contains the NUL character (i.e. <code>\0</code>).</td>
</tr>
<tr>
<td><a href="
    
    
    https://docs.microsoft.com/en-us/dotnet/api/system.argumentnullexception?view=netcore-3.1
">ArgumentNullException</a></td>
<td>Thrown when a file path provided in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> is <code>null</code>.</td>
</tr>
<tr>
<td><a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a></td>
<td>Thrown when an invalid <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> is provided in the <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a> within the <a href="#gmail-session-details">Gmail Session Details</a>. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#100">Invalid Port</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when an invalid <a href="/docs/reference/data-types/session-details/serverdetails/#host">Host</a> is provided in the <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a> within the <a href="#gmail-session-details">Gmail Session Details</a>. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#101">Invalid Host</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when a connection cannot be established; this typically occurs when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> within <a href="#gmail-session-details">Gmail Session Details</a> is set to <code>false</code> with a <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> which requires it to be set to <code>true</code>. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#200">SSL Required</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when a connection cannot be established; this typically occurs when <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> within <a href="#gmail-session-details">Gmail Session Details</a> is set to <code>true</code> with a <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> which requires it to be set to <code>false</code>. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#201">SSL Unsupported</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/glossary/p-t/#tls">TLS</a>/<a href="/docs/reference/glossary/p-t/#ssl">SSL</a> certificate has expired on the <a href="/docs/reference/data-types/session-details/serverdetails/#host">Host</a> or is untrusted or invalid. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#201">SSL Unsupported</a>. Note that this exception has the same category and error code as the above row, this is a known limitation, see <a href="/docs/reference/data-types/email/emailsessionerrorcode/#known-limitations">EmailSessionErrorCode Limitations</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when a locally installed anti-virus software replaces the <a href="/docs/reference/glossary/p-t/#tls">TLS</a>/<a href="/docs/reference/glossary/p-t/#ssl">SSL</a> certificate in order to scan web traffic. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#201">SSL Unsupported</a>. Note that this exception has the same category and error code as the above row, this is a known limitation, see <a href="/docs/reference/data-types/email/emailsessionerrorcode/#known-limitations">EmailSessionErrorCode Limitations</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/glossary/a-e/#crl">CRL</a> (Certificate Revocation List) server for the <a href="/docs/reference/glossary/p-t/#tls">TLS</a>/<a href="/docs/reference/glossary/p-t/#ssl">SSL</a> certificate is down. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#201">SSL Unsupported</a>. Note that this exception has the same category and error code as the above row, this is a known limitation, see <a href="/docs/reference/data-types/email/emailsessionerrorcode/#known-limitations">EmailSessionErrorCode Limitations</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/credentials/usercredentials/#username">Username</a> and <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> in the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is incorrect. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#300">Invalid User Credentials</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when an invalid <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> and <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepassword">CertificatePassword</a> combination has been provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a>. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> points to an invalid <a href="/docs/reference/glossary/p-t/#ssl">SSL</a> certificate. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> points to a non-existent file. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> points to a folder. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> is longer than the system defined maximum length (typically 32,767). For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> contains only whitespace (i.e. <code>&quot; &quot;</code>) or contains the NUL character (i.e. <code>\0</code>). For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> contains leading spaces. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> contains invalid characters (i.e. <code>&quot;</code>, <code>*</code>, <code>?</code>, <code>|</code>, <code>&lt;</code>, <code>&gt;</code>, <code>:</code>, <code>\</code>, <code>/</code>). For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when access is denied to the file at the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a>. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when an invalid <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#fromaddress">FromAddress</a> and <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#clientid">ClientId</a> combination has been provided in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a>.  For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#401">Invalid Gmail Client Credentials</a>.</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/system.io.filenotfoundexception">FileNotFoundException</a></td>
<td>Thrown when a non-existent file path is provided in <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within <a href="#email-message">Email Message</a>.</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/system.io.ioexception">IOException</a></td>
<td>Thrown when the desired socket is held by another process; re-running the flow typically solves this.</td>
</tr>
<tr>
<td></td>
<td>Thrown when a file path within <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> contains leading spaces.</td>
</tr>
<tr>
<td></td>
<td>Thrown when a file path within <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> contains invalid characters (i.e. <code>&quot;</code>, <code>*</code>, <code>?</code>, <code>|</code>, <code>&lt;</code>, <code>&gt;</code>, <code>:</code>, <code>\</code>, <code>/</code>).</td>
</tr>
<tr>
<td><a href="
    
    
    https://docs.microsoft.com/en-us/dotnet/api/system.io.pathtoolongexception?view=netcore-3.1
">PathTooLongException</a></td>
<td>Thrown when a file path provided in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> exceeds the system-defined maximum length (typically 32,767).</td>
</tr>
<tr>
<td><a href="/docs/reference/exceptions/common/property/property-null-exception/">PropertyNullException</a></td>
<td>Thrown when the <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a> within <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/session-details/serverdetails/#host">Host</a> in <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a> within <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="#email-message">Email Message</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/email/emailmessage/#to">To</a> within <a href="#email-message">Email Message</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/email/emailmessage/#from">From</a> within <a href="#email-message">Email Message</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/email/emailaddress/#address">Address</a> in an <a href="/docs/reference/data-types/email/emailaddress">EmailAddress</a> within <a href="#email-message">Email Message</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepassword">CertificatePassword</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#fromaddress">FromAddress</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#clientid">ClientId</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is <code>null</code>.</td>
</tr>
<tr>
<td><a href="/docs/reference/exceptions/common/property/property-empty-exception/">PropertyEmptyException</a></td>
<td>Thrown when the <a href="/docs/reference/data-types/session-details/serverdetails/#host">Host</a> in <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a> within <a href="#gmail-session-details">Gmail Session Details</a> is empty (i.e. <code>&quot;&quot;</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/email/emailmessage/#to">To</a> within <a href="#email-message">Email Message</a> is empty (i.e. <code>[]</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/email/emailaddress/#address">Address</a> in an <a href="/docs/reference/data-types/email/emailaddress">EmailAddress</a> within <a href="#email-message">Email Message</a> is empty (i.e. <code>&quot;&quot;</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is empty (i.e. <code>&quot;&quot;</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepassword">CertificatePassword</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is empty (i.e. <code>&quot;&quot;</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#fromaddress">FromAddress</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is empty (i.e. <code>&quot;&quot;</code>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#clientid">ClientId</a> in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> within <a href="#gmail-session-details">Gmail Session Details</a> is empty (i.e. <code>&quot;&quot;</code>).</td>
</tr>
<tr>
<td><a href="/docs/reference/exceptions/common/property/property-value-out-of-range-exception/">PropertyValueOutOfRangeException</a></td>
<td>Thrown when the <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> in the <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a> within <a href="#gmail-session-details">Gmail Session Details</a> is below <code>1</code> or above <code>65535</code>. For more information, see <a href="/docs/reference/exceptions/common/property/property-value-out-of-range-exception/#property-is-invalid">Property Is Invalid</a>.</td>
</tr>
<tr>
<td><a href="http://www.mimekit.net/docs/html/T_MailKit_Net_Smtp_SmtpCommandException.htm">SmtpCommandException</a></td>
<td>Thrown when the <a href="/docs/reference/data-types/email/emailaddress/#address">Address</a> in an <a href="/docs/reference/data-types/email/emailaddress">EmailAddress</a> within <a href="#email-message">Email Message</a> is not of the correct format (<a href="https://www.ietf.org/rfc/rfc5321.txt">RFC 5321</a>).</td>
</tr>
<tr>
<td></td>
<td>Thrown when the combined size of all of the attachments in the list of <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> is greater than the limit specified by the email service provider; for <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> this is <code>25 MB</code>.</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/system.unauthorizedaccessexception">UnauthorizedAccessException</a></td>
<td>Thrown when access is denied to a file provided in <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within <a href="#email-message">Email Message</a>.</td>
</tr>
<tr>
<td></td>
<td>Thrown when a file path within the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> property within <a href="#email-message">Email Message</a> points to a folder.</td>
</tr>
</tbody>
</table>
<h2 id="remarks">Remarks</h2>
<h3 id="how-does-priority-affect-sending-an-email">How does Priority affect sending an email?</h3>
<p>An email sent with <a href="/docs/reference/data-types/email/emailmessagepriority/#urgent">Urgent</a> or <a href="/docs/reference/data-types/email/emailmessagepriority/#nonurgent">NonUrgent</a> priority will have its priority displayed differently depending on the email client. For example, <a href="/docs/reference/glossary/k-o/#outlook">Outlook</a> displays an email that has an <a href="/docs/reference/data-types/email/emailmessagepriority/#urgent">Urgent</a> priority with a red exclamation mark like so:</p>
<p><img src="/images/send-email-using-smtp-server-important-email.png" alt="Important email"></p>
<p>For more information on how the priority of an email will be displayed, see the help provided by the respective email client.</p>
<h3 id="how-does-bodyformat-affect-sending-an-email">How does BodyFormat affect sending an email?</h3>
<p>An email sent with an <a href="/docs/reference/data-types/email/emailmessagebodyformat/#html">HTML</a> body will have its body displayed as an HTML page instead of as plain text. How the email looks in the email client may differ depending on the email client in use. For example, if the <a href="#email-message">Email Message</a> has its <a href="/docs/reference/data-types/email/emailmessage/#bodyformat">BodyFormat</a> set to <a href="/docs/reference/data-types/email/emailmessagebodyformat/#html">HTML</a> and the <a href="/docs/reference/data-types/email/emailmessage/#body">Body</a> has a value of:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;&lt;h1&gt;Example header text&lt;/h1&gt;&lt;p&gt;Example paragraph text&lt;/p&gt;&#34;</span>
</span></span></code></pre></div><p><a href="/docs/reference/glossary/k-o/#outlook">Outlook</a> will display the email body as follows:</p>
<p><img src="/images/send-email-using-smtp-server-html-email.png" alt="HTML email"></p>
<p>For more information on how the body of an email will be displayed, see the help provided by the respective email client.</p>
<h3 id="attachments">Attachments</h3>
<p>Attachments can be sent in an email by providing a list of file paths in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> property of the <a href="#email-message">Email Message</a>. For more information concerning attaching files to an email, see the sections below.</p>
<h4 id="supported-file-path-formats">Supported file path formats</h4>
<p>Each file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> can be an:</p>
<ul>
<li>Absolute file path</li>
<li>Relative file path</li>
<li>UNC file path</li>
</ul>
<p>where each file path must be accessible from the server executing the flow.</p>
<p>For more information about each of these supported file path formats, please see <a href="/docs/reference/concepts/working-with/files-and-folders/paths/">File &amp; Folder Paths</a>.</p>
<h4 id="file-paths-need-escaping">File paths need escaping</h4>
<p>Each file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> requires \ characters to be escaped, otherwise each unescaped \ will be reported as an Invalid property value message when trying to debug the flow.</p>
<p>Escaping can be done in two ways:</p>
<ul>
<li>Escaping the <code>\</code> character with another <code>\</code> character (e.g. <code>&quot;C:\\Attachments\\attachment.txt&quot;</code>), or</li>
<li>Prepending an <code>@</code> character before the start of the File Path (e.g. <code>@&quot;C:\Attachments\attachment.txt&quot;</code>)</li>
</ul>
<h4 id="null-file-path">Null file path</h4>
<p>If <code>null</code> is provided as a file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a>, an <a href="
    
    
    https://docs.microsoft.com/en-us/dotnet/api/system.argumentnullexception?view=netcore-3.1
">ArgumentNullException</a> is thrown.</p>
<h4 id="empty-file-path">Empty file path</h4>
<p>If an empty string is provided as a file path in the the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a>, an <a href="
    
    
    https://docs.microsoft.com/en-us/dotnet/api/system.argumentexception?view=netcore-3.1
">ArgumentException</a> is thrown.</p>
<h4 id="file-path-does-not-exist">File path does not exist</h4>
<p>If a file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> does not exist, a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.io.filenotfoundexception">FileNotFoundException</a> is thrown.</p>
<h4 id="invalid-file-path">Invalid file path</h4>
<p>If a file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> is invalid (i.e. contains any of the following characters: &ldquo;, *, ?, |, &lt;, &gt;, :, , /), an <a href="https://learn.microsoft.com/en-us/dotnet/api/system.io.ioexception">IOException</a> will be thrown.</p>
<h4 id="file-path-points-to-a-folder">File path points to a folder</h4>
<p>If a file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> points to a folder, an <a href="https://learn.microsoft.com/en-us/dotnet/api/system.unauthorizedaccessexception">UnauthorizedAccessException</a> will be thrown.</p>
<h4 id="file-path-contains-leading-spaces">File path contains leading spaces</h4>
<p>If a file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> contains leading spaces they are not removed and an <a href="https://learn.microsoft.com/en-us/dotnet/api/system.io.ioexception">IOException</a> will be thrown; however, trailing spaces are removed.</p>
<h4 id="file-path-contains-only-whitespace-or-the-nul-character">File path contains only whitespace or the NUL character</h4>
<p>If a file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> contains only whitespace (i.e. <code>&quot;  &quot;</code>) or the NUL character (i.e. <code>\0</code>), an <a href="
    
    
    https://docs.microsoft.com/en-us/dotnet/api/system.argumentexception?view=netcore-3.1
">ArgumentException</a> will be thrown.</p>
<h4 id="file-path-exceeds-the-system-defined-maximum-length">File path exceeds the system-defined maximum length</h4>
<p>If a file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> exceeds the system-defined maximum length (typically 32,767), a <a href="
    
    
    https://docs.microsoft.com/en-us/dotnet/api/system.io.pathtoolongexception?view=netcore-3.1
">PathTooLongException</a> will be thrown.</p>
<h4 id="user-does-not-have-necessary-permissions-to-attach-the-file">User does not have necessary permissions to attach the file</h4>
<p>If the user the flow is executing as does not have permissions to access the file at the provided file path in the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a>, an <a href="https://learn.microsoft.com/en-us/dotnet/api/system.unauthorizedaccessexception">UnauthorizedAccessException</a> will be thrown.</p>
<h4 id="attachment-size-limit">Attachment size limit</h4>
<p>The combined size of all the <a href="/docs/reference/data-types/email/emailmessage/#attachments">Attachments</a> within the <a href="#email-message">Email Message</a> must be less than the limit specified by the email service provider. If the combined size of all of the attachments is greater than the limit, an <a href="http://www.mimekit.net/docs/html/T_MailKit_Net_Smtp_SmtpCommandException.htm">SmtpCommandException</a> will be thrown.</p>
<p>For <a href="/docs/reference/glossary/k-o/#outlook">Outlook</a> this is <code>20 MB</code> and for <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> this is <code>25 MB</code>, for more information on the size limits for other email service providers, see the help provided by the respective email service provider.</p>
<h3 id="supported-formats-for-serverdetailshost">Supported formats for ServerDetails.Host</h3>
<p>The following formats are supported for <a href="/docs/reference/data-types/session-details/serverdetails/#host">Host</a> in <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a>:</p>
<ul>
<li>Fully Qualified Domain Name (e.g. <code>&quot;smtp.gmail.com&quot;</code>)</li>
</ul>
<h3 id="setting-usessl">Setting UseSsl</h3>
<p>The <a href="/docs/reference/data-types/session-details/serverdetails">ServerDetails</a> within the <a href="#gmail-session-details">Gmail Session Details</a> specifies which <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server to connect to. The value of the <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> property inside this object depends on the <a href="/docs/reference/data-types/session-details/serverdetails/#host">Host</a> and <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> being connected to. There are two types of <a href="/docs/reference/glossary/p-t/#ssl">SSL</a>/<a href="/docs/reference/glossary/p-t/#tls">TLS</a> connections that can occur:</p>
<ul>
<li><a href="/docs/reference/glossary/p-t/#ssl">SSL</a>/<a href="/docs/reference/glossary/p-t/#tls">TLS</a> is used as soon as a connection is established</li>
<li><a href="/docs/reference/glossary/p-t/#ssl">SSL</a>/<a href="/docs/reference/glossary/p-t/#tls">TLS</a> is used via the STARTTLS command if it is available</li>
</ul>
<p>The above two points correspond to the <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> property being set to <code>true</code> and <code>false</code> respectively. As such, generally the following rules can be followed to determine whether <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code> or <code>false</code>:</p>
<ul>
<li>If the <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> being connected to is <code>465</code> then <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>true</code></li>
<li>If the <a href="/docs/reference/data-types/session-details/serverdetails/#port">Port</a> being connected to is <code>25</code> or <code>587</code> then <a href="/docs/reference/data-types/session-details/serverdetails/#usessl">UseSsl</a> should be set to <code>false</code></li>
</ul>
<h3 id="setting-credentials">Setting Credentials</h3>
<p>The <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails/#credentials">Credentials</a> within the <a href="#gmail-session-details">Gmail Session Details</a> specifies what user to connect as on the <a href="/docs/reference/glossary/p-t/#smtp">SMTP</a> server hosted by <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a>. Two types of authentication are supported:</p>
<ul>
<li>Basic</li>
<li>OAuth (Two-Legged OAuth)</li>
</ul>
<p>The above two authentication mechanisms correspond to the <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails/#credentials">Credentials</a> within the <a href="#gmail-session-details">Gmail Session Details</a> being a <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> and a <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> respectively.</p>
<h4 id="setting-credentials-to-usercredentials">Setting Credentials to UserCredentials</h4>
<p>Currently, <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> will not allow emails to be sent using the username and password of an account unless the account is associated with a Google Workspace account.</p>
<p>As such, the recommended approach for using a <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> as the <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails/#credentials">Credentials</a> within the <a href="#gmail-session-details">Gmail Session Details</a> is to set up an app password and use that in place of the actual password associated with the account, see <a href="/docs/reference/concepts/working-with/email/authentication/#setting-up-an-app-password-for-a-gmail-account">Setting up an app password for a Gmail account</a> for more information.</p>
<p>Note the following:</p>
<ul>
<li>The value of the <a href="/docs/reference/data-types/credentials/usercredentials/#username">Username</a> property may optionally be encrypted, however the <a href="/docs/reference/data-types/credentials/usercredentials/#password">Password</a> must be encrypted otherwise an <a href="/docs/reference/exceptions/common/unencryptedtextexception/">UnencryptedTextException</a> will be thrown when the object is created.</li>
<li>Note that the <a href="/docs/reference/data-types/credentials/usercredentials">UserCredentials</a> also contains a <a href="/docs/reference/data-types/credentials/usercredentials/#domain">Domain</a> property which is ignored by this block.</li>
</ul>
<h4 id="setting-credentials-to-gmailoauthcertificatecredentials">Setting Credentials to GmailOAuthCertificateCredentials</h4>
<p>In order to use OAuth as the authentication mechanism:</p>
<ul>
<li>A client application must be set up on the Google Workspace</li>
<li>A service account must be set up for the client application</li>
<li>A private key (.p12 file) must be generated for the service account</li>
<li>An administrator of the Google Workspace must grant the client application domain-wide delegation for the scope <code>https://mail.google.com/</code></li>
</ul>
<p>For more information on how to configure a <a href="/docs/reference/glossary/f-j/#gmail">Gmail</a> account to work with OAuth, see <a href="/docs/reference/concepts/working-with/email/authentication/#setting-up-a-gmail-account-for-oauth-authentication">Setting up a Gmail account for OAuth authentication</a>.</p>
<p>Once the account has been set up to work with OAuth, a <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> can be used as the <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails/#credentials">Credentials</a> within the <a href="#gmail-session-details">Gmail Session Details</a>. The properties in the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> correspond with the client application data as follows:</p>
<ul>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> - The path pointing to the certificate (.p12) file generated when setting up the client application; the certificate must be accessible from the server executing the flow, for more information on using a certificate file, see <a href="#certificate-files">Certificate Files</a>.</li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepassword">CertificatePassword</a> - The password associated with the certificate (.p12)</li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#fromaddress">FromAddress</a> - The address of the account used to set up the client application</li>
<li><a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#clientid">ClientId</a> - The Client ID of the client application</li>
</ul>
<p>Note that the values of the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> and <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#clientid">ClientId</a> properties may optionally be encrypted, however the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepassword">CertificatePassword</a> must be encrypted otherwise an <a href="/docs/reference/exceptions/common/unencryptedtextexception/">UnencryptedTextException</a> will be thrown when the object is created</p>
<p>For more detailed information on each of these properties, see <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a>.</p>
<h3 id="certificate-files">Certificate Files</h3>
<p>OAuth can be used as the authentication mechanism when sending an email using this block by providing a <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> as the <a href="/docs/reference/data-types/google-workspace/gmail/gmailsessiondetails/#credentials">Credentials</a> in the <a href="#gmail-session-details">Gmail Session Details</a>. <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> requires a <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> to be provided, which is a path pointing to a certificate file accessible from the server executing the flow. For more information concerning using a certificate, see the sections below.</p>
<h4 id="supported-certificatepath-formats">Supported CertificatePath formats</h4>
<p>The <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> can be an:</p>
<ul>
<li>Absolute file path</li>
<li>Relative file path</li>
<li>UNC file path</li>
</ul>
<p>where each file path must be accessible from the server executing the flow.</p>
<p>For more information about each of these supported file path formats, please see <a href="/docs/reference/concepts/working-with/files-and-folders/paths/">File &amp; Folder Paths</a>.</p>
<h4 id="certificatepath-needs-escaping">CertificatePath needs escaping</h4>
<p>The <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> requires \ characters to be escaped, otherwise each unescaped \ will be reported as an Invalid property value message when trying to debug the flow.</p>
<p>Escaping can be done in two ways:</p>
<ul>
<li>Escaping the <code>\</code> character with another <code>\</code> character (e.g. <code>&quot;C:\\Certificates\\certificate.p12&quot;</code>), or</li>
<li>Prepending an <code>@</code> character before the start of the File Path (e.g. <code>@&quot;C:\Certificates\certificate.p12&quot;</code>)</li>
</ul>
<h4 id="null-certificatepath">Null CertificatePath</h4>
<p>If <code>null</code> is provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a>, a <a href="/docs/reference/exceptions/common/property/property-null-exception/">PropertyNullException</a> is thrown.</p>
<h4 id="empty-certificatepath">Empty CertificatePath</h4>
<p>If an empty string is provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a>, a <a href="/docs/reference/exceptions/common/property/property-empty-exception/">PropertyEmptyException</a> is thrown.</p>
<h4 id="certificatepath-does-not-exist">CertificatePath does not exist</h4>
<p>If the path provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> does not exist, an <a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a> is thrown. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</p>
<h4 id="invalid-certificatepath">Invalid CertificatePath</h4>
<p>If the path provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> is invalid (i.e. contains any of the following characters: &ldquo;, *, ?, |, &lt;, &gt;, :, , /), an <a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a> will be thrown. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</p>
<h4 id="certificatepath-points-to-a-folder">CertificatePath points to a folder</h4>
<p>If the path provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> points to a folder, an <a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a> will be thrown. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</p>
<h4 id="certificatepath-contains-leading-spaces">CertificatePath contains leading spaces</h4>
<p>If the path provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> contains leading spaces they are not removed and an <a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a> will be thrown; however, trailing spaces are removed. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</p>
<h4 id="certificatepath-contains-only-whitespace-or-the-nul-character">CertificatePath contains only whitespace or the NUL character</h4>
<p>If the path provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> contains only whitespace (i.e. <code>&quot;  &quot;</code>) or the NUL character (i.e. <code>\0</code>), an <a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a> will be thrown. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</p>
<h4 id="certificatepath-exceeds-the-system-defined-maximum-length">CertificatePath exceeds the system-defined maximum length</h4>
<p>If the path provided as the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a> exceeds the system-defined maximum length (typically 32,767), an <a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a> will be thrown. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</p>
<h4 id="user-does-not-have-necessary-permissions-to-use-the-certificate-file">User does not have necessary permissions to use the certificate file</h4>
<p>If the user the flow is executing as does not have permissions to access the file at the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials/#certificatepath">CertificatePath</a> within the <a href="/docs/reference/data-types/google-workspace/gmail/authentication/oauth/gmailoauthcertificatecredentials">GmailOAuthCertificateCredentials</a>, an <a href="/docs/reference/exceptions/email/email-session-exception/">EmailSessionException</a> will be thrown. For more information, see <a href="/docs/reference/exceptions/email/email-session-exception/#400">Invalid SSL Certificate</a>.</p>
<h3 id="opening-sessions">Opening Sessions</h3>
<p>The Send Email Using Gmail block automatically handles creating and opening sessions for the specified <a href="#gmail-session-details">Gmail Session Details</a> using the following rules:</p>
<ul>
<li>If a session does not exist, a new session will be created, opened and used when the block runs.</li>
<li>If a session already exists but is closed, the session will be opened and used when the block runs.</li>
<li>If a session already exists and is open, the session will be used when the block runs.</li>
</ul>
<p><a href="#gmail-session-details">Gmail Session Details</a> will keep the session open across multiple Send Email Using Gmail blocks as long as <a href="#close-session">Close Session</a> is set to <code>false</code>. Keeping the session open helps increase the performance of the block due to the subsequent blocks not having to spend resources creating and opening sessions for each execution.</p>
<p>Note that for all <a href="/docs/reference/glossary/p-t/#ssl">SSL</a> connections, the protocol to be used will be negotiated with the server depending on which protocols are available. Similarly, the <a href="/docs/reference/glossary/p-t/#sasl">SASL</a> mechanism to be used will be negotiated with the mail server based on the available mechanisms.</p>
<p>For information on how to explicitly close a session, please see <a href="#closing-sessions">Closing Sessions</a>.</p>
<h3 id="closing-sessions">Closing Sessions</h3>
<p>Sessions can be explicitly closed by setting <a href="#close-session">Close Session</a> to <code>true</code>. This causes the session to be closed after the <a href="#email-message">Email Message</a> has been sent.</p>
<p>If <a href="#close-session">Close Session</a> is set to <code>false</code> the session will be closed when the <a href="/docs/reference/concepts/fundamentals/variables/using-variables/">Variable</a> that <a href="#gmail-session-details">Gmail Session Details</a> is set to goes out of scope or the flow ends, whichever happens first. For more information about variables and scope, please see <a href="/docs/reference/concepts/fundamentals/variables/">Variables</a>.</p>
<p>For information on how to open a session, please see <a href="#opening-sessions">Opening Sessions</a>.</p>
<h3 id="known-limitations">Known Limitations</h3>
<p>None</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      

<footer class="bg-dark row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-12 col-sm-12 text-center py-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/cortex_software">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Facebook" aria-label="Facebook">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/cortexintelligentautomation/">
      <i class="fab fa-facebook"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Vimeo" aria-label="Vimeo">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://vimeo.com/cortexautomationsoftware">
      <i class="fab fa-vimeo"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/10975051">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="YouTube" aria-label="YouTube">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/channel/UCZwlagVEozhAjmUySYx8YlA">
      <i class="fab fa-youtube"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
    </div>
    <div class="row">
      <div class="col-6 col-sm-6 text-xs-center order-sm-1">
        
        
        
<ul class="list-unstyled">
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Privacy Policy">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.cortex-ia.com/gdpr-privacy-policy/">
      Privacy Policy
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Terms and Conditions">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.cortex-ia.com/terms-conditions/">
      Terms and Conditions
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Disclaimer">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.cortex-ia.com/disclaimer/">
      Disclaimer
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Registration Number: 05023238">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://find-and-update.company-information.service.gov.uk/company/05023238">
      Registration Number: 05023238
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="VAT Number: GB204612157">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.tax.service.gov.uk/check-vat-number/enter-vat-details">
      VAT Number: GB204612157
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-6 text-right text-xs-center order-sm-2"> 
        <ul class="list-unstyled">
          
            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="22 Kings Park Road">
      22 Kings Park Road
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="Southampton, SO15 2AT">
      Southampton, SO15 2AT
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="&#43;44 23 8254 8990">
      &#43;44 23 8254 8990
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="info@cortex-ia.com">
      info@cortex-ia.com
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="Southampton, SO15 2AT">
      Southampton, SO15 2AT
  </li>

          
        </ul>
      </div>
    </div>
    <div class="row">
      <div class="col-12 col-sm-12 text-center order-sm-1 copyright-container">
        Copyright &copy; 2022 Cortex Limited. All Rights Reserved
	
      </div>
    </div>
  </div>
</footer>






    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>













<script src="/js/main.min.357cdcbd77fb614ceb215987dafe216ba8720b4aa10ecd38bccb7c0013e32f2a.js" integrity="sha256-NXzcvXf7YUzrIVmH2v4ha6hyC0qhDs04vMt8ABPjLyo=" crossorigin="anonymous"></script>




  </body>
</html>
