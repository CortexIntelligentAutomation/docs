<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.110.0"><link rel="canonical" type="text/html" href="/docs/getting-started/on-premise/install-innovation-only/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Install Innovation Only | Cortex</title><meta property="og:title" content="Install Innovation Only" />
<meta property="og:description" content="Information about installing a Cortex Innovation platform." />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/getting-started/on-premise/install-innovation-only/" /><meta property="og:site_name" content="Cortex" />
<meta itemprop="name" content="Install Innovation Only">
<meta itemprop="description" content="Information about installing a Cortex Innovation platform."><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Install Innovation Only"/>
<meta name="twitter:description" content="Information about installing a Cortex Innovation platform."/>





<link rel="preload" href="/scss/main.min.aa5e8a7de09e9dc7424a6bdfd90c903040a98e678e4b77d2993e762123ca6be2.css" as="style">
<link href="/scss/main.min.aa5e8a7de09e9dc7424a6bdfd90c903040a98e678e4b77d2993e762123ca6be2.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg id="Layer_4_copy" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1388 475.1" style="enable-background:new 0 0 1388 475.1"><style>.st0{fill:#3b8fce}.st1{fill:#262056}.st2{fill:#a1c429}.st3{fill:#fff}.st4{fill:url(#SVGID_1_)}.st5{opacity:.6;fill:url(#SVGID_2_)}.st6{filter:url(#Adobe_OpacityMaskFilter)}.st7{fill:url(#SVGID_4_)}.st8{mask:url(#SVGID_3_);fill:#fff}.st9{fill:#3f3f3e}</style><path class="st0" d="M122.1 231.7c0-15.7 3.6-30.5 9.9-43.8l-81.1-46.8c-22.9 43.5-28.5 93.3-15.7 141 13.5 50.3 45.7 92.3 90.8 118.3 29 16.7 56.9 24.9 89.6 26v-93.7c-52.3-4-93.5-47.6-93.5-101z"/><path class="st1" d="M223.5 130.3c34.7.0 65.3 17.5 83.6 44.1l81.1-46.8c-35.6-56.2-98-90.8-164.9-90.8-34 0-67.6 9-97.3 26.1-29 16.7-50 36.8-67.3 64.6l81.1 46.8c18.4-26.5 49-44 83.7-44z"/><path class="st2" d="M396.1 141.1 315 188c6.3 13.2 9.9 28.1 9.9 43.7.0 53.3-41.2 97-93.5 101v93.7c103.8-4.1 187-89.9 187-194.7C418.4 198.2 411.5 170 396.1 141.1z"/><g><path class="st3" d="M223.5 231.7l-65.8-38c-21 36.4-8.5 82.9 27.8 103.9 12.1 7 24 10.2 38 10.2V231.7z"/></g><g><path class="st3" d="M223.5 231.7l65.8-38c-21-36.4-67.5-48.8-103.9-27.8-12.1 7-20.8 15.7-27.8 27.8l65.9 38z"/></g><g><path class="st3" d="M223.5 231.7v76c42 0 76-34 76-76 0-14-3.2-25.9-10.2-38l-65.8 38z"/></g><g><radialGradient id="SVGID_1_" cx="223.5157" cy="231.6926" r="76.1085" gradientUnits="userSpaceOnUse"><stop offset="0" style="stop-color:#969695"/><stop offset="1" style="stop-color:#3F3F3E"/></radialGradient><path class="st4" d="M147.4 231.7c0-42 34.1-76.1 76.1-76.1s76.1 34.1 76.1 76.1-34.1 76.1-76.1 76.1C181.5 307.8 147.4 273.7 147.4 231.7z"/><linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="223.5157" y1="155.5859" x2="223.5157" y2="307.7993"><stop offset="0" style="stop-color:#FFFFFF"/><stop offset="1" style="stop-color:#3F3F3E"/></linearGradient><path class="st5" d="M147.4 231.7c0-42 34.1-76.1 76.1-76.1s76.1 34.1 76.1 76.1-34.1 76.1-76.1 76.1C181.5 307.8 147.4 273.7 147.4 231.7z"/><defs><filter id="Adobe_OpacityMaskFilter" filterUnits="userSpaceOnUse" x="177.2" y="172.1" width="92.7" height="59.5"><feColorMatrix type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"/></filter></defs><mask maskUnits="userSpaceOnUse" x="177.2" y="172.1" width="92.7" height="59.5" id="SVGID_3_"><g class="st6"><linearGradient id="SVGID_4_" gradientUnits="userSpaceOnUse" x1="220.0409" y1="123.6788" x2="220.0409" y2="238.3832"><stop offset="0" style="stop-color:#FFFFFF"/><stop offset="1" style="stop-color:#000000"/></linearGradient><rect x="158.4" y="123.7" class="st7" width="123.3" height="114.7"/></g></mask><path class="st8" d="M177.2 201.9c0-16.5 20.7-29.8 46.3-29.8s46.3 13.3 46.3 29.8c0 16.4-20.7 29.8-46.3 29.8s-46.3-13.3-46.3-29.8z"/></g><g><path class="st9" d="M549.7 146c42.6.0 62.7 24.3 62.7 24.3l-17.9 27.8s-17-17.6-42.6-17.6c-30.1.0-49.6 22.7-49.6 50.6.0 27.5 19.8 51.2 50.9 51.2 27.5.0 48-20.8 48-20.8l15.7 28.8s-23.4 26.5-67.2 26.5c-54.1.0-88.6-38.1-88.6-85.4.0-46.4 34.5-85.4 88.6-85.4z"/><path class="st9" d="M697.7 146c49.9.0 89.9 35.5 89.9 85.4.0 50.2-40 85.4-89.6 85.4-49.9.0-89.9-35.2-89.9-85.4.0-49.9 40-85.4 89.6-85.4zM698 282.3c26.3.0 48.3-20.5 48.3-50.9.0-30.1-22.1-50.9-48.3-50.9-26.6.0-48.6 20.8-48.6 50.9.0 30.4 22.1 50.9 48.6 50.9z"/><path class="st9" d="M796.6 149.8h39V178c0 6.1-.6 11.5-.6 11.5h.6c7.4-23.4 26.9-41.9 51.9-41.9 3.8.0 7.3.6 7.3.6v40s-4.2-.6-9.6-.6c-17.3.0-36.8 9.9-44.5 34.2-2.6 8-3.5 16.9-3.5 26.6V313h-40.6V149.8z"/><path class="st9" d="M904.2 105.4h40.7v47H982v32.3h-37.1v63.4c0 26.9 21.1 30.7 32.3 30.7 4.5.0 7.4-.6 7.4-.6v35.5s-4.8 1-12.5 1c-22.7.0-67.9-6.7-67.9-61.4V105.4z"/><path class="st9" d="M1065.5 146c47 0 72.3 34.2 72.3 77.4.0 4.8-1 15.7-1 15.7h-112.6c2.6 28.5 24.6 43.2 49 43.2 26.2.0 47.1-17.9 47.1-17.9l15.7 29.1s-25 23.4-65.6 23.4c-54.1.0-87.7-39-87.7-85.4C982.6 181.2 1016.9 146 1065.5 146zM1096.9 211.3c-.6-22.1-14.4-33.9-32.3-33.9-20.8.0-35.2 12.8-39 33.9h71.3z"/><path class="st9" d="M1236 230.5l52.5-80.6h-46.1l-25.3 44.5c-2.6 4.2-5.4 10.2-5.4 10.2h-.6s-2.9-6.1-5.4-10.2l-25.3-44.5h-46.1l52.5 80.6L1133 313h45.1l28.5-47.4c2.3-3.5 4.5-8.6 4.5-8.6h.6s2.3 5.1 4.5 8.6l28.5 47.4h45.1L1236 230.5z"/><g><path class="st9" d="M1313.8 149.8c9.5.0 17.2 7.7 17.2 17.4.0 9.8-7.6 17.5-17.2 17.5-9.4.0-16.9-7.7-16.9-17.5C1296.8 157.6 1304.4 149.8 1313.8 149.8zm0 32.3c8.2.0 14.4-6.5 14.4-14.9.0-8.3-6.2-14.8-14.4-14.8-8 0-14.1 6.5-14.1 14.8C1299.6 175.6 1305.8 182.1 1313.8 182.1zM1308.1 157.9h6.7c3.3.0 5.6 2.2 5.6 5.6.0 2.8-1.8 4.5-3.5 4.9v.1s.2.2.6 1.1l3.6 7.1h-3l-3.7-7.6h-3.6v7.6h-2.7V157.9zM1314.3 166.9c2 0 3.3-1.3 3.3-3.5.0-2.1-1.3-3.3-3.3-3.3h-3.5v6.8h3.5z"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Cortex</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a id="documentation" class="nav-link" href="/docs/" ><span>Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link" href="/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a id="community" class="nav-link" href="https://community.cortex.co.uk/" target="_blank" ><span>Community</span></a>
			</li>
			
			
			<li class="nav-item dropdown d-block pl-2">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Releases
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="http://v2022.docs.cortex-ia.com/">v2022 (latest)</a>
	
	<a class="dropdown-item" href="https://community.cortex.co.uk/">v7.2</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.8b67e4219c6b3b642c21ebae1c466b67.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="50"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/getting-started/on-premise/install-innovation-only/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Install Innovation Only</h1>
<div class="lead">Information about installing a Cortex Innovation platform.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-4ad6ff94f2c1968ca2879ad923de006d">Multiple Server - With HA (Recommended)</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-8fa4fca9773ae253cfaa79f29521bdce">Architecture</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-743c12945c223a8b59b4cc4b81941dd7">Prerequisites</a></li>


    
  
    
    
	
<li>1.3: <a href="#pg-079808fa3855e70c2bb237652349a15a">Install Application Servers and Load Balancer</a></li>


    
  
    
    
	
<li>1.4: <a href="#pg-1226740248b38053cf2a2b7f45b33b10">Install the Web Application Server</a></li>


    
  
    
    
	
<li>1.5: <a href="#pg-49567754edf61ac1ca933952f7e27f5d">Setup Gateway</a></li>


    
  
    
    
	
<li>1.6: <a href="#pg-9911e8a984fd3e62ca0fd20a451eda08">Try it out</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-41ba09ba8ccf0a1e6d45db2d9c77a1d1">Single Server - Without HA</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-bd1afcf2ea99f980cb86cbca15f0073c">Architecture</a></li>


    
  
    
    
	
<li>2.2: <a href="#pg-a220cffc402902792d86025978223271">Prerequisites</a></li>


    
  
    
    
	
<li>2.3: <a href="#pg-fe52b3f1214f7ec1fdfdbcc8afa49c34">Install Application Server</a></li>


    
  
    
    
	
<li>2.4: <a href="#pg-cc1f5d1c0bcd59056e5d3f3ea7fe1e58">Install the Web Application Server</a></li>


    
  
    
    
	
<li>2.5: <a href="#pg-94866b9144c7c00ad81be52bc6e7996f">Setup Gateway</a></li>


    
  
    
    
	
<li>2.6: <a href="#pg-933fcb8cde93f65d148be379416ec5de">Try it out</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-d17aa11112d961718e83172daed190bc">Advanced Setup</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-27c95e9e19a361fc42704f7dc74835e5">Advanced Application Server and Load Balancer Configuration Changes</a></li>


    
  
    
    
	
<li>3.2: <a href="#pg-e89dbf42fe66aa13ba7cac5050f57f99">Configure Firewalls</a></li>


    
  
    
    
	
<li>3.3: <a href="#pg-ba4fd09d99fc26e56ae5fa878d6fa11b">Configure the Gateway Databases to use Transparent Data Encryption</a></li>


    
  
    
    
	
<li>3.4: <a href="#pg-473627ed5fdaf469986dd76997848b94">Create Self-Signed Certificates</a></li>


    
  
    
    
	
<li>3.5: <a href="#pg-ee76c0361d921fa7f68149bce1441127">Encrypt Text</a></li>


    
  
    
    
	
<li>3.6: <a href="#pg-5e3a44a25a94bb5b847acae8a02fc8bb">Port Requirements for Application Servers and Load Balancer</a></li>


    
  
    
    
	
<li>3.7: <a href="#pg-2154296292afc725b4661ad2c7ef9ec7">Rollover CA certificates</a></li>


    
  
    
    
	
<li>3.8: <a href="#pg-0ae9cc41688a1f099f28b887538ab98d">SSL Best Practices</a></li>


    
  

    </ul>
    
  

    </ul>


<div class="content">
      

<div class="pageinfo pageinfo-primary">
<p>Cortex Innovation can be deployed on-premise across <a href="multiple-server-with-ha">multiple servers</a> to provide improved scale and high availability (HA), or to a <a href="single-server-without-ha">single server</a> if scale and HA aren&rsquo;t required.</p>

</div>


</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-4ad6ff94f2c1968ca2879ad923de006d">1 - Multiple Server - With HA (Recommended)</h1>
    <div class="lead">Information about installing Cortex Innovation across multiple on-premise servers with high availability (HA), including: information about components, supported architectures, prerequisites and installation instructions.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Multiple server installations with HA are recommended for the following scenarios:</p>
<ul>
<li>Production installations that are required to scale and support HA</li>
</ul>

</div>


</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-8fa4fca9773ae253cfaa79f29521bdce">1.1 - Architecture</h1>
    <div class="lead">Information about the recommended Innovation platform architecture, including component descriptions.</div>
	<h1 id="hahahugoshortcode-s0-hbhb">Architecture</h1>
<h2 id="components">Components</h2>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
<th>Required/Optional</th>
<th>Server Role</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/docs/guides/cortex-gateway/">Cortex Gateway</a></td>
<td>Web portal that hosts applications for creating automation solutions and managing their full life-cycle, including design, development, testing, deployment, monitoring, maintenance and ultimately end-of-life.</td>
<td>Required</td>
<td>Web Application Server</td>
</tr>
<tr>
<td><a href="/docs/guides/cortex-studio/">Cortex Studio</a></td>
<td>Application hosted in Cortex Gateway that provides the graphical, low-code environment for developing, testing, versioning, publishing and managing the full life-cycle of automation solutions.</td>
<td>Required</td>
<td>Web Application Server</td>
</tr>
<tr>
<td>Cortex Flow Debugger Service</td>
<td>Web application that allows flows to be debugged and executed. Used by Cortex Studio to debug flows and provide block information.</td>
<td>Required</td>
<td>Web Application Server</td>
</tr>
<tr>
<td>Cortex API Gateway Service</td>
<td>Application Service that routes client requests to the correct distributed Cortex services.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td>Cortex Flow Execution Service</td>
<td>Application Service that executes automation flows.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td>Cortex Block Packages</td>
<td>A set of files which contain the blocks that users can use to build flows. Used by the Cortex Flow Debugger Service and the Cortex Flow Execution Service.</td>
<td>Required</td>
<td>Web Application Server, Application Server</td>
</tr>
<tr>
<td>Cortex Gateway Databases</td>
<td>A set of databases created automatically by Gateway which are used for storing data related to user roles, flows, etc. Hopefully, we can remove the need for Gateway Databases in the next release.</td>
<td>Required<br />(End of life)</td>
<td>Web Application Server</td>
</tr>
<tr>
<td><a href="https://www.microsoft.com/en-us/download/details.aspx?id=103447">SQL Server Express</a> or <a href="https://www.microsoft.com/en-us/evalcenter/evaluate-sql-server-2019?filetype=exe">SQL Server Standard</a></td>
<td>Required by Cortex Gateway for creating and storing the Gateway Databases. Hopefully, we can remove the need for SQL Server in the next release.</td>
<td>Required<br />(End of life)</td>
<td>Web Application Server</td>
</tr>
<tr>
<td><a href="https://azure.microsoft.com/en-us/services/service-fabric/">Microsoft Service Fabric</a></td>
<td>Distributed systems platform that hosts the Cortex services where automation solutions are deployed to; provides scalable, reliable and manageable enterprise-grade High Availability (HA) using clustering.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-visualizing-your-cluster">Microsoft Service Fabric Explorer</a></td>
<td>Web portal for monitoring and managing the Service Fabric instance that automation solutions are deployed to.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://particular.net/nservicebus">Particular NServiceBus</a></td>
<td>Messaging platform enabling scalable, reliable and flexible asynchronous messaging between distributed Cortex services.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://www.rabbitmq.com/">Pivotal RabbitMQ</a></td>
<td>Message broker used by the NServiceBus messaging platform to transport messages asynchronously between distributed Cortex services using publish/subscribe mechanism.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://github.com/erlang/otp">Erlang OTP</a></td>
<td>Erlang run-time required by the RabbitMQ message broker.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://github.com/yyyar/gobetween">gobetween</a></td>
<td>L4 load balancer and reverse proxy used to load balance requests between clustered instances of Cortex services.</td>
<td>Required</td>
<td>Load Balancer</td>
</tr>
<tr>
<td><a href="https://nssm.cc/">NSSM</a></td>
<td>Windows Service Manager that hosts the gobetween load balancer application as a Windows Service.</td>
<td>Required</td>
<td>Load Balancer</td>
</tr>
</tbody>
</table>
<h2 id="recommended-architecture">Recommended Architecture</h2>
<p>The following architecture requires 5 servers:</p>
<ul>
<li>1x Web Application Server which contains Gateway, Flow Debugger Service and Databases</li>
<li>1x Load Balancer Server</li>
<li>3x Application Servers</li>
</ul>

<figure class="centre">
    <img src=" /images/editable/Cortex%20Innovation%20Overview.png "/> <figcaption>
            <h4>5 Server Architecture Diagram</h4>
        </figcaption>
</figure>

<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites">Prerequisites</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-743c12945c223a8b59b4cc4b81941dd7">1.2 - Prerequisites</h1>
    <div class="lead">Information about the prerequisites required on each server type for installation.</div>
	<h1 id="prerequisites">Prerequisites</h1>
<p>The prerequisites required for each server role (as described in <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/architecture">Architecture</a>) are laid out in this guide. These must be considered before undertaking installation.</p>
<h2 id="hardware-requirements">Hardware Requirements</h2>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    The recommended number of servers is 5, and allows each server role instance to be installed on its own server.

</div>

<table>
<thead>
<tr>
<th>Server Role</th>
<th>Servers Required</th>
<th>CPU Cores (&gt; 2GHz)</th>
<th>RAM (GB)</th>
<th>Disk (GB)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Load Balancer</td>
<td>1<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></td>
<td>4+ <em>Recommended</em><br>2 <em>Minimum</em></td>
<td>8+ <em>Recommended</em><br>4 <em>Minimum</em></td>
<td>50+ <em>Recommended</em><br>30 <em>Minimum</em><br>5+ free on installation drive</td>
</tr>
<tr>
<td>Application Server</td>
<td>3 <em>Bronze availability</em><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup><br>5 <em>Silver availability</em><br>7 <em>Gold availability</em><br>9 <em>Platinum availability</em></td>
<td>4+ <em>Recommended</em><br>2 <em>Minimum</em></td>
<td>16+ <em>Recommended</em><br>8 <em>Minimum</em></td>
<td>75+ <em>Recommended</em><br>60 <em>Minimum</em><br>40+ free on %ProgramData% drive</td>
</tr>
<tr>
<td>Web Application Server</td>
<td>1</td>
<td>4+ <em>Recommended</em><br>2 <em>Minimum</em></td>
<td>8+ <em>Recommended</em><br>4 <em>Minimum</em></td>
<td>75+ <em>Recommended</em><br>50 <em>Minimum</em><br>30+ free on installation drive</td>
</tr>
</tbody>
</table>
<h2 id="software-requirements">Software Requirements</h2>
<table>
<thead>
<tr>
<th>Server Role</th>
<th>Windows Server<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup></th>
<th>SQL Server<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup></th>
<th>.Net</th>
<th>PowerShell<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup></th>
<th>IIS<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup></th>
<th>Other Software</th>
</tr>
</thead>
<tbody>
<tr>
<td>Load Balancer</td>
<td><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2019?filetype=ISO">2019 (x64)</a> <em>Recommended</em><br><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2016?filetype=ISO">2016 (x64)</a></td>
<td></td>
<td><a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">Framework 4.7.1</a></td>
<td>5.1</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Application Server</td>
<td><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2019?filetype=ISO">2019 (x64)</a> <em>Recommended</em><br><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2016?filetype=ISO">2016 (x64)</a></td>
<td></td>
<td><a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">Framework 4.7.1</a></td>
<td>5.1</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Web Application Server</td>
<td><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2019?filetype=ISO">2019 (x64)</a> <em>Recommended</em><br><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2016?filetype=ISO">2016 (x64)</a></td>
<td><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-sql-server-2019?filetype=exe">2019</a><br /><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-sql-server-2016?filetype=exe">2016</a><br /><a href="https://www.microsoft.com/en-us/download/details.aspx?id=103447">2016 Express</a></td>
<td><a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">Framework 4.7.1</a></td>
<td>5.1</td>
<td>10.0.17763<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup><br>10.0.14393<sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup><br><a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite Module 2.1</a></td>
<td><a href="https://www.microsoft.com/en-gb/download/details.aspx?id=43717">Microsoft Web Deploy 3.0 or later</a><br><a href="http://www.microsoft.com/en-us/download/details.aspx?id=40784">Visual C++ Redistributable 2013 (x64)</a></td>
</tr>
</tbody>
</table>
<h2 id="domain-requirements">Domain Requirements</h2>
<p>All servers must be on the same domain and cannot be domain controllers.</p>
<h2 id="dns-requirements">DNS Requirements</h2>
<p>The installation requires IP to hostname resolution to be available. Please ensure that you have the appropriate pointer (PTR) records configured  on the DNS server for all of your servers (Web, Application and Load Balancer).</p>
<h2 id="licensing-requirements">Licensing Requirements</h2>
<p>A valid Cortex licence file and Cortex Innovation feature identifier must be procured from Cortex. The feature identifier is a GUID which will be used when configuring the Gateway installation. The licence file is needed when installing the Web Application server and it should contain fingerprints for the Web Application Server and each Application Server.</p>
<p>To get a licence file and feature identifier take the following steps:</p>
<ol>
<li>
<p>Copy the following template to a text file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Web Application Server
</span></span><span style="display:flex;"><span>MachineID: 
</span></span><span style="display:flex;"><span>Fingerprint: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Application Server 1
</span></span><span style="display:flex;"><span>MachineID: 
</span></span><span style="display:flex;"><span>Fingerprint: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Application Server 2
</span></span><span style="display:flex;"><span>MachineID: 
</span></span><span style="display:flex;"><span>Fingerprint: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Application Server 3
</span></span><span style="display:flex;"><span>MachineID: 
</span></span><span style="display:flex;"><span>Fingerprint: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Please also include a suitable Cortex Innovation feature identifier.
</span></span></code></pre></div></li>
<li>
<p>Extract <code>Cortex Innovation 2022.9 - Licence Fingerprint Generator.zip</code>.</p>
</li>
<li>
<p>From that folder, copy <code>Cortex.Licensing.FingerprintGeneration.exe</code> to the Web Application server.</p>
</li>
<li>
<p>Double-click <code>Cortex.Licensing.FingerprintGeneration.exe</code> to run it. A command line window will appear, containing a machine identifier and fingerprint, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>MachineID: WEBAPP-SERVER
</span></span><span style="display:flex;"><span>Fingerprint: 111118BA104C928319E0CBAE30844CF8B7FD8BC414D1567844D1D0830089F1C9BF5C6
</span></span></code></pre></div></li>
<li>
<p>Copy the output (machine identifier and fingerprint) to the <code>Web Application Server</code> section of the text file created in the initial step. Note that the machine identifier can be changed to any string, provided that it is different for each server.</p>
</li>
<li>
<p>For each Application Server take the following steps:</p>
<ol>
<li>
<p>Copy <code>Cortex.Licensing.FingerprintGeneration.exe</code> to the Application server.</p>
</li>
<li>
<p>Double-click <code>Cortex.Licensing.FingerprintGeneration.exe</code> to run it. A command line window will appear, containing a machine identifier and fingerprint, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>MachineID: APP-SERVER1
</span></span><span style="display:flex;"><span>Fingerprint: 111118BA104C928319E0CBAE30844CF8B7FD8BC414D1567844D1D0830089F1C9BF5C6
</span></span></code></pre></div></li>
<li>
<p>Copy the output (machine identifier and fingerprint) to one of the <code>Application Server</code> sections of the text file created in the initial step. Note that the machine identifier can be changed to any string, provided that it is different for each server.</p>
</li>
</ol>
</li>
<li>
<p>Request a licence and feature identifier by raising a case in the <a href="https://support.cortex.co.uk/">Cortex Service Portal</a>, including the contents of the text file containing all of the fingerprint and machine information in the body of the case.</p>
</li>
<li>
<p>When the licence and feature identifier have arrived, copy the file <code>Cortex.lic</code> to <code>%ProgramData%\Cortex\Licences</code> on the Web Application Server, creating the <code>Cortex</code> and <code>Licences</code> folders if they don&rsquo;t exist. Save the feature identifier for use when <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server#install-gateway">Installing Gateway</a>.</p>
</li>
</ol>
<h2 id="web-browser-requirements">Web Browser Requirements</h2>
<p>Gateway supports the latest versions of the following browsers:</p>
<ul>
<li>Chrome</li>
<li>Edge</li>
<li>Firefox</li>
</ul>
<h2 id="additional-load-balancer-server-requirements">Additional Load Balancer Server Requirements</h2>
<h3 id="filesystem-requirements">Filesystem Requirements</h3>
<p>If using the included <a href="https://github.com/yyyar/gobetween">gobetween</a> load balancer, Network Discovery and File Sharing must be enabled on the Load Balancer Server:</p>
<ol>
<li>Open File Explorer.</li>
<li>Click <code>Network</code> on the left.</li>
<li>A banner similar to the following will appear if Network Discovery and File Sharing is turned off:

    <figure>
        <img src=" /images/Network%20Discovery%201.png "/> <figcaption>
                <h4>Network and File Discovery Disabled</h4>
            </figcaption>
    </figure>
</li>
<li>Click the banner.</li>
<li>Click <code>Turn on network discovery and file sharing</code>:

    <figure>
        <img src=" /images/Network%20Discovery%202.png "/> <figcaption>
                <h4>Enable Network and File Discovery</h4>
            </figcaption>
    </figure>
</li>
</ol>
<h3 id="alternative-load-balancer-requirements">Alternative Load Balancer Requirements</h3>
<p>Innovation has a <a href="https://github.com/yyyar/gobetween">gobetween</a> load balancer included that isn&rsquo;t highly available; It is possible to use an alternative. The requirements for installing an alternative load balancer are as follows:</p>
<ul>
<li>Must support a round robin (or similar) method of load balancing to specified ports on 3 nodes.</li>
<li>Must be able to health check each node by running a predefined batch script (<code>ApiGatewayTypeHealthcheck.bat</code>, which resides in the <code>gobetween</code> folder of the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code>) that returns 1 for healthy and 0 for unhealthy.</li>
<li>Must be able to access each of the Application Servers via HTTPS.</li>
<li>Ideally it should be highly available to avoid a single point of failure in the system.</li>
</ul>
<h2 id="additional-application-server-requirements">Additional Application Server Requirements</h2>
<h3 id="filesystem-requirements-1">Filesystem Requirements</h3>
<p>All Application Servers must use an NTFS filesystem.</p>
<p>Network Discovery and File Sharing should be enabled on each Application Server:</p>
<ol>
<li>Open File Explorer.</li>
<li>Click <code>Network</code> on the left.</li>
<li>A banner similar to the following will appear if Network Discovery and File Sharing is turned off:

    <figure>
        <img src=" /images/Network%20Discovery%201.png "/> <figcaption>
                <h4>Network and File Discovery Disabled</h4>
            </figcaption>
    </figure>
</li>
<li>Click the banner.</li>
<li>Click <code>Turn on network discovery and file sharing</code>:

    <figure>
        <img src=" /images/Network%20Discovery%202.png "/> <figcaption>
                <h4>Enable Network and File Discovery</h4>
            </figcaption>
    </figure>
</li>
</ol>
<h3 id="service-requirements">Service Requirements</h3>
<p>The following Windows Services must be running on all Application Servers:</p>
<ul>
<li>Remote Registry</li>
<li>Windows Event Log</li>
<li>Performance Logs &amp; Alerts</li>
</ul>
<h3 id="security-requirements">Security Requirements</h3>
<h4 id="installation-user">Installation User</h4>
<p>A domain user which is a member of the Local Administrators group on all Application Servers and Load Balancer Server must be available to run the installation scripts. This is a prerequisite of Microsoft Service Fabric, which is the HA platform that Cortex Innovation is built upon.</p>
<h4 id="antivirus-exclusions">Antivirus Exclusions</h4>
<p>It is advised (by Microsoft Service Fabric) that the following antivirus exclusions are created on each Application Server to reduce antivirus processing on Service Fabric artefacts:</p>
<p>Folder Exclusions:</p>
<ul>
<li>%ProgramFiles%\Microsoft Service Fabric</li>
<li>%ProgramData%\SF</li>
<li>%ProgramData%\SF\Logs</li>
</ul>
<p>Process Exclusions:</p>
<ul>
<li>Fabric.exe</li>
<li>FabricHost.exe</li>
<li>FabricInstallerService.exe</li>
<li>FabricSetup.exe</li>
<li>FabricDeployer.exe</li>
<li>ImageBuilder.exe</li>
<li>FabricGateway.exe</li>
<li>FabricDCA.exe</li>
<li>FabricFAS.exe</li>
<li>FabricUOS.exe</li>
<li>FabricRM.exe</li>
<li>FileStoreService.exe</li>
</ul>
<p>A script is provided during installation to add these exclusions for Windows Defender. If any other antivirus software is running, these will need to be added manually.</p>
<p>If adding the exclusions manually, the Process Exclusions should be done before installation occurs, as the processes will be used during installation of the application and antivirus software can cause the installation to fail or timeout. Folder Exclusions may need to be added after installation has occurred as some antivirus software needs the folders to exist.</p>
<h4 id="port-requirements">Port Requirements</h4>
<p>Cortex Innovation and Microsoft Service Fabric require a range of <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/port-requirements">firewall ports to be opened</a> between the servers and specific services.</p>
<p>If you are using Windows Firewall, some ports are opened during installation and others are opened dynamically as needed. If any other firewall is used, it will be necessary to add the rules described in <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/port-requirements">Port Requirements</a> to open the correct ports.</p>
<p>The <code>Cortex.Innovation.Test.PortUsage.ps1</code> script is provided during installation to test the ports on each Application Server and make sure they do not overlap with any other programs; most ports may be altered if this is the case, the description will say if this is not possible.</p>
<h4 id="certificate-requirements">Certificate Requirements</h4>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    For production systems it is recommended that X.509 SSL wildcard certificates are obtained from a Certificate Authority and used for installation. For non-production systems, certificates can be omitted from installation and it will create and use self-signed certificates. This may prevent 3rd parties that require valid certificate verification to access the API Gateway Service.

</div>

<p>An X.509 SSL wildcard certificate should be used to:</p>
<ul>
<li>Secure communication between the load balancer and the nodes on the Application Servers.</li>
<li>Secure communication between the Application Services.</li>
<li>Allow Application Services to identify themselves to clients such as Gateway.</li>
<li>Prevent unauthorised nodes from joining the HA cluster.</li>
<li>Connect to Service Fabric Explorer from each of the Application Servers.</li>
</ul>
<p>The certificate can be obtained from a Certificate Authority, such as <a href="https://letsencrypt.org/">Let’s Encrypt</a>, and must meet the following requirements:</p>
<ul>
<li>Subject field must be in a wildcard format, pertaining to the domain of the Application Servers (e.g. <code>CN=*.domain.com</code>).</li>
<li>Subject alternative names must include any additional host names that should be able to be used to access the API Gateway Service.</li>
<li>Certificate file must be in a .PFX file format, with a known password.</li>
<li>Certificate file must contain the full chain of certificates.</li>
<li>Certificate file must include the private key.</li>
<li>Key Usage extension must have a value of <code>Digital Signature, Key Encipherment (a0)</code>.</li>
<li>Enhanced Key Usage must include <code>Server Authentication</code> and <code>Client Authentication</code>.</li>
</ul>
<p>This file should be placed in a known location on the Application Server where the installation scripts will be run. This location will be required when running the installation script.</p>
<p>If required, a separate X.509 SSL certificate can be obtained to be used by the load balancer to communicate with the Application Services. It must meet all of the other requirements laid out above, except the subject field can also be the FQDN of the load balancer (e.g. <code>CN=machine-name.domain.com</code>).</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    It is critical to set a reminder to <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/rollover-certificates">update certificates</a> in good time before they expire. If they expire then the platform will cease to function and <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> must be contacted for support.

</div>

<h4 id="tls-requirements">TLS Requirements</h4>
<p>There is a set of non-compulsory security measures, recommended to be applied to the Application Servers, in order to prevent potential attacks that exploit known industry security vulnerabilities. This includes disabling all versions of SSL and TLS apart from TLS 1.2. And disabling all cipher suites apart from the following:</p>
<ul>
<li>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</li>
<li>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</li>
</ul>
<p>See <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/ssl-best-practices">SSL Best Practices</a> for a full list of the security changes which will be applied. The <code>Cortex.Innovation.Install.Multiple.SSLBestPractices.ps1</code> script is provided during installation to apply these security changes to the Application Servers.</p>
<h2 id="additional-web-application-server-requirements">Additional Web Application Server Requirements</h2>
<h3 id="security-requirements-1">Security Requirements</h3>
<h4 id="installation-user-1">Installation User</h4>
<p>Domain users must be available to run the Application Pools for Gateway and Flow Debugger Service. These users must be given <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions otherwise the Application Pools will not be able to run. Information about how to do this will be given during installation.</p>
<p>For Flow Debugger Service, the <code>NETWORK SERVICE</code> user can also be used.</p>
<h4 id="domain-requirements-1">Domain Requirements</h4>
<p>For Gateway, only Windows domains with an Active Directory domain controller running Active Directory Domain Services are supported.</p>
<p>Supported versions of Active Directory are listed below:</p>
<table>
<thead>
<tr>
<th>Version</th>
<th>Verified?</th>
<th>Supported From</th>
<th>Supported Until</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2003</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2003 R2</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2008</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2008 R2</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2012</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2012 R2</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2016</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2019</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2022</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
</tbody>
</table>
<h4 id="certificate-requirements-1">Certificate Requirements</h4>
<p>Both Gateway and the Flow Debugger Service require an X.509 SSL certificate to be installed on the Web Application Server. The certificate must have the following properties:</p>
<ul>
<li>Enhanced Key Usage: <code>Server Authentication</code> and <code>Client Authentication</code></li>
<li>Subject Alternative Names (SAN): At minimum the FQDN of the Server. It can also include NetBIOS Name, IP address, localhost, 127.0.0.1</li>
</ul>
<p>If the user tries to navigate to an address not in the SAN list, then they will receive a certificate error.</p>
<p>Wildcard certificates and self-signed certificates can also be used. However, self-signed certificates are not recommended for production instances. Details on how to create a self-signed certificate can be found at <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/self-signed-certificates">Create Self-Signed Certificates</a>.</p>
<p>The certificate may be the same one used for the Application Server installation.</p>
<p>More information about importing the certificate is given during installation.</p>
<h4 id="tls-requirements-1">TLS Requirements</h4>
<p>There is a set of non-compulsory security measures, recommended to be applied to the Web Application Server, in order to prevent potential attacks that exploit known industry security vulnerabilities. This includes disabling all versions of SSL and TLS apart from TLS 1.2. And disabling all cipher suites apart from the following:</p>
<ul>
<li>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</li>
<li>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</li>
</ul>
<p>See <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/ssl-best-practices">SSL Best Practices</a> for a full list of the security changes which will be applied. The <code>Cortex.Innovation.Install.SSLBestPractices.ps1</code> script is provided during installation to apply these security changes to the Web Application Server.</p>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-application-and-loadbalancer-servers">Install Application Servers and Load Balancer</a></li>
</ol>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>A software-based load balancer called <a href="https://github.com/yyyar/gobetween">gobetween</a> is provided with the platform. This must be installed on its own server as it doesn&rsquo;t support routing traffic to itself. It also doesn&rsquo;t currently support HA, but it may be possible to use multiple gobetween load balancers with Anycast network addressing and routing to provide high availability, as described in <a href="https://en.wikipedia.org/wiki/Anycast">https://en.wikipedia.org/wiki/Anycast</a>; however, this has not been verified yet. It is possible to use an <a href="#alternative-load-balancer-requirements">alternative load balancer</a> to the one provided.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Application Servers support HA via clustering. A cluster must consist of a minimum of 3 nodes, and the number of nodes must be an odd number to ensure a quorum. Currently only the Bronze availability (3 nodes) is supported. Silver, Gold and Platinum support will be added in future.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Windows Server Standard and Datacenter editions are supported. Filesystem <strong>must be NTFS</strong> and networking <strong>must use IPv4</strong>. Linux is not supported, but may be in the future.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>SQL Server Express, Standard and Enterprise are supported. Other databases are not supported. Note that <a href="https://learn.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption?view=sql-server-ver15">Transparent Data Encryption</a> is not supported on SQL Server Express.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>PowerShell 5.1 ships with Windows Server 2016 and 2019.&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p>IIS is supported; other web servers, including IIS Express are not supported.&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p>Ships as a windows role within Windows Server 2019.&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8">
<p>Ships as a windows role within Windows Server 2016.&#160;<a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-079808fa3855e70c2bb237652349a15a">1.3 - Install Application Servers and Load Balancer</h1>
    <div class="lead">Information about installing the Application Servers and Load Balancer Server.</div>
	<h1 id="install-application-servers-and-load-balancer">Install Application Servers and Load Balancer</h1>
<p>This guide describes how to install the Application Servers and Load Balancer Server. Please ensure that the <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites">Prerequisites for installing Innovation</a> have been read before starting this installation.</p>
<h2 id="make-installation-artefacts-available">Make Installation Artefacts Available</h2>
<ol>
<li>
<p>Choose one of the Application Servers to be used for installation, and copy the following artefacts to a folder on it (the version numbers may differ):</p>
<ul>
<li>Cortex Innovation 2022.9 - Block Packages.zip</li>
<li>Cortex Innovation 2022.9 - App Services.zip</li>
<li>Cortex Innovation 2022.9 - App Server Install Scripts.zip</li>
</ul>
</li>
<li>
<p>Extract the <code>Cortex Innovation 2022.9 - App Server Install Scripts.zip</code> file to a folder with the same name.</p>
</li>
</ol>
<h2 id="install-microsoft-net-framework-471">Install Microsoft .NET Framework 4.7.1</h2>
<p>Microsoft Service Fabric requires a minimum of Microsoft .NET Framework 4.7.1 to be installed on each Application Server.</p>
<p>To find the version of the framework that is installed:</p>
<ol>
<li>On the Start menu, choose <code>Run</code>.</li>
<li>In the open box, enter <code>regedit.exe</code>. You must have administrative credentials to run regedit.exe.</li>
<li>In the Registry Editor, open the subkey <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full</code>.</li>
<li>If the <code>Full</code> subkey is not present, then you do not have the .NET Framework 4.5 or later installed.</li>
<li>Check for a <code>DWORD</code> value named <code>Release</code>. The existence of the Release DWORD indicates the .NET Framework 4.5 or newer has been installed on that computer. If the value is <code>461308</code> or over then at least .NET Framework 4.7.1 is installed and no further steps need to be taken. If it is not installed, continue with the following steps to install it.</li>
</ol>
<p>To install .NET Framework 4.7.1:</p>
<ol>
<li>Download the <a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">.NET Framework 4.7.1</a> installer.</li>
<li>Double-click on the installer file to run it.</li>
<li>Follow the wizard to complete the installation.</li>
</ol>
<h2 id="apply-recommended-security-measures">Apply Recommended Security Measures</h2>
<p>These are non-compulsory security measures, recommended to be applied to Application Servers and the Load Balancer Server, in order to prevent potential attacks that exploit known industry security vulnerabilities.</p>
<p>Applying these measures may impact other applications running on your servers. Therefore, it is your responsibility to ensure that other applications and their clients will not be affected by the changes.</p>
<h3 id="only-use-recommended-encryption-algorithms-and-tls-protocols">Only Use Recommended Encryption Algorithms and TLS Protocols</h3>
<p>A collection of registry settings need to be applied to guarantee your server is only using the recommended encryption algorithms and TLS protocols. Information about these settings can be found at <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/ssl-best-practices">SSL Best Practices</a>.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    Disabling specific TLS versions or specific Cipher Suites can have impact on Cortex components themselves as well as their communication capabilities with third party systems and services, e.g. Flow Debugger Service executing flows with blocks which communicate with 3rd parties via PowerShell or REST. All parties communicating together must support a shared protocol version and cipher suite, otherwise they will not be able to establish a secure communication link between each other.

</div>

<p>The settings can be applied by running a script. Be aware that each server will be restarted when the script is run. Apply the settings by following these instructions:</p>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Install.Multiple.SSLBestPractices.ps1</code> script using the following command, modifying the <code>ApplicationServers</code> value to contain the NETBIOS names or fully qualified domain names of the Application Servers and the <code>LoadBalancerServer</code> value to contain the NETBIOS names or fully qualified domain name of the Load Balancer Server (remove the <code>LoadBalancerServer</code> parameter if using an <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites#alternative-load-balancer-requirements">alternative load balancer</a>):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Multiple</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SSLBestPractices</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ApplicationServers</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;app-server2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;app-server3&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">-LoadBalancerServer</span> <span style="color:#4e9a06">&#34;lb-server&#34;</span>
</span></span></code></pre></div>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    To avoid answering all of the prompts <code>-Override 0</code> can be added to the end of the script. This will automatically apply all settings and forcibly restart the servers.

</div>

</li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on all servers (Application and Load Balancer) and press <code>OK</code>.</p>
<p>If <code>-Override 0</code> has been specified no further steps need to be taken and you can move on to the next section when the servers have restarted.</p>
</li>
<li>
<p>To use all the recommended settings click <code>Apply all</code> to the each <code>Apply Cortex recommended security best practices</code> prompt.</p>
<p>To selectively apply each setting select <code>Choose which to apply</code>. Each change will then be prompted with a Yes/No confirmation before applying. This will need to be done for each server.</p>
</li>
<li>
<p>Restart each machine when the script asks. The current machine will be restarted last, the PowerShell script will close at this time.</p>
</li>
</ol>
<h2 id="add-antivirus-exclusions">Add Antivirus Exclusions</h2>
<ol>
<li>If Windows Defender is not running on the Application Servers, ensure that the <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites#antivirus-exclusions">Antivirus Exclusions</a> have been added to the running antivirus software on each of the Application Servers and continue to the next section, otherwise follow these steps:
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Add.WindowsDefenderExclusions.ps1</code> script using the following command, modifying the <code>ApplicationServers</code> value to contain the NETBIOS names or fully qualified domain names of the Application Servers:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WindowsDefenderExclusions</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ApplicationServers</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;app-server2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;app-server3&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div></li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on all Application Servers and press OK.</p>
</li>
<li>
<p>A message will indicate that the script has completed successfully.</p>
</li>
</ol>
</li>
</ol>
<h2 id="check-port-usage">Check Port Usage</h2>
<ol>
<li>To check all necessary ports are free, follow these steps.
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Test.PortUsage.ps1</code> script using the following command, modifying the <code>ApplicationServers</code> value to contain the NETBIOS names or fully qualified domain names of the Application Servers:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Test</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">PortUsage</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ApplicationServers</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;app-server2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;app-server3&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div></li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on all Application Servers and press OK.</p>
</li>
<li>
<p>If all ports are free, the script will report the following for each Application Server:</p>
<p><code>All ports required by Cortex Innovation are free</code></p>
<p>If this is the case, continue to the next section. Otherwise, consult the messages returned by the script, which will give details about how to modify the <code>Cortex.Innovation.Install.Config.json</code> configuration file, in the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder, to use different ports. This will be used later during installation.</p>
<p>The <code>Cortex.Innovation.Test.PortUsage.ps1</code> script cannot currently re-check modified ports in the configuration file so these need to be manually checked to see that they are free.</p>
</li>
</ol>
</li>
</ol>
<h2 id="configure-installation-script">Configure Installation Script</h2>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder, locate the <code>Cortex.Innovation.Install.ps1</code> script and open it with a text editor.</p>
</li>
<li>
<p>Choose the tab below that matches the configuration for this installation, then update the script to match, changing the parameters according to the details given below:</p>

        














        














        














        














    <ul class="nav nav-tabs" id="tabs-3" role="tablist"><li class="nav-item">
      <a class="nav-link active"
        id="tabs-3-0-tab" data-toggle="tab" href="#tabs-3-0" role="tab"
        aria-controls="tabs-3-0" aria-selected="true">
        CA Certs, Built-in Load Balancer
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-3-1-tab" data-toggle="tab" href="#tabs-3-1" role="tab"
        aria-controls="tabs-3-1" aria-selected="false">
        Self-Signed Certs, Built-in Load Balancer
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-3-2-tab" data-toggle="tab" href="#tabs-3-2" role="tab"
        aria-controls="tabs-3-2" aria-selected="false">
        CA Certs, Alternative Load Balancer
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-3-3-tab" data-toggle="tab" href="#tabs-3-3" role="tab"
        aria-controls="tabs-3-3" aria-selected="false">
        Self-Signed Certs, Alternative Load Balancer
      </a>
    </li></ul>


<div class="tab-content" id="tabs-3-content"><div class="tab-pane fade show active"
        id="tabs-3-0" role="tabpanel" aria-labelled-by="tabs-3-0-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AppServicesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Services.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-CustomerName</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApplicationServerIPv4Addresses</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;192.168.1.1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.3&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-LoadBalancerServerIPv4Address</span> <span style="color:#4e9a06">&#34;192.168.1.4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ClientCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ClientCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-ha-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  <div class="tab-pane fade"
        id="tabs-3-1" role="tabpanel" aria-labelled-by="tabs-3-1-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AppServicesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Services.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-CustomerName</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApplicationServerIPv4Addresses</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;192.168.1.1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.3&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-LoadBalancerServerIPv4Address</span> <span style="color:#4e9a06">&#34;192.168.1.4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-UseSelfSignedCertificates</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-ha-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  <div class="tab-pane fade"
        id="tabs-3-2" role="tabpanel" aria-labelled-by="tabs-3-2-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AppServicesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Services.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-CustomerName</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApplicationServerIPv4Addresses</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;192.168.1.1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.3&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ClientCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ClientCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-SkipLoadBalancer</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-ha-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  <div class="tab-pane fade"
        id="tabs-3-3" role="tabpanel" aria-labelled-by="tabs-3-3-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AppServicesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Services.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-CustomerName</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApplicationServerIPv4Addresses</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;192.168.1.1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.3&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-UseSelfSignedCertificates</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-SkipLoadBalancer</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-ha-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  
</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AppServicesPath</code></td>
<td>Configure this value with the location of the Application Services zip file on the Application Server used for installation.</td>
</tr>
<tr>
<td><code>BlockPackagesPath</code></td>
<td>Configure this value with the location of the Block Packages zip file on the Application Server used for installation.</td>
</tr>
<tr>
<td><code>ApiGatewayBasicAuthUserName</code></td>
<td>Configure this value with the username that will be used for Basic Authentication when making HTTPS requests to the API Gateway Service (e.g. starting production flows).<br /><br />For security reasons it is recommended that the default value <code>BasicAuthUser</code> should be changed.<br /><br />Currently only Basic Authentication using a single user is supported, OAuth2 will be supported in a future release.<br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>ApiGatewayBasicAuthPwd</code></td>
<td>Configure this value with the password that will be used for Basic Authentication when making HTTPS requests to the API Gateway Service (e.g. starting production flows). <br /><br />This password should be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>. For security reasons it is recommended that the default value <code>ADA9883B11BD4CDC908B8131B57944A4</code> should be changed. <br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>CustomerName</code></td>
<td>A name identifying the platform being installed. This must have no spaces or symbols. It will be appended to the node names that are displayed in Service Fabric Explorer.</td>
</tr>
<tr>
<td><code>ApplicationServerIPv4Addresses</code></td>
<td>The IPv4 addresses of the Application Servers. The first of these must be the Application Server used for installation.</td>
</tr>
<tr>
<td><code>LoadBalancerServerIPv4Address</code></td>
<td>The IPv4 address of the Load Balancer Server. This is only needed if using the built-in load balancer.</td>
</tr>
<tr>
<td><code>ServerCertificatePath</code></td>
<td>The local path of a .PFX certificate file on the first Application Server in the <code>ApplicationServerIPv4Addresses</code> list. Environment variables cannot be used. <br /><br />This is only needed if installing with CA Certificates (Recommended). The certificate should meet the <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites#certificate-requirements">Certificate Requirements</a>. <br /><br />This certificate will be used for: <ul><li>Securing communication between the Application Services.</li><li>Allowing Application Services to identify themselves to clients such as Gateway.</li><li>Preventing unauthorised nodes from joining the HA cluster.</li><li>Connecting to Service Fabric Explorer from each of the Application Servers.</li></ul>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    It is critical to set a reminder to <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/rollover-certificates">update certificates</a> in good time before they expire. If they expire then the platform will cease to function and <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> must be contacted for support.

</div>
</td>
</tr>
<tr>
<td><code>ServerCertificatePwd</code></td>
<td>The password for the .PFX certificate file specified in <code>ServerCertificatePath</code>. <br /><br /> This is only needed if installing with CA Certificates (Recommended).</td>
</tr>
<tr>
<td><code>ClientCertificatePath</code></td>
<td>The local path of a .PFX certificate file on the first Application Server in the <code>ApplicationServerIPv4Addresses</code> list. This can be the same certificate as the <code>ServerCertificatePath</code>. Environment variables cannot be used. <br /><br />This is only needed if installing with CA Certificates (Recommended) and using the Built-In Load Balancer. The certificate should meet the <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites#certificate-requirements">Certificate Requirements</a>.<br /><br />This certificate will be used for: <ul><li>Securing communication between the load balancer and the nodes on the Application Servers.</li></ul>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    It is critical to set a reminder to <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/rollover-certificates">update certificates</a> in good time before they expire. If they expire then the platform will cease to function and <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> must be contacted for support.

</div>
</td>
</tr>
<tr>
<td><code>ClientCertificatePwd</code></td>
<td>The password for the .PFX certificate file specified in <code>ClientCertificatePath</code>. <br /><br /> This is only needed if installing with CA Certificates (Recommended) and using the Built-In Load Balancer.</td>
</tr>
<tr>
<td><code>UseSelfSignedCertificates</code></td>
<td>Installs Application Services and required infrastructure using generated Self-Signed Certificates rather than CA Certificates.  <br /><br /> Not recommended for production use.</td>
</tr>
<tr>
<td><code>SkipLoadBalancer</code></td>
<td>Installs Application Services and required infrastructure without installing a load balancer. Use when using an alternative load balancer or no load balancer.</td>
</tr>
<tr>
<td><code>Credential</code></td>
<td>The credentials of the user which will be used to perform remote operations on the Application Servers. It must be a domain user that is a member of the local Administrators group on all servers. <br /><br /> This does not need to be changed, a prompt will appear to enter this information when the script is run.</td>
</tr>
<tr>
<td><code>AcceptEULA</code></td>
<td>This does not need to be changed, the EULA will be accepted at a later stage.</td>
</tr>
<tr>
<td><code>FilePath</code></td>
<td>The filename that installation logs are written to.  If this should be written to a different location than where the installation files are then a full path should be specified.</td>
</tr>
</tbody>
</table>
<p>The <code>ApiGatewayBasicAuthUserName</code> and <code>ApiGatewayBasicAuthPwd</code> will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    More advanced configuration (such as changing ports) can be undertaken by modifying the <code>Cortex.Innovation.Install.Config.json</code> file but this shouldn&rsquo;t be required for most installations. More information about this can be found at <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/advanced-config-changes#multiple-server-with-ha">Advanced Application Server and Load Balancer Configuration Changes</a>.

</div>

</li>
<li>
<p>Save and close <code>Cortex.Innovation.Install.ps1</code>.</p>
</li>
</ol>
<h2 id="test-installation-script">Test Installation Script</h2>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-WhatIf</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-WhatIf</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to test the installation script.</p>
</li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on all servers (Application and Load Balancer) and press OK.</p>
</li>
<li>
<p>A password prompt will appear. Enter a password which will be used to create a user in RabbitMQ.</p>
</li>
<li>
<p>Wait for the command to finish. It will display the output of the installation command without making any changes to the system, to ensure things like communication between the servers are working.</p>
</li>
<li>
<p>Check that there have been no errors in the script; these would appear in red in the console.</p>
<p>If there are no errors, continue to the next section; otherwise, check if the errors have any instructions for rectifying the issue and follow them.</p>
<p>If there are no useful instructions, check that all previous steps have been followed correctly and, if not, rectify it and run the command again. <br /><br />If this does not work, please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for further assistance. The <code>WhatIf</code> script will have created a temporary version of the config file in the script location, showing what changes would be made to it when the script runs. The name is appended with <code>-WhatIf</code> (e.g. <code>Cortex.Innovation.Install.Config-WhatIf.json</code>). This file can be provided when obtaining support.</p>
</li>
</ol>
<h2 id="run-installation-script">Run Installation Script</h2>
<ol>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to install HA Services and the required infrastructure.</p>
</li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on all servers (Application and Load Balancer) and press OK.</p>
</li>
<li>
<p>A password prompt will appear. Enter a password which will be used to create a user in RabbitMQ. This should be entered carefully and recorded as it may be needed if seeking support from <a href="https://support.cortex.co.uk/">Cortex Service Portal</a>. Press OK.</p>
</li>
<li>
<p>Wait for the script to finish running. This should take approximately 10 minutes.</p>
</li>
<li>
<p>Check that there have been no errors in the script; these would appear in red in the console.</p>
<p>If there are any errors, then please follow any instructions given within them to rectify the situation, check your configuration files, and retry the installation.</p>
<p>In some circumstances, retrying may error due to components being installed already. In this case please run the following command, followed by the original installation command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Uninstall</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div><p>If the errors do not give any instructions on how to rectify, see <a href="/docs/reference/troubleshooting/installation#ts-during-installation">Troubleshooting During Installation</a> for further information; if this does not help then please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for assistance.</p>
</li>
</ol>
<h2 id="check-application-services">Check Application Services</h2>
<ol>
<li>
<p>Log on to one of the Application Servers.</p>
</li>
<li>
<p>Import the client certificate, used in the <code>ClientCertificatePath</code> parameter of the <a href="#configure-installation-script">Configure Installation Script</a> section, to your Current User certificate store. This can be achieved by double clicking on the client certificate .PFX file and following the wizard.</p>
<p>If using self-signed certificates, the certificate can be retrieved by using the <code>Manage Computer Certificates</code> tool in Windows to export the <code>CortexServerCertificate</code> from the <code>Personal</code> store and then importing it to the <code>Current User</code> store by double-clicking on it and following the wizard.</p>
</li>
<li>
<p>Open a web browser.</p>
</li>
<li>
<p>Navigate to <code>https://app-server.domain.com:9080/Explorer</code>, where <code>app-server.domain.com</code> is the fully qualified domain name of any Application Server. Replace <code>9080</code> with new <code>httpGatewayEndpointPort</code> value if it was changed during configuration.</p>
<p>The screen should resemble that in the following figure:

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Cluster</h4>
            </figcaption>
    </figure>
</p>
<p>The status circles should be entirely green - this indicates that all nodes, services and instances are healthy. Other status pages can be accessed by expanding items in the leftmost pane. Issues can be tracked down to the failing component by expanding items with warning triangles or error icons on. The next few diagrams show the status pages for a healthy system.</p>
<p>After expanding the application, clicking on any of the services should display a green circle and <code>Status = Active</code>:</p>

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Service.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Service</h4>
            </figcaption>
    </figure>

<p>After expanding either of the services, clicking on any of the instances/partitions should display a green circle and <code>Status = Ready</code>:</p>

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Instance.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Instance</h4>
            </figcaption>
    </figure>

<p>Clicking on any of the nodes at the bottom of the leftmost pane should display a green circle and <code>Status = Up</code>:</p>

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Node.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Node</h4>
            </figcaption>
    </figure>

<p>If any warning triangles appear, wait for 5 minutes or so as the cluster may still be starting up. If the cluster looks OK, go to the next section.</p>
<p>If the warnings persist or anything on the screen goes red, expand the items to find the individual services and instances which have errors or warnings. Warnings should not be ignored as they can indicate that the service can’t start but is still in the retry phase. Error and warning messages should be displayed on the status screens and should indicate what is wrong.</p>
<p>If no useful message can be seen here, the service log files may contain more information. These can be found on each Application Server at:</p>
<ul>
<li>%ProgramData%/Cortex/Cortex API Gateway Service</li>
<li>%ProgramData%/Cortex/Cortex Flow Execution Service</li>
</ul>
<p>If no solution can be found, please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for further assistance.</p>
</li>
</ol>
<h2 id="preserve-installation-files">Preserve installation files</h2>
<p>Ensure that the installation files are backed up or kept on the server, especially the scripts and config files that have been modified. This will make it easier to perform further actions in future, such as troubleshooting, certificate rollover, uninstallation, reinstallation and updates.</p>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server">Install Web Application Server</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1226740248b38053cf2a2b7f45b33b10">1.4 - Install the Web Application Server</h1>
    <div class="lead">Information about installing the Web Application Server.</div>
	<h1 id="install-the-web-application-server">Install the Web Application Server</h1>
<p>This guide describes how to install the Web Application Server. Please ensure that <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-application-and-loadbalancer-servers">Install Application Servers and Load Balancer</a> has been completed before starting this installation.</p>
<h2 id="make-installation-artefacts-available">Make Installation Artefacts Available</h2>
<ol>
<li>
<p>We recommend that the Flow Debugger Service and Gateway are installed on the same Web Application Server. Copy the following artefacts to a folder on the machine (the version numbers may differ):</p>
<ul>
<li>Cortex Innovation 2022.9 - Block Packages.zip</li>
<li>Cortex Innovation 2022.9 - Gateway.zip</li>
<li>Cortex Innovation 2022.9 - Flow Debugger Service.zip</li>
<li>Cortex Innovation 2022.9 - Web App Server Install Scripts.zip</li>
</ul>
</li>
<li>
<p>Extract the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts.zip</code> zip file to a folder with the same name.</p>
</li>
</ol>
<h2 id="install-prerequisites">Install Prerequisites</h2>
<h3 id="licensing">Licensing</h3>
<p>Ensure that a valid Cortex licence file named <code>Cortex.lic</code> exists on the Web Application server, in the location <code>%ProgramData%\Cortex\Licences</code>. If it does not, follow the instructions located at <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites#licensing-requirements">Licensing Requirements</a>.</p>
<h3 id="install-sql-server-or-sql-express">Install SQL Server or SQL Express</h3>
<ol>
<li>Use one of the following installation guides to install SQL Server or SQL Server Express:
<ul>
<li><a href="/pdfs/Cortex Innovation - SQL Server 2019 Installation Guide.pdf">Cortex Innovation - SQL Server 2019 Installation Guide</a></li>
<li><a href="/pdfs/Cortex Innovation - SQL Server 2016 Installation Guide.pdf">Cortex Innovation - SQL Server 2016 Installation Guide</a></li>
<li><a href="/pdfs/Cortex Innovation - SQL Server 2016 Express Installation Guide.pdf">Cortex Innovation - SQL Server 2016 Express Installation Guide</a></li>
</ul>
</li>
</ol>
<h3 id="install-microsoft-net-framework-471">Install Microsoft .NET Framework 4.7.1</h3>
<p>Gateway requires a minimum of Microsoft .NET Framework 4.7.1.</p>
<p>To find the version of the framework that is installed:</p>
<ol>
<li>On the Start menu, choose <code>Run</code>.</li>
<li>In the open box, enter <code>regedit.exe</code>. You must have administrative credentials to run regedit.exe.</li>
<li>In the Registry Editor, open the subkey <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full</code>.</li>
<li>If the <code>Full</code> subkey is not present, then you do not have the .NET Framework 4.5 or later installed.</li>
<li>Check for a <code>DWORD</code> value named <code>Release</code>. The existence of the Release DWORD indicates the .NET Framework 4.5 or newer has been installed on that computer. If the value is <code>461308</code> or over then at least .NET Framework 4.7.1 is installed and no further steps need to be taken. If it is not installed, continue with the following steps to install it.</li>
</ol>
<p>To install .NET Framework 4.7.1:</p>
<ol>
<li>Download the <a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">.NET Framework 4.7.1</a> installer.</li>
<li>Double-click on the installer file to run it.</li>
<li>Follow the wizard to complete the installation.</li>
</ol>
<h3 id="install-microsoft-web-deploy">Install Microsoft Web Deploy</h3>
<ol>
<li>Check if Web Deploy is already installed by going to <code>Control Panel</code> → <code>Programs</code> → <code>Programs and Features</code>; if Web Deploy is already installed, it will be listed as <code>Microsoft Web Deploy</code>.</li>
<li>If it is not installed, download <a href="https://www.microsoft.com/en-gb/download/details.aspx?id=43717">Microsoft Web Deploy</a> version 3.0 or later (WebDeploy_amd64_en-US.exe) to the server.</li>
<li>Double-click the downloaded file to start the installation.</li>
<li>Follow the installation wizard to install Web Deploy; on the <code>Choose Setup Type</code> page select <code>Typical</code>.</li>
</ol>
<h3 id="install-visual-c-redistributable">Install Visual C++ Redistributable</h3>
<ol>
<li>Check if Visual C++ 2013 Redistributable (x64) is already installed by going to <code>Control Panel</code> → <code>Programs</code> → <code>Programs and Features</code>; if Visual C++ Redistributable is already installed, it will be listed as <code>Microsoft Visual C++ 2013 Redistributable (x64)</code>.</li>
<li>If it is not installed, download <a href="http://www.microsoft.com/en-us/download/details.aspx?id=40784">Visual C++ Redistributable 2013 (x64)</a>.</li>
<li>Double-click the downloaded file to start the installation.</li>
<li>Follow the installation wizard to install the Visual C++ Redistributable.</li>
</ol>
<h3 id="install-certificate">Install Certificate</h3>
<p>Both Gateway and the Flow Debugger Service require an X.509 SSL certificate to be installed on the Web Application Server. The certificate must have the following properties:</p>
<ul>
<li>Enhanced Key Usage: <code>Server Authentication</code> and <code>Client Authentication</code></li>
<li>Subject Alternative Names (SAN): At minimum the FQDN of the Server. It can also include NetBIOS Name, IP address, localhost, 127.0.0.1</li>
</ul>
<p>If the user tries to navigate to an address not in the SAN list, then they will receive a certificate error.</p>
<p>Wildcard certificates and self-signed certificates can also be used. However, self-signed certificates are not recommended for production instances. Details on how to create a self-signed certificate can be found at <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/self-signed-certificates">Create Self-Signed Certificates</a>.</p>
<p>You can import the certificate by right clicking the certificate file, selecting <code>Install Certificate</code> and following the wizard. When prompted, ensure you import it into the <code>Local Machine</code> store and not <code>Current User</code>.</p>
<p>To verify the certificate is imported:</p>
<ol>
<li>Click the Windows button (<code>Start</code>)</li>
<li>Type <code>certlm.msc</code> and press <code>Enter</code> to open the Certificate Manager dialog</li>
<li>Expand <code>Personal</code> and select <code>Certificates</code></li>
<li>You should see your certificate in this store</li>
</ol>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    It is critical to set a reminder to <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/rollover-certificates">update certificates</a> in good time before they expire. If they expire then the platform will cease to function and <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> must be contacted for support.

</div>

<h3 id="iis-role-setup-and-configuration">IIS Role Setup and Configuration</h3>
<h4 id="install-internet-information-services-iis">Install Internet Information Services (IIS)</h4>
<p>Install the required features by following these instructions:</p>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Web App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Install.WindowsFeatures.ps1</code> script using the following command, this may take a few minutes:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WindowsFeatures</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Check the output is as follows:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Web-WebSockets is installed
</span></span><span style="display:flex;"><span>Web-Asp-Net45 is installed
</span></span><span style="display:flex;"><span>Web-Net-Ext45 is installed
</span></span><span style="display:flex;"><span>Web-ISAPI-Ext is installed
</span></span><span style="display:flex;"><span>Web-ISAPI-Filter is installed
</span></span><span style="display:flex;"><span>Net-Framework-45-Core is installed
</span></span><span style="display:flex;"><span>Net-Framework-45-ASPNET is installed
</span></span><span style="display:flex;"><span>Web-Default-Doc is installed
</span></span><span style="display:flex;"><span>Web-Dir-Browsing is installed
</span></span><span style="display:flex;"><span>Web-Http-Errors is installed
</span></span><span style="display:flex;"><span>Web-Static-Content is installed
</span></span><span style="display:flex;"><span>Web-Http-Logging is installed
</span></span><span style="display:flex;"><span>Web-Http-Redirect is installed
</span></span><span style="display:flex;"><span>Web-Request-Monitor is installed
</span></span><span style="display:flex;"><span>Web-Stat-Compression is installed
</span></span><span style="display:flex;"><span>Web-Dyn-Compression is installed
</span></span><span style="display:flex;"><span>Web-Filtering is installed
</span></span><span style="display:flex;"><span>Web-Windows-Auth is installed
</span></span><span style="display:flex;"><span>Web-Mgmt-Console is installed
</span></span><span style="display:flex;"><span>Web-Mgmt-Service is installed
</span></span></code></pre></div></li>
</ol>
<h4 id="register-and-allow-net-clr-v4030319-with-iis">Register and Allow .NET CLR v4.0.30319 with IIS</h4>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Unless .NET CLR v4.0.30319 is registered and allowed with IIS, Gateway and Flow Debugger Service will not work.

</div>

<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Run the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">Dism</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#000">online</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#204a87">enable-feature</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#000">featurename</span><span style="color:#a40000">:</span><span style="color:#204a87">IIS-ASPNET45</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#000">all</span>
</span></span></code></pre></div></li>
<li>
<p>Once PowerShell confirms that it has finished installing .NET CLR v4.0.30319, close the PowerShell window.</p>
</li>
</ol>
<h3 id="install-url-rewrite-module">Install URL Rewrite Module</h3>
<p>The URL Rewrite IIS Manager module is required to enable web applications on your server to rewrite URLs. This is needed to allow HTTP URLs to redirect to the equivalent HTTPS ones.</p>
<p>To install the URL Rewrite module take the following steps:</p>
<ol>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, select the server node.</li>
<li>Ensure that there is an icon with the title <code>URL Rewrite</code> under the <code>IIS</code> feature section:

    <figure class="centre">
        <img src=" /images/Url%20Rewrite%20Icon.png "/> <figcaption>
                <h4>Url Rewrite Module Icon</h4>
            </figcaption>
    </figure>
</li>
<li>If there is an icon, <code>URL Rewrite</code> module is installed and no further steps are required.</li>
<li>If there is no icon, the module is not installed and the following steps must be taken:
<ol>
<li>Download the <a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite</a> module installer.</li>
<li>Double-click on the installer file to run it.</li>
<li>Follow the wizard to complete the installation.</li>
<li>After successfully installing, close and reopen <code>IIS Manager</code>. The <code>URL Rewrite</code> icon should now be visible.</li>
</ol>
</li>
</ol>
<h3 id="apply-recommended-security-measures">Apply Recommended Security Measures</h3>
<p>These are non-compulsory security measures, recommended to be applied to Web Application Servers, in order to prevent potential attacks that exploit known industry security vulnerabilities.</p>
<p>Applying these measures may impact other applications running on your server. Therefore, it is your responsibility to ensure that other applications and their clients will not be affected by the changes.</p>
<h4 id="only-use-recommended-encryption-algorithms-and-tls-protocols">Only Use Recommended Encryption Algorithms and TLS Protocols</h4>
<p>A collection of registry settings need to be applied to guarantee your server is only using the recommended encryption algorithms and TLS protocols. Information about these settings can be found at <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/ssl-best-practices">SSL Best Practices</a>.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    Disabling specific TLS versions or specific Cipher Suites can have impact on Cortex components themselves as well as their communication capabilities with third party systems and services, e.g. Flow Debugger Service executing flows with blocks which communicate with 3rd parties via PowerShell or REST. All parties communicating together must support a shared protocol version and cipher suite, otherwise they will not be able to establish a secure communication link between each other.

</div>

<p>Apply the settings by following these instructions:</p>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Web App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Install.SSLBestPractices.ps1</code> script using the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SSLBestPractices</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    To avoid answering all of the prompts <code>-Override 0</code> can be added to the end of the script. This will automatically apply all settings and forcibly restart the server.

</div>

<p>If <code>-Override 0</code> has been specified no further steps need to be taken and you can move on to the next section when the server has restarted.</p>
</li>
<li>
<p>To use all the recommended settings click <code>Apply all</code> to the first prompt.</p>
<p>To selectively apply each setting select <code>Choose which to apply</code>. Each change will then be prompted with a Yes/No confirmation before applying.</p>
</li>
<li>
<p>Restart the machine when the script asks.</p>
</li>
</ol>
<h3 id="add-https-firewall-rule">Add HTTPS Firewall Rule</h3>
<p>If any firewall is running on the Web Application Server, it must be configured to allow communication inbound via TCP on the port configured for HTTPS (usually 443). See <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/configure-firewalls">Configure Firewalls</a> for information about adding rules to Windows Firewall.</p>
<h2 id="create-web-site">Create Web Site</h2>
<p>Gateway and Flow Debugger Service can either be installed to an existing web site or a newly created web site. If you are installing into an existing web site skip to <a href="#configure-web-site">Configure Web Site</a>.</p>
<p>The steps to create a new web site are:</p>
<ol>
<li>In Windows File Explorer, navigate to the default IIS folder (usually <code>%SystemDrive%\inetpub\wwwroot</code>, e.g. <code>C:\inetpub\wwwroot</code>).</li>
<li>Ensure there is a folder called <code>Cortex</code>; if not create it.</li>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, expand the server node.</li>
<li>Right-click the <code>Sites</code> node under the server and select <code>Add Website…</code>.</li>
<li>Set the <code>Site name</code> to <code>Cortex</code>.</li>
<li>Set the <code>Physical path</code> to the folder created above (e.g. <code>C:\inetpub\wwwroot\Cortex</code>), by clicking on the ellipses <code>…</code>, selecting the appropriate directory and clicking <code>OK</code>.</li>
<li>Click <code>OK</code>. If an existing site is already using the specified port, a warning will be displayed. Either click <code>No</code> and change the <code>Port</code> in the <code>Add Website</code> dialog, or click <code>Yes</code> and stop the other website.</li>
</ol>
<h2 id="configure-web-site">Configure Web Site</h2>
<p>The web site which the Gateway and Flow Debugger Service are installed under requires additional configuration.</p>
<h3 id="configure-https">Configure HTTPS</h3>
<p>Both the Gateway and Flow Debugger Service should be configured to use HTTPS:</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    For sites using self-signed SSL certificates, the HTTPS URL redirection will only work in Google Chrome browsers. For all other supported browsers, an SSL certificate signed by a Certificate Authority must be used to enable HTTPS URL redirection.

</div>

<ol>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, expand the server node.</li>
<li>Expand the <code>Sites</code> node under the server.</li>
<li>Right-click the web site where Gateway will be installed and select <code>Edit Bindings…</code>.</li>
<li>Click <code>Add…</code></li>
<li>Set Type to <code>https</code>.</li>
<li>Set the appropriate Port number (typically 443). The <code>Host name</code> box can be left blank.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Configuring your system to use a port other than the HTTPS default of 443 is not compatible with HTTP Strict Transport Security (HSTS). If your configuration requires HTTPS to run on a port other than 443, the HSTS configuration must be turned off. This can be achieved by configuring the <code>Add Strict-Transport-Security when HTTPS</code> rewrite rule’s <code>enabled</code> setting to <code>false</code> in web.config after installation.

</div>
</li>
<li>Select the SSL certificate that was installed in the <a href="#install-certificate">Install Certificate</a> section.</li>
<li>Click <code>OK</code>. If an existing site is already using the specified SSL port, a warning will be displayed. Either click <code>No</code> and change the <code>Port</code> in the <code>Add Site Binding</code> dialog, or click <code>Yes</code> and stop the other website.</li>
<li>It is recommended to remove the <code>http</code> site binding.</li>
</ol>
<h2 id="install-flow-debugger-service">Install Flow Debugger Service</h2>
<h3 id="get-application-pool-user">Get Application Pool User</h3>
<p>A domain user account is required for the Flow Debugger Service web application pool and must be created prior to performing the installation. In line with best practices, this account should not be used for any purposes other than those specified for the Flow Debugger Service. Alternatively, the <code>NETWORK SERVICE</code> user may also be used.</p>
<p>This user must currently have access to the default NuGet directory, in order to load block packages correctly. To add permissions for the user take the following steps:</p>
<ol>
<li>Navigate to <code>%SystemRoot%\System32\config\systemprofile\AppData\Roaming\</code> and create a new folder named <code>NuGet</code> if one does not exist.</li>
<li>Right-click on the <code>NuGet</code> folder and click <code>Properties</code>.</li>
<li>In the dialog, click the <code>Security</code> tab.</li>
<li>Click the <code>Edit...</code> button.</li>
<li>Click the <code>Add...</code> button.</li>
<li>Enter the username of the application pool user and click <code>OK</code>.</li>
<li>In the <code>Permissions</code> section at the bottom, check <code>Full control</code></li>
<li>Click <code>OK</code>.</li>
</ol>
<p>The user must be given <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions. To do this take the following steps:</p>
<ol>
<li>Navigate to <code>Start</code> -&gt; <code>Administrative Tools</code> -&gt; <code>Local Security Policy</code>.</li>
<li>In the Local Security Policy dialog, expand the <code>Local Policies</code> node then select <code>User Rights Assignment</code>.</li>
<li>Take the following steps for the <code>Log on as a service</code> and <code>Log on as a batch job</code> policies:
<ol>
<li>In the right-hand panel, double-click on the policy.</li>
<li>In the Properties dialog, click on the <code>Add User or Group</code> button.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    It is possible to use the <code>Advanced…</code> button to look up names rather than entering them manually. Various filters can be set to find the correct user or group more easily. Multiple users can be selected by holding down <code>CTRL</code> while clicking. <code>OK</code> adds the selected users or groups into the <code>Enter the object names to select</code> text box.

</div>
</li>
<li>Type the name of the application pool user account into the <code>Enter the object names to select</code> text box. Click the <code>Check Names</code> button to confirm that the user exists.</li>
<li>Click <code>OK</code> on the Select Users dialog, and then confirm the user is correct by clicking <code>OK</code> on the Properties dialog.</li>
</ol>
</li>
</ol>
<h3 id="configure-installation-script">Configure Installation Script</h3>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder, locate the <code>Cortex.Innovation.Install.FlowDebuggerService.ps1</code> script and open it with a text editor.</p>
</li>
<li>
<p>Choose the tab below that matches the configuration for this installation, then update the script to match, changing the parameters according to the details given below:</p>

        














        














    <ul class="nav nav-tabs" id="tabs-9" role="tablist"><li class="nav-item">
      <a class="nav-link active"
        id="tabs-9-0-tab" data-toggle="tab" href="#tabs-9-0" role="tab"
        aria-controls="tabs-9-0" aria-selected="true">
        CA Certs
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-9-1-tab" data-toggle="tab" href="#tabs-9-1" role="tab"
        aria-controls="tabs-9-1" aria-selected="false">
        Self-Signed Certs
      </a>
    </li></ul>


<div class="tab-content" id="tabs-9-content"><div class="tab-pane fade show active"
        id="tabs-9-0" role="tabpanel" aria-labelled-by="tabs-9-0-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FlowDebuggerService</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerServicePath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Flow Debugger Service.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$AppPoolIdentity</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-flow-debugger-service-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  <div class="tab-pane fade"
        id="tabs-9-1" role="tabpanel" aria-labelled-by="tabs-9-1-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FlowDebuggerService</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerServicePath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Flow Debugger Service.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-UseSelfSignedCertificates</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$AppPoolIdentity</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-flow-debugger-service-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  
</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FlowDebuggerServicePath</code></td>
<td>Configure this value with the location of the Flow Debugger Service zip file on the Web Application Server.</td>
</tr>
<tr>
<td><code>BlockPackagesPath</code></td>
<td>Configure this value with the location of the Block Packages zip file on the Web Application Server.</td>
</tr>
<tr>
<td><code>FlowDebuggerBasicAuthUserName</code></td>
<td>Configure this value with the username that will be used for Basic Authentication when Gateway makes HTTPS requests to the Flow Debugger Service. <br /><br />For security reasons it is recommended that the default value <code>BasicAuthUser</code> should be changed.<br /><br />Currently only Basic Authentication using a single user is supported, OAuth2 will be supported in a future release.<br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>FlowDebuggerBasicAuthPwd</code></td>
<td>Configure this value with the password that will be used for Basic Authentication when Gateway makes HTTPS requests to the Flow Debugger Service. <br /><br />This password should be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>. For security reasons it is recommended that the default value <code>ADA9883B11BD4CDC908B8131B57944A4</code> should be changed.<br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>UseSelfSignedCertificates</code></td>
<td>Enables Flow Debugger Service to communicate with Gateway using generated Self-Signed Certificates rather than CA Certificates.  <br /><br /> Not recommended for production use.</td>
</tr>
<tr>
<td><code>Credential</code></td>
<td>The credentials of the user that will be used to run the <code>Debugger</code> application pool in IIS. <br /><br /> This does not need to be changed, a prompt will appear to enter this information when the script is run.</td>
</tr>
<tr>
<td><code>AcceptEULA</code></td>
<td>This does not need to be changed, the EULA will be accepted at a later stage.</td>
</tr>
<tr>
<td><code>FilePath</code></td>
<td>The filename that installation logs are written to.  If this should be written to a different location than where the installation files are then a full path should be specified.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save and close <code>Cortex.Innovation.Install.FlowDebuggerService.ps1</code>.</p>
</li>
</ol>
<h3 id="run-installation-script">Run Installation Script</h3>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Web App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FlowDebuggerService</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to install the Flow Debugger Service.</p>
</li>
<li>
<p>A credentials prompt will appear. Enter the credentials of the user that should run the <code>Debugger</code> application pool in IIS. If using the <code>NETWORK SERVICE</code> user, enter any user as the username and leave the password blank; the <code>NETWORK SERVICE</code> user will need to be selected in the final step.</p>
</li>
<li>
<p>Wait for the script to finish running. This should take approximately 2 minutes.</p>
</li>
<li>
<p>An error may have appeared saying:</p>
<pre tabindex="0"><code>The Windows Process Activation Service service is not started.
</code></pre><p>This can be ignored.</p>
</li>
<li>
<p>Check that there have been no other errors in the script; these would appear in red in the console.</p>
<p>If there are any errors, then please follow any instructions given within them to rectify the situation, and retry the installation.</p>
<p>If the errors do not give any instructions on how to rectify, please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for further assistance.</p>
</li>
<li>
<p>If using <code>NETWORK SERVICE</code> for the application pool user:</p>
<ol>
<li>Open Internet Information Services (IIS) Manager.</li>
<li>On the left, expand the server node.</li>
<li>Click <code>Application Pools</code>.</li>
<li>Right-click on the <code>Debugger</code> application pool and select <code>Advanced Settings...</code>.</li>
<li>In the <code>Advanced Settings</code> dialog, click on <code>Identity</code> and then click the ellipses (<code>...</code>).</li>
<li>In the <code>Application Pool Identity</code> dialog, select <code>Built-in account</code>, then select <code>NetworkService</code> from the drop-down, then click <code>OK</code>.</li>
<li>Right-click on the <code>Debugger</code> application pool and click <code>Recycle...</code>.</li>
</ol>
</li>
</ol>
<h2 id="install-gateway">Install Gateway</h2>
<h3 id="get-application-pool-user-1">Get Application Pool User</h3>
<p>A domain user account is required for the Gateway web application pool and must be created prior to performing the installation
below.</p>
<p>This user account is required to enable Gateway to access the Cortex database, with the following roles:</p>
<ul>
<li>dbcreator</li>
<li>public</li>
</ul>
<p>To add roles to database users take the following steps:</p>
<ol>
<li>
<p>Open SQL Server Management Studio on the Web Application Server and log in.</p>
</li>
<li>
<p>Expand the server node, then <code>Security</code> then <code>Logins</code>.</p>
</li>
<li>
<p>If the user that will run the Gateway application pool is not in the list of logins, take the following steps, otherwise skip to step 4:</p>
<ol>
<li>Right-click the <code>Logins</code> node and click <code>New Login...</code>.</li>
<li>Enter the application pool user in the <code>Login name</code> box.</li>
<li>On the left pane, click <code>Server Roles</code>.</li>
<li>Check <code>public</code> and <code>dbcreator</code></li>
<li>Click <code>OK</code>.</li>
</ol>
</li>
<li>
<p>If the user that will run the Gateway application pool is in the list of logins, take the following steps:</p>
<ol>
<li>Right-click on the application pool user.</li>
<li>Click <code>Properties</code>.</li>
<li>On the left pane, click <code>Server Roles</code>.</li>
<li>Check <code>public</code> and <code>dbcreator</code>.</li>
<li>Click <code>OK</code>.</li>
</ol>
</li>
</ol>
<p>In line with best practices, this account should not be given administrator rights, nor should it be used for any purposes other than those specified for Gateway.</p>
<p>The user must be given <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions. To do this take the following steps:</p>
<ol>
<li>Navigate to <code>Start</code> -&gt; <code>Administrative Tools</code> -&gt; <code>Local Security Policy</code>.</li>
<li>In the Local Security Policy dialog, expand the <code>Local Policies</code> node then select <code>User Rights Assignment</code>.</li>
<li>Take the following steps for the <code>Log on as a service</code> and <code>Log on as a batch job</code> policies:
<ol>
<li>In the right-hand panel, double-click on the policy.</li>
<li>In the Properties dialog, click on the <code>Add User or Group</code> button.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    It is possible to use the <code>Advanced…</code> button to look up names rather than entering them manually. Various filters can be set to find the correct user or group more easily. Multiple users can be selected by holding down <code>CTRL</code> while clicking. <code>OK</code> adds the selected users or groups into the <code>Enter the object names to select</code> text box.

</div>
</li>
<li>Type the name of the application pool user account into the <code>Enter the object names to select</code> text box. Click the <code>Check Names</code> button to confirm that the user exists.</li>
<li>Click <code>OK</code> on the Select Users dialog, and then confirm the user is correct by clicking <code>OK</code> on the Properties dialog.</li>
</ol>
</li>
</ol>
<h3 id="create-gateway-application-pool">Create Gateway Application Pool</h3>
<ol>
<li>Open Internet Information Services (IIS) Manager.</li>
<li>Select and right-click the <code>Application Pools</code> node under the server and select <code>Add Application Pool…</code></li>
<li>Set <code>Name</code> to <code>Cortex Gateway</code>.</li>
<li>Ensure that the <code>.NET CLR version</code> is set to <code>.NET CLR Version v4.0.30319</code> (This may be configured by default).</li>
<li>Ensure that the <code>Managed pipeline mode</code> is set to <code>Integrated</code> (This may be configured by default).</li>
<li>Click <code>OK</code></li>
<li>Right click on the created application pool and select <code>Advanced Settings…</code></li>
<li>Click the <code>...</code> next to <code>Identity</code> (under Process Model) to open a dialog, then select <code>Custom Account</code> and <code>Set...</code>.</li>
<li>Enter the username and password for the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a>.</li>
<li>Click <code>OK</code> to close the <code>Set Credentials</code> dialog.</li>
<li>Click <code>OK</code> to close the <code>Application Pool Identity</code> dialog.</li>
<li>Click <code>OK</code> to close the <code>Advanced Settings</code> dialog.</li>
</ol>
<h3 id="create-new-web-application">Create New Web Application</h3>
<ol>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, expand the server node.</li>
<li>Right-click on the <a href="#create-web-site">site</a> the application should be installed under and select <code>Add Application…</code></li>
<li>Set the <code>Alias</code> to <code>gateway</code>. This must be lowercase.</li>
<li>Click <code>Select…</code> and from the Application pool dropdown select the <code>Cortex Gateway</code> application pool and click <code>OK</code>.</li>
<li>Set the <code>Physical path</code> to <code>C:\inetpub\wwwroot\Cortex\Gateway</code> by clicking on the ellipses <code>…</code> and selecting the appropriate directory. Create the <code>C:\inetpub\wwwroot\Cortex\Gateway</code> directory if it does not already exist.</li>
<li>Click <code>OK</code>.</li>
</ol>
<h3 id="configure-iis-site-redirect-to-the-specified-web-application-optional">Configure IIS Site Redirect to the Specified Web Application (Optional)</h3>
<p>If the site hosting the Gateway web application is a newly created Cortex site or an existing site that doesn’t have its own content, it is recommended to redirect the site URL to the <code>gateway</code> web application URL, e.g. <code>https://FullyQualifiedDomainName</code> to <code>https://FullyQualifiedDomainName/gateway</code>.</p>
<ol>
<li>Open Internet Information Services (IIS) Manager.</li>
<li>Select the site hosting the <code>gateway</code> web application and from IIS settings double-click the <code>HTTP Redirect</code> icon.</li>
<li>Click the check box <code>Redirect requests to this destination</code>.</li>
<li>Enter <code>https://FullyQualifiedDomainName/gateway</code>, replacing <code>FullyQualifiedDomainName</code> with the FQDN of the server.</li>
<li>In the <code>Redirect Behaviour</code> section, click <code>Only redirect requests to content in this directory (not subdirectories)</code>.</li>
<li>In <code>Actions</code> click the <code>Apply</code> button.</li>
</ol>
<h3 id="configure-installation-script-1">Configure Installation Script</h3>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder, locate the <code>Cortex.Innovation.Install.Gateway.ps1</code> script and open it with a text editor.</p>
</li>
<li>
<p>Configure the script according to the details given below:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Gateway</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-GatewayPackagePath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Gateway.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-GatewayApplicationIISPath</span> <span style="color:#4e9a06">&#34;Cortex\gateway&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ModelDBContextConnectionString</span> <span style="color:#4e9a06">&#34;Data Source=localhost;Initial Catalog=CortexWeb;Integrated Security=True;MultipleActiveResultSets=True&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-AuthContextConnectionString</span> <span style="color:#4e9a06">&#34;Data Source=localhost;Initial Catalog=CortexWeb.Auth;Integrated Security=True;MultipleActiveResultSets=True&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-SignalRContextConnectionString</span> <span style="color:#4e9a06">&#34;Data Source=localhost;Initial Catalog=CortexWeb.SignalR;Integrated Security=True;MultipleActiveResultSets=True&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-FeatureFlags</span> <span style="color:#4e9a06">&#34;InnovationId&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricApiGatewayEndpoint</span> <span style="color:#4e9a06">&#34;https://server.domain.com/&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricUsingSelfSignedCertificates</span> <span style="color:#000">$false</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricApiGatewayBasicAuthUsername</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricApiGatewayBasicAuthPassword</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerEndpoint</span> <span style="color:#4e9a06">&#34;https://server.domain.com/debugger/api/&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerBasicAuthUsername</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerBasicAuthPassword</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerUsingSelfSignedCertificates</span> <span style="color:#000">$false</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-Test:</span><span style="color:#000">$Test</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-gateway-install-log.txt&#34;</span>
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GatewayPackagePath</code></td>
<td>Configure this value with the location of the <code>Cortex Innovation 2022.9 - Gateway.zip</code> file on the installation server.</td>
</tr>
<tr>
<td><code>GatewayApplicationIISPath</code></td>
<td>Change to the correct <code>Site Name/Application</code> if either was modified from the defaults (<code>Cortex/gateway</code>) when creating the <a href="#create-web-site">website</a> or <a href="#create-new-web-application">application</a>.</td>
</tr>
<tr>
<td><code>ModelDBContextConnectionString</code></td>
<td>If SQL Server was installed as the default instance, change the <code>Data Source</code>in the connection string to <code>localhost</code> or, if it was installed on another machine, change it to the machine name.<br /><br />If SQL Server was installed as a named instance, change it to <code>.\{instanceName}</code> replacing <code>{instanceName}</code> with the name of the instance or, if SQL Server was installed on a different machine, change it to <code>{machineName}\{instanceName}</code> replacing <code>{machineName}</code> with the machine name and <code>{instanceName}</code> with the name of the instance. <br /><br />This will set the <code>ModelDBContextConnectionString</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>AuthContextConnectionString</code></td>
<td>If SQL Server was installed as the default instance, change the <code>Data Source</code>in the connection string to <code>localhost</code> or, if it was installed on another machine, change it to the machine name.<br /><br />If SQL Server was installed as a named instance, change it to <code>.\{instanceName}</code> replacing <code>{instanceName}</code> with the name of the instance or, if SQL Server was installed on a different machine, change it to <code>{machineName}\{instanceName}</code> replacing <code>{machineName}</code> with the machine name and <code>{instanceName}</code> with the name of the instance. <br /><br />This will set the <code>AuthContextConnectionString</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>SignalRContextConnectionString</code></td>
<td>If SQL Server was installed as the default instance, change the <code>Data Source</code>in the connection string to <code>localhost</code> or, if it was installed on another machine, change it to the machine name.<br /><br />If SQL Server was installed as a named instance, change it to <code>.\{instanceName}</code> replacing <code>{instanceName}</code> with the name of the instance or, if SQL Server was installed on a different machine, change it to <code>{machineName}\{instanceName}</code> replacing <code>{machineName}</code> with the machine name and <code>{instanceName}</code> with the name of the instance. <br /><br />This will set the <code>SignalRContextConnectionString</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>FeatureFlags</code></td>
<td>Replace <code>InnovationId</code> with the Cortex Innovation feature identifier, which should have been provided by Cortex when fulfilling the <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites#licensing-requirements">Licensing Requirements</a>, if it wasn&rsquo;t it should be requested using <a href="https://support.cortex.co.uk/">Cortex Service Portal</a>.<br /><br />This will set the <code>FeatureFlags</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricApiGatewayEndpoint</code></td>
<td>Replace <code>server.domain.com</code> with the fully qualified domain name of the Load Balancer Server. The port should be specified if it is not the default HTTPS port (443), and there must be a trailing slash, e.g. <code>https://server.domain.com/</code> or <code>https://server.domain.com:8722/</code>.<br /><br />This will set the <code>ServiceFabricApiGatewayEndpoint</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricUsingSelfSignedCertificates</code></td>
<td>Configure the value as <code>$false</code> if you used valid CA certificates when <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-application-and-loadbalancer-servers#configure-installation-script">installing the Application Servers</a>, <code>$true</code> if you used self-signed certificates.<br /><br />This will set the <code>ServiceFabricUsingSelfSignedCertificates</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricApiGatewayBasicAuthUsername</code></td>
<td>This must be changed if you used a non-default <code>ApiGatewayBasicAuthUserName</code> when <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-application-and-loadbalancer-servers#configure-installation-script">installing the Application Servers</a>; if so, this value must be configured to the one used.<br /><br />This will set the <code>ServiceFabricApiGatewayBasicAuthUsername</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricApiGatewayBasicAuthPassword</code></td>
<td>This must be changed if you used a non-default <code>ApiGatewayBasicAuthPassword</code> when <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-application-and-loadbalancer-servers#configure-installation-script">installing the Application Servers</a>; if so, this value must be configured to the one used. It can be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>.<br /><br />This will set the <code>ServiceFabricApiGatewayBasicAuthPassword</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerEndpoint</code></td>
<td>Replace <code>server.domain.com</code> with the fully qualified domain name of the Web Application Server.<br /><br />This will set the <code>DotNetFlowDebuggerEndpoint</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerBasicAuthUsername</code></td>
<td>This must be changed if you used a non-default <code>FlowDebuggerBasicAuthUserName</code> when <a href="#configure-installation-script">installing the Flow Debugger Service</a>; if so, this value must be configured to the one used.<br /><br />This will set the <code>DotNetFlowDebuggerBasicAuthUsername</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerBasicAuthPassword</code></td>
<td>This must be changed if you used a non-default <code>FlowDebuggerBasicAuthPassword</code> when <a href="#configure-installation-script">installing the Flow Debugger Service</a>; if so, this value must be configured to the one used. It can be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>.<br /><br />This will set the <code>DotNetFlowDebuggerBasicAuthPassword</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerUsingSelfSignedCertificates</code></td>
<td>Configure the value as <code>$false</code> if you are using valid CA certificates to secure the site containing Gateway and Flow Debugger Service, <code>$true</code> if using self-signed certificates.<br /><br />This will set the <code>DotNetFlowDebuggerUsingSelfSignedCertificates</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>Test</code></td>
<td>This does not need to be changed, it will be set at a later stage.</td>
</tr>
<tr>
<td><code>AcceptEULA</code></td>
<td>This does not need to be changed, the EULA will be accepted at a later stage.</td>
</tr>
<tr>
<td><code>FilePath</code></td>
<td>The filename that installation logs are written to.  If this should be written to a different location than where the installation files are then a full path should be specified.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save and close <code>Cortex.Innovation.Install.Gateway.ps1</code>.</p>
</li>
</ol>
<h3 id="test-installation-script">Test Installation Script</h3>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Web App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Gateway</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-Test</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-Test</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to test the configuration.
In the event of any errors, there will be an error message displayed at the end of the output with a line confirming the Error Count.</p>
</li>
</ol>
<h3 id="run-installation-script-1">Run Installation Script</h3>
<ol>
<li>
<p>Ensure the Gateway application pool is stopped:</p>
<ol>
<li>Open Internet Information Service (IIS) Manager.</li>
<li>In the left pane, expand the server node.</li>
<li>Click <code>Application Pools</code> to display a list of the Application Pools.</li>
<li>Right-click the <code>Cortex Gateway</code> application pool and select <code>Stop</code>.</li>
</ol>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Failure to stop the application pool will result in a permissions error when installing Gateway.

</div>

</li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Gateway</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to install Gateway.
In the event of any errors, there will be an error message displayed at the end of the output with a line confirming the Error Count.</p>
</li>
<li>
<p>Ensure that the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a> has <code>Full control</code> access to the Gateway folder created in <a href="#create-new-web-application">Create New Web Application</a>:</p>
<ol>
<li>Navigate to <code>C:\inetpub\wwwroot\Cortex\</code>.</li>
<li>Right-click the <code>Gateway</code> folder and click <code>Properties</code>.</li>
<li>In the <code>Gateway Properties</code> dialog, click the <code>Security</code> tab.</li>
<li>Click the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a> within the <code>Group or user names</code> section.</li>
<li>In the <code>Permissions</code> section, ensure the user has <code>Full control</code> checked. If not:
<ol>
<li>Click the <code>Edit...</code> button.</li>
<li>Select the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a> within the <code>Group or user names</code> section.</li>
<li>In the <code>Permissions</code> section, check <code>Full control</code>.</li>
<li>Click <code>OK</code>, then wait for <code>Windows Security</code> to update the security information to the folder.</li>
<li>Click <code>OK</code>.</li>
</ol>
</li>
</ol>
</li>
<li>
<p>Start the Gateway application pool:</p>
<ol>
<li>Open Internet Information Service (IIS) Manager.</li>
<li>In the left pane, expand the server node.</li>
<li>Click <code>Application Pools</code> to display a list of the Application Pools.</li>
<li>Right-click the <code>Cortex Gateway</code> application pool and select <code>Start</code>.</li>
</ol>
</li>
<li>
<p>Once the application pool has been started, the site will be available on <code>&lt;protocol&gt;://&lt;host&gt;:&lt;port&gt;/&lt;webapplicationname&gt;</code>, e.g. <code>https://localhost/gateway</code>.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    If the application pool does not stay started, ensure that the user it runs as has <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions or belongs to a group that has those permissions.

</div>
</p>
</li>
</ol>
<h2 id="preserve-installation-files">Preserve installation files</h2>
<p>Ensure that the installation files are backed up or kept on the server, especially the scripts and config files that have been modified. This will make it easier to perform further actions in future, such as troubleshooting, certificate rollover, uninstallation, reinstallation and updates.</p>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/setup-gateway">Setup Gateway</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-49567754edf61ac1ca933952f7e27f5d">1.5 - Setup Gateway</h1>
    <div class="lead">Information about setting up Cortex Gateway for first-time use.</div>
	<h1 id="setup-gateway">Setup Gateway</h1>
<p>This guide describes how to setup Gateway. Please ensure that <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/install-web-application-server">Install Web Application Server</a> has been completed before taking these steps.</p>
<h2 id="gateway-initial-setup">Gateway Initial Setup</h2>
<p>Log on to Gateway and run through the setup wizard:</p>
<ol>
<li>
<p>Open a <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/prerequisites#web-browser-requirements">supported web browser</a> and navigate to <code>&lt;protocol&gt;://&lt;host&gt;:&lt;port&gt;/&lt;webapplicationname&gt;</code>, e.g. <code>https://localhost/gateway</code>.</p>
<p>If an error message is displayed in the browser, wait a few minutes and refresh the page as it is possible that the website was still starting.</p>
</li>
<li>
<p>Log on using the default credentials that Gateway deploys with:</p>
<p>Username: <code>administrator</code></p>
<p>Password: <code>Adm1n1strat0r</code></p>
</li>
<li>
<p>On a newly installed system, you will be presented with a Setup Wizard at this point, which will guide you through some basic configuration steps:</p>
<ul>
<li><a href="#account-details">Account Details</a></li>
<li><a href="#ldap-connection">LDAP Connection</a></li>
<li><a href="#ldap-authorisation">LDAP Authorisation</a></li>
</ul>
</li>
<li>
<p>Follow the steps in the setup wizard to configure the relevant areas:</p>
<h3 id="account-details">Account Details</h3>
<ol>
<li>Click <code>Next Step</code>:

    <figure class="centre">
        <img src=" /images/Gateway%20Setup1.png "/> <figcaption>
                <h4>Initial Setup Screen</h4>
            </figcaption>
    </figure>
</li>
<li>Enter an email address for the Administrator and click <code>Next Step</code>:

    <figure class="centre">
        <img src=" /images/Gateway%20Setup2.png "/> <figcaption>
                <h4>Administrator Details Screen</h4>
            </figcaption>
    </figure>
</li>
<li>Change the Administrator password to a unique, secret password and click <code>Next Step</code>:

    <figure class="centre">
        <img src=" /images/Gateway%20Setup3.png "/> <figcaption>
                <h4>Change Password Screen</h4>
            </figcaption>
    </figure>
</li>
</ol>
<h3 id="ldap-connection">LDAP Connection</h3>
<ol>
<li>
<p>Enter the details of your Active Directory server and provide a Username and Password for a user with read access to it:</p>
<p>A connection to an Active Directory server must be established in order to assign authorisation rights to users.</p>
<ol>
<li>In the <code>Server</code> field, enter the Hostname, FQDN or IP Address of the Active Directory server that Gateway should use to authenticate and authorise users.</li>
<li>In the <code>Port</code> field, enter the port number of the Active Directory server. The well-known port for LDAP traffic is <code>389</code>; if SSL encryption is used, the well-known port is <code>636</code>.</li>
<li>If an SSL connection is to be used, tick the box <code>Use SSL</code>.</li>
<li>In the <code>Username</code> field, enter a valid username of a user that has read permissions for the Active Directory server.</li>
<li>In the <code>Password</code> field, enter the password of the user entered in the previous step.</li>
<li>To reduce the scope of any Active Directory searches, add one or more base DNs (Distinguished Names). For each base DN click <code>Add</code> and enter the full LDAP path e.g <code>CN=group, OU=organisational unit, DC=domain, DC=com</code>. These will be used as the roots of any Active Directory searches performed. For more information about distinguished names see <a href="https://msdn.microsoft.com/en-us/library/aa366101(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/aa366101(v=vs.85).aspx</a>.</li>
</ol>
</li>
<li>
<p>Click <code>Test Connection</code> to validate the connection and the user credentials entered and click <code>Next Step</code>.</p>
</li>
</ol>

    <figure class="centre">
        <img src=" /images/Gateway%20Setup4.png "/> <figcaption>
                <h4>LDAP Connection Screen</h4>
            </figcaption>
    </figure>

<h3 id="ldap-authorisation">LDAP Authorisation</h3>
<ol>
<li>
<p>If the authorisation grid fails to load first time round, click <code>Retry</code>.</p>
</li>
<li>
<p>Assign access permissions to Active Directory groups:</p>
<p>To allow users to access the various roles within Gateway, it is first necessary to assign them the appropriate access rights.
Gateway currently supports four roles, but only two are relevant for Cortex Innovation:</p>
<ul>
<li>Admin</li>
<li>Studio</li>
</ul>
<p>To give a user access to a role, set access for a group or Organisational Unit (OU) that the user is a member of:</p>
<ol>
<li>Expand the groups or OUs, or search for the group or OU, to be assigned one or more roles.</li>
<li>Check the relevant roles for each group. Checking a parent group will cascade the setting to all child groups.</li>
</ol>

        <figure class="centre">
            <img src=" /images/Gateway%20Setup5.png "/> <figcaption>
                    <h4>LDAP Authorisation Screen</h4>
                </figcaption>
        </figure>

</li>
<li>
<p>Click <code>Complete Setup</code> to commit the changes.</p>
</li>
<li>
<p>To test the permissions, log out as Administrator and then log in as a user with <code>Studio</code> permissions.</p>
</li>
</ol>
</li>
</ol>
<h2 id="configure-the-gateway-databases-to-use-transparent-data-encryption">Configure the Gateway Databases to use Transparent Data Encryption</h2>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Transparent Data Encryption cannot be applied to SQL Server Express, only full SQL Server instances.

</div>

<p>Once Gateway has been configured, if you wish to encrypt the databases using <a href="https://learn.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption?view=sql-server-ver15">Transparent Data Encryption</a> for improved security, this should now be performed by following the steps in <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/tde">Configuring TDE</a>.</p>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/try-it-out">Try it out</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9911e8a984fd3e62ca0fd20a451eda08">1.6 - Try it out</h1>
    <div class="lead">Information about trying out Cortex Innovation for the first time.</div>
	<h1 id="try-it-out">Try it out</h1>
<p>This guide describes how to try out a new Innovation installation to make sure it is working. Please ensure that <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/setup-gateway">Setup Gateway</a> has been completed before taking these steps.</p>
<h2 id="test-debugging-flows">Test Debugging Flows</h2>
<p>Test the platform by creating a new flow and executing it using the following steps:</p>
<ol>
<li>Click on the <code>Flows</code> charm, then the <code>+</code> button and click <code>Group</code> to open a dialog.</li>
<li>Enter a name for the group, configure the <code>Permission Groups</code> and click <code>OK</code> to create the group.</li>
<li>Click on the group to open it (refresh the page if it does not appear).</li>
<li>Inside the group, click the <code>+</code> button again and click on <code>Flow</code> to open a dialog. If the menu item is not present, it means that the <code>FeatureFlags</code> in the <code>CortexGateway.SetParameters.xml</code> file was not set properly when installing Gateway. See <a href="/docs/reference/troubleshooting/installation#ts-no-innovation">Troubleshooting</a> for more information.</li>
<li>Enter a name for the flow, configure the <code>Permission Groups</code> and click <code>OK</code> to create the flow.</li>
<li>The flow should be displayed with a start flow block and end flow block. A list of block palettes should be displayed down the left hand side:

    <figure>
        <img src=" /images/New%20Innovation%20Flow%20View.PNG "/> <figcaption>
                <h4>New Flow - Number of palettes may differ</h4>
            </figcaption>
    </figure>

If the blocks in the flow do not display or the palettes are not visible, see <a href="/docs/reference/troubleshooting/installation#ts-no-blocks">Troubleshooting</a> for more information.</li>
<li>Add a <code>Set Variable</code> block and connect it between the start and end blocks.</li>
<li>Click the <code>Set Variable</code> block to open the Property Editor.</li>
<li>Set the <code>Value</code> property to the expression <code>DateTimeOffset.Now</code>.</li>
<li>Type <code>Result</code> into the <code>Variable</code> property and click <code>Create Result</code>.</li>
<li>In the Variable Editor, set <code>Is Output Variable?</code> to <code>true</code> for the new <code>Result</code> variable.</li>
<li>Set a breakpoint on the end block and start the flow. An execution token should appear, the <code>Result</code> variable should show the current time. If the token does not appear, try refreshing the page.</li>
<li>Continue or stop the execution.</li>
<li>Commit the flow.</li>
</ol>
<h2 id="test-publishing-production-flows">Test Publishing Production Flows</h2>
<ol>
<li>Log in to Gateway with a user that has the <code>Admin</code> role.</li>
<li>Click on the <code>Settings</code> charm, then <code>Packages</code>.</li>
<li>Click <code>Add Package Definition</code>. Enter a package name and select the new flow to add to the package. Click <code>Save</code> to save the new package.</li>
<li>Click <code>Publish</code>. A success message should appear. If it doesn&rsquo;t it means that either one or more of the parameters prefixed with <code>Service Fabric</code> in the <code>CortexGateway.SetParameters.xml</code> file was not set properly when installing Gateway, or the Application Services aren&rsquo;t healthy. See <a href="/docs/reference/troubleshooting/installation#ts-no-publish">Troubleshooting</a> for more information.</li>
</ol>
<h2 id="test-executing-production-flows">Test Executing Production Flows</h2>
<ol>
<li>
<p>Open an HTTP client, such as <a href="https://www.postman.com/downloads/">Postman</a>. Make a request with the following format:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Action</td>
<td>POST</td>
</tr>
<tr>
<td>URL</td>
<td>https://{FQDN of Load Balancer Server}/api/default/default/flows/{Flow Name}/executions?packageName={Package Name}<br />e.g. https://load-balancer.domain.com/api/default/default/flows/NewFlow/executions?packageName=NewPackage</td>
</tr>
<tr>
<td>Content Type</td>
<td>application/json</td>
</tr>
<tr>
<td>Body</td>
<td>{}</td>
</tr>
<tr>
<td>Authentication</td>
<td>Basic</td>
</tr>
<tr>
<td>Username</td>
<td>The value used for <code>ApiGatewayBasicAuthUserName</code> when installing Application Services</td>
</tr>
<tr>
<td>Password</td>
<td>The value used for <code>ApiGatewayBasicAuthPwd</code> when installing Application Services (Unencrypted)</td>
</tr>
</tbody>
</table>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    If you used self-signed certificates when installing the Application Servers you will need to disable SSL certificate validation in your HTTP client.

</div>

</li>
<li>
<p>The request should return a JSON object with the output variables of the flow e.g. <code>{ &quot;Output&quot;: &quot;2022-03-09T07:35:16+0000&quot; }</code>.</p>
</li>
<li>
<p>Cortex Innovation has now been verified and is ready to use.</p>
</li>
</ol>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-41ba09ba8ccf0a1e6d45db2d9c77a1d1">2 - Single Server - Without HA</h1>
    <div class="lead">Information about installing Cortex Innovation on a single on-premise server without high availability (HA), including: information about components, supported architectures, prerequisites and installation instructions.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Single server installations with HA are not recommended for the following scenarios:</p>
<ul>
<li>Production installations that are required to scale and support HA</li>
</ul>

</div>


</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-bd1afcf2ea99f980cb86cbca15f0073c">2.1 - Architecture</h1>
    <div class="lead">Information about the recommended Innovation platform architecture, including component descriptions.</div>
	<h1 id="architecture">Architecture</h1>
<h2 id="components">Components</h2>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
<th>Required/Optional</th>
<th>Server Role</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/docs/guides/cortex-gateway/">Cortex Gateway</a></td>
<td>Web portal that hosts applications for creating automation solutions and managing their full life-cycle, including design, development, testing, deployment, monitoring, maintenance and ultimately end-of-life.</td>
<td>Required</td>
<td>Web Application Server</td>
</tr>
<tr>
<td><a href="/docs/guides/cortex-studio/">Cortex Studio</a></td>
<td>Application hosted in Cortex Gateway that provides the graphical, low-code environment for developing, testing, versioning, publishing and managing the full life-cycle of automation solutions.</td>
<td>Required</td>
<td>Web Application Server</td>
</tr>
<tr>
<td>Cortex Flow Debugger Service</td>
<td>Web application that allows flows to be debugged and executed. Used by Cortex Studio to debug flows and provide block information.</td>
<td>Required</td>
<td>Web Application Server</td>
</tr>
<tr>
<td>Cortex API Gateway Service</td>
<td>Application Service that routes client requests to the correct Application Services.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td>Cortex Flow Execution Service</td>
<td>Application Service that executes automation flows.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td>Cortex Block Packages</td>
<td>A set of files which contain the blocks that users can use to build flows. Used by the Cortex Flow Debugger Service and the Cortex Flow Execution Service.</td>
<td>Required</td>
<td>Web Application Server, Application Server</td>
</tr>
<tr>
<td>Cortex Gateway Databases</td>
<td>A set of databases created automatically by Gateway which are used for storing data related to user roles, flows, etc. Hopefully, we can remove the need for Gateway Databases in the next release.</td>
<td>Required<br />(End of life)</td>
<td>Web Application Server</td>
</tr>
<tr>
<td><a href="https://www.microsoft.com/en-us/download/details.aspx?id=103447">SQL Server Express</a> or <a href="https://www.microsoft.com/en-us/evalcenter/evaluate-sql-server-2019?filetype=exe">SQL Server Standard</a></td>
<td>Required by Cortex Gateway for creating and storing the Gateway Databases. Hopefully, we can remove the need for SQL Server in the next release.</td>
<td>Required<br />(End of life)</td>
<td>Web Application Server</td>
</tr>
<tr>
<td><a href="https://azure.microsoft.com/en-us/services/service-fabric/">Microsoft Service Fabric</a></td>
<td>Distributed systems platform that hosts the Application Services where automation solutions are deployed to.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-visualizing-your-cluster">Microsoft Service Fabric Explorer</a></td>
<td>Web portal for monitoring and managing the Service Fabric instance that automation solutions are deployed to.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://particular.net/nservicebus">Particular NServiceBus</a></td>
<td>Messaging platform enabling scalable, reliable and flexible asynchronous messaging between Application Services.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://www.rabbitmq.com/">Pivotal RabbitMQ</a></td>
<td>Message broker used by the NServiceBus messaging platform to transport messages asynchronously between Application Services using publish/subscribe mechanism.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
<tr>
<td><a href="https://github.com/erlang/otp">Erlang OTP</a></td>
<td>Erlang run-time required by the RabbitMQ message broker.</td>
<td>Required</td>
<td>Application Server</td>
</tr>
</tbody>
</table>
<h2 id="single-server-architecture">Single Server Architecture</h2>
<p>The following architecture requires 1 server:</p>

<figure class="centre">
    <img src=" /images/editable/Cortex%20Innovation%20Overview-Single%20Server.png "/> <figcaption>
            <h4>1 Server Architecture Diagram</h4>
        </figcaption>
</figure>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    This architecture is not recommended for production platforms that are required to scale and support HA. Additionally, upgrades require application redeployment with downtime rather than using rolling upgrades.

</div>

<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites">Prerequisites</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a220cffc402902792d86025978223271">2.2 - Prerequisites</h1>
    <div class="lead">Information about the prerequisites required on each server type for installation.</div>
	<h1 id="prerequisites">Prerequisites</h1>
<p>The prerequisites required for a single server (as described in <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/architecture">Architecture</a>) are laid out in this guide. These must be considered before undertaking installation.</p>
<h2 id="hardware-requirements">Hardware Requirements</h2>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This configuration is not recommended for production servers that are required to scale and support HA.

</div>

<table>
<thead>
<tr>
<th>Server Role</th>
<th>Servers Required</th>
<th>CPU Cores (&gt; 2GHz)</th>
<th>RAM (GB)</th>
<th>Disk (GB)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Single Server<br><em>Application Server +<br>Web Application Server</em></td>
<td>1</td>
<td>4+ <em>Recommended</em><br>2 <em>Minimum</em></td>
<td>16+ <em>Recommended</em><br>12 <em>Minimum</em></td>
<td>150+ <em>Recommended</em><br>100 <em>Minimum</em><br>30+ free on installation drive<br>40+ free on %ProgramData% drive</td>
</tr>
</tbody>
</table>
<h2 id="software-requirements">Software Requirements</h2>
<table>
<thead>
<tr>
<th>Server Role</th>
<th>Windows Server<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></th>
<th>SQL Server<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></th>
<th>.Net</th>
<th>PowerShell<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup></th>
<th>IIS<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup></th>
<th>Other Software</th>
</tr>
</thead>
<tbody>
<tr>
<td>Single Server<br><em>Application Server +<br>Web Application Server</em></td>
<td><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2019?filetype=ISO">2019 (x64)</a> <em>Recommended</em><br><a href="https://www.microsoft.com/en-US/evalcenter/evaluate-windows-server-2016?filetype=ISO">2016 (x64)</a></td>
<td><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-sql-server-2019?filetype=exe">2019</a><br /><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-sql-server-2016?filetype=exe">2016</a><br /><a href="https://www.microsoft.com/en-us/download/details.aspx?id=103447">2016 Express</a></td>
<td><a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">Framework 4.7.1</a></td>
<td>5.1</td>
<td>10.0.17763<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup><br>10.0.14393<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup><br><a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite Module 2.1</a></td>
<td><a href="https://www.microsoft.com/en-gb/download/details.aspx?id=43717">Microsoft Web Deploy 3.0 or later</a><br><a href="http://www.microsoft.com/en-us/download/details.aspx?id=40784">Visual C++ Redistributable 2013 (x64)</a></td>
</tr>
</tbody>
</table>
<h2 id="domain-requirements">Domain Requirements</h2>
<p>The server must be on a domain and cannot be a domain controller.</p>
<h2 id="dns-requirements">DNS Requirements</h2>
<p>The installation requires IP to hostname resolution to be available. Please ensure that you have the appropriate pointer (PTR) records configured  on the DNS server for the server.</p>
<h2 id="licensing-requirements">Licensing Requirements</h2>
<p>A valid Cortex licence file and Cortex Innovation feature identifier must be procured from Cortex. The feature identifier is a GUID which will be used when configuring the Gateway installation. The licence file is needed when installing the server and it should contain that server&rsquo;s fingerprint.</p>
<p>To get a licence file and feature identifier take the following steps:</p>
<ol>
<li>
<p>Copy the following template to a text file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Web Application/Application Server
</span></span><span style="display:flex;"><span>MachineID: 
</span></span><span style="display:flex;"><span>Fingerprint: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Please also include a suitable Cortex Innovation feature identifier.
</span></span></code></pre></div></li>
<li>
<p>Extract <code>Cortex Innovation 2022.9 - Licence Fingerprint Generator.zip</code>.</p>
</li>
<li>
<p>From that folder, copy <code>Cortex.Licensing.FingerprintGeneration.exe</code> to the server.</p>
</li>
<li>
<p>Double-click <code>Cortex.Licensing.FingerprintGeneration.exe</code> to run it. A command line window will appear, containing a machine identifier and fingerprint, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>MachineID: SERVER
</span></span><span style="display:flex;"><span>Fingerprint: 111118BA104C928319E0CBAE30844CF8B7FD8BC414D1567844D1D0830089F1C9BF5C6
</span></span></code></pre></div></li>
<li>
<p>Copy the output (machine identifier and fingerprint) to the <code>Web Application/Application Server</code> section of the text file created in the initial step. Note that the machine identifier can be changed to any string.</p>
</li>
<li>
<p>Request a licence and feature identifier by raising a case in the <a href="https://support.cortex.co.uk/">Cortex Service Portal</a>, including the contents of the text file containing all of the fingerprint and machine information in the body of the case.</p>
</li>
<li>
<p>When the licence and feature identifier have arrived, copy the file <code>Cortex.lic</code> to <code>%ProgramData%\Cortex\Licences</code> on the Web Application Server, creating the <code>Cortex</code> and <code>Licences</code> folders if they don&rsquo;t exist. Save the feature identifier for use when <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server#install-gateway">Installing Gateway</a>.</p>
</li>
</ol>
<h2 id="web-browser-requirements">Web Browser Requirements</h2>
<p>Gateway supports the latest versions of the following browsers:</p>
<ul>
<li>Chrome</li>
<li>Edge</li>
<li>Firefox</li>
</ul>
<h2 id="certificate-requirements">Certificate Requirements</h2>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    For production systems it is recommended that an X.509 SSL certificate is obtained from a Certificate Authority and used for installation. For non-production systems, certificates can be omitted from installation and it will create and use self-signed certificates. This may prevent 3rd parties that require valid certificate verification to access the API Gateway Service.

</div>

<p>An X.509 SSL certificate (standard or wildcard) should be used to:</p>
<ul>
<li>Allow Application Services to identify themselves to clients such as Gateway.</li>
<li>Prevent unauthorised nodes from joining the single node cluster.</li>
<li>Connect to Service Fabric Explorer from the Application Server.</li>
<li>Connect to Gateway.</li>
<li>Allow Gateway to connect to the Flow Debugger Service.</li>
</ul>
<p>The certificate can be obtained from a Certificate Authority, such as <a href="https://letsencrypt.org/">Let’s Encrypt</a>, and must meet the following requirements:</p>
<ul>
<li>Subject field must be in one of the following formats, depending on the certificate type:
<ul>
<li>Standard certificates must use the standard format (e.g. <code>CN=host.domain.com</code>).</li>
<li>Wildcard certificates must use the wildcard format, pertaining to the domain of the server (e.g. <code>CN=*.domain.com</code>).</li>
</ul>
</li>
<li>Subject alternative names must include any additional host names that should be able to be used to access the API Gateway Service.</li>
<li>Subject Alternative Names (SAN): At minimum the FQDN of the server. It can also include NetBIOS Name, IP address, localhost, 127.0.0.1. It must include any additional host names that should be able to be used to access the API Gateway Service.</li>
<li>Certificate file must be in a .PFX file format, with a known password.</li>
<li>Certificate file must contain the full chain of certificates.</li>
<li>Certificate file must include the private key.</li>
<li>Key Usage extension must have a value of <code>Digital Signature, Key Encipherment (a0)</code>.</li>
<li>Enhanced Key Usage must include <code>Server Authentication</code> and <code>Client Authentication</code>.</li>
</ul>
<p>This file should be placed in a known location on the server. This location will be required when running the Application Server installation script.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    It is critical to set a reminder to <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/rollover-certificates">update certificates</a> in good time before they expire. If they expire then the platform will cease to function and <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> must be contacted for support.

</div>

<h2 id="tls-requirements">TLS Requirements</h2>
<p>There is a set of non-compulsory security measures, recommended to be applied to the server, in order to prevent potential attacks that exploit known industry security vulnerabilities. This includes disabling all versions of SSL and TLS apart from TLS 1.2, and disabling all cipher suites apart from the following:</p>
<ul>
<li>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</li>
<li>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</li>
</ul>
<p>See <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/ssl-best-practices">SSL Best Practices</a> for a full list of the security changes which will be applied. The <code>Cortex.Innovation.Install.SSLBestPractices.ps1</code> script is provided during installation to apply these security changes to the server.</p>
<h2 id="additional-application-server-requirements">Additional Application Server Requirements</h2>
<h3 id="filesystem-requirements">Filesystem Requirements</h3>
<p>The server must use an NTFS filesystem.</p>
<h3 id="service-requirements">Service Requirements</h3>
<p>The following Windows Services must be running on the server:</p>
<ul>
<li>Remote Registry</li>
<li>Windows Event Log</li>
<li>Performance Logs &amp; Alerts</li>
</ul>
<h3 id="security-requirements">Security Requirements</h3>
<h4 id="installation-user">Installation User</h4>
<p>A domain user which is a member of the Local Administrators group on the server must be available to run the installation scripts. This is a prerequisite of Microsoft Service Fabric, which is the platform that Cortex Innovation is built upon.</p>
<h4 id="antivirus-exclusions">Antivirus Exclusions</h4>
<p>It is advised (by Microsoft Service Fabric) that the following antivirus exclusions are created on the server to reduce antivirus processing on Service Fabric artefacts:</p>
<p>Folder Exclusions:</p>
<ul>
<li>%ProgramFiles%\Microsoft Service Fabric</li>
<li>%ProgramData%\SF</li>
<li>%ProgramData%\SF\Logs</li>
</ul>
<p>Process Exclusions:</p>
<ul>
<li>Fabric.exe</li>
<li>FabricHost.exe</li>
<li>FabricInstallerService.exe</li>
<li>FabricSetup.exe</li>
<li>FabricDeployer.exe</li>
<li>ImageBuilder.exe</li>
<li>FabricGateway.exe</li>
<li>FabricDCA.exe</li>
<li>FabricFAS.exe</li>
<li>FabricUOS.exe</li>
<li>FabricRM.exe</li>
<li>FileStoreService.exe</li>
</ul>
<p>A script is provided during installation to add these exclusions for Windows Defender. If any other antivirus software is running, these will need to be added manually.</p>
<p>If adding the exclusions manually, the Process Exclusions should be done before installation occurs, as the processes will be used during installation of the application and antivirus software can cause the installation to fail or timeout. Folder Exclusions may need to be added after installation has occurred as some antivirus software needs the folders to exist.</p>
<h4 id="port-requirements">Port Requirements</h4>
<p>Cortex Innovation and Microsoft Service Fabric require a range of <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/port-requirements">firewall ports to be opened</a> between the server and specific services.</p>
<p>If you are using Windows Firewall, some ports are opened during installation and others are opened dynamically as needed. If any other firewall is used, it will be necessary to add the rules described in <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/port-requirements">Port Requirements</a> to open the correct ports.</p>
<p>The <code>Cortex.Innovation.Test.PortUsage.ps1</code> script is provided during installation to test the ports on the server and make sure they do not overlap with any other programs; most ports may be altered if this is the case, the description will say if this is not possible.</p>
<h2 id="additional-web-application-server-requirements">Additional Web Application Server Requirements</h2>
<h3 id="security-requirements-1">Security Requirements</h3>
<h4 id="installation-user-1">Installation User</h4>
<p>Domain users must be available to run the Application Pools for Gateway and Flow Debugger Service. These users must be given <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions otherwise the Application Pools will not be able to run. Information about how to do this will be given during installation.</p>
<p>For Flow Debugger Service, the <code>NETWORK SERVICE</code> user can also be used.</p>
<h4 id="domain-requirements-1">Domain Requirements</h4>
<p>For Gateway, only Windows domains with an Active Directory domain controller running Active Directory Domain Services are supported.</p>
<p>Supported versions of Active Directory are listed below:</p>
<table>
<thead>
<tr>
<th>Version</th>
<th>Verified?</th>
<th>Supported From</th>
<th>Supported Until</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2003</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2003 R2</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2008</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2008 R2</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2012</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2012 R2</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2016</td>
<td>✓</td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2019</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
<tr>
<td>Windows Server 2022</td>
<td></td>
<td>Cortex v2022.9</td>
<td>To be evaluated</td>
</tr>
</tbody>
</table>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-application-server">Install Application Server</a></li>
</ol>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Windows Server Standard and Datacenter editions are supported. Filesystem <strong>must be NTFS</strong> and networking <strong>must use IPv4</strong>. Linux is not supported, but may be in the future.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>SQL Server Express, Standard and Enterprise are supported. Other databases are not supported. Note that <a href="https://learn.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption?view=sql-server-ver15">Transparent Data Encryption</a> is not supported on SQL Server Express.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>PowerShell 5.1 ships with Windows Server 2016 and 2019.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>IIS is supported; other web servers, including IIS Express are not supported.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>Ships as a windows role within Windows Server 2019.&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p>Ships as a windows role within Windows Server 2016.&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fe52b3f1214f7ec1fdfdbcc8afa49c34">2.3 - Install Application Server</h1>
    <div class="lead">Information about installing the Application Server.</div>
	<h1 id="install-application-server">Install Application Server</h1>
<p>This guide describes how to install the Application Server components on the server. Please ensure that the <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites">Prerequisites</a> have been read before starting this installation.</p>
<h2 id="make-installation-artefacts-available">Make Installation Artefacts Available</h2>
<ol>
<li>
<p>Copy the following artefacts to a folder on the server (the version numbers may differ):</p>
<ul>
<li>Cortex Innovation 2022.9 - Block Packages.zip</li>
<li>Cortex Innovation 2022.9 - App Services.zip</li>
<li>Cortex Innovation 2022.9 - App Server Install Scripts.zip</li>
</ul>
</li>
<li>
<p>Extract the <code>Cortex Innovation 2022.9 - App Server Install Scripts.zip</code> file to a folder with the same name.</p>
</li>
</ol>
<h2 id="install-microsoft-net-framework-471">Install Microsoft .NET Framework 4.7.1</h2>
<p>Microsoft Service Fabric requires a minimum of Microsoft .NET Framework 4.7.1 to be installed on the server.</p>
<p>To find the version of the framework that is installed:</p>
<ol>
<li>On the Start menu, choose <code>Run</code>.</li>
<li>In the open box, enter <code>regedit.exe</code>. You must have administrative credentials to run regedit.exe.</li>
<li>In the Registry Editor, open the subkey <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full</code>.</li>
<li>If the <code>Full</code> subkey is not present, then you do not have the .NET Framework 4.5 or later installed.</li>
<li>Check for a <code>DWORD</code> value named <code>Release</code>. The existence of the Release DWORD indicates the .NET Framework 4.5 or newer has been installed on that computer. If the value is <code>461308</code> or over then at least .NET Framework 4.7.1 is installed and no further steps need to be taken. If it is not installed, continue with the following steps to install it.</li>
</ol>
<p>To install .NET Framework 4.7.1:</p>
<ol>
<li>Download the <a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">.NET Framework 4.7.1</a> installer.</li>
<li>Double-click on the installer file to run it.</li>
<li>Follow the wizard to complete the installation.</li>
</ol>
<h2 id="apply-recommended-security-measures">Apply Recommended Security Measures</h2>
<p>These are non-compulsory security measures, recommended to be applied to the server, in order to prevent potential attacks that exploit known industry security vulnerabilities.</p>
<p>Applying these measures may impact other applications running on your server. Therefore, it is your responsibility to ensure that other applications and their clients will not be affected by the changes.</p>
<h3 id="only-use-recommended-encryption-algorithms-and-tls-protocols">Only Use Recommended Encryption Algorithms and TLS Protocols</h3>
<p>A collection of registry settings need to be applied to guarantee your server is only using the recommended encryption algorithms and TLS protocols. Information about these settings can be found at <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/ssl-best-practices">SSL Best Practices</a>.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    Disabling specific TLS versions or specific Cipher Suites can have impact on Cortex components themselves as well as their communication capabilities with third party systems and services, e.g. Flow Debugger Service executing flows with blocks which communicate with 3rd parties via PowerShell or REST. All parties communicating together must support a shared protocol version and cipher suite, otherwise they will not be able to establish a secure communication link between each other.

</div>

<p>The settings can be applied by running a script. Be aware that the server will be restarted when the script is run. Apply the settings by following these instructions:</p>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Install.SSLBestPractices.ps1</code> script using the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SSLBestPractices</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    To avoid answering all of the prompts <code>-Override 0</code> can be added to the end of the script. This will automatically apply all settings and forcibly restart the server.

</div>

<p>If <code>-Override 0</code> has been specified no further steps need to be taken and you can move on to the next section when the server has restarted.</p>
</li>
<li>
<p>To use all the recommended settings click <code>Apply all</code> to the first prompt.</p>
<p>To selectively apply each setting select <code>Choose which to apply</code>. Each change will then be prompted with a Yes/No confirmation before applying.</p>
</li>
<li>
<p>Restart the machine when the script asks.</p>
</li>
</ol>
<h2 id="add-antivirus-exclusions">Add Antivirus Exclusions</h2>
<ol>
<li>If Windows Defender is not running on the server, ensure that the <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites#antivirus-exclusions">Antivirus Exclusions</a> have been added to the running antivirus software on the server and continue to the next section, otherwise follow these steps:
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Add.WindowsDefenderExclusions.ps1</code> script using the following command, modifying the <code>ApplicationServers</code> value to contain the NETBIOS name or fully qualified domain name of the server:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WindowsDefenderExclusions</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ApplicationServers</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div></li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on the server and press OK.</p>
</li>
<li>
<p>A message will indicate that the script has completed successfully.</p>
</li>
</ol>
</li>
</ol>
<h2 id="check-port-usage">Check Port Usage</h2>
<ol>
<li>To check all necessary ports are free, follow these steps.
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Test.PortUsage.ps1</code> script using the following command, modifying the <code>ApplicationServers</code> value to contain the NETBIOS name or fully qualified domain name of the server:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Test</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">PortUsage</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ApplicationServers</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div></li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on the server and press OK.</p>
</li>
<li>
<p>If all ports are free, the script will report the following:</p>
<p><code>All ports required by Cortex Innovation are free</code></p>
<p>If this is the case, continue to the next section. Otherwise, consult the messages returned by the script, which will give details about how to modify the <code>Cortex.Innovation.Install.Config.json</code> configuration file, in the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder, to use different ports. This will be used later during installation.</p>
<p>The <code>Cortex.Innovation.Test.PortUsage.ps1</code> script cannot currently re-check modified ports in the configuration file so these need to be manually checked to see that they are free.</p>
</li>
</ol>
</li>
</ol>
<h2 id="configure-installation-script">Configure Installation Script</h2>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder, locate the <code>Cortex.Innovation.Install.ps1</code> script and open it with a text editor.</p>
</li>
<li>
<p>Choose the tab below that matches the configuration for this installation, then update the script to match, changing the parameters according to the details given below:</p>

        














        














    <ul class="nav nav-tabs" id="tabs-3" role="tablist"><li class="nav-item">
      <a class="nav-link active"
        id="tabs-3-0-tab" data-toggle="tab" href="#tabs-3-0" role="tab"
        aria-controls="tabs-3-0" aria-selected="true">
        CA Certs
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-3-1-tab" data-toggle="tab" href="#tabs-3-1" role="tab"
        aria-controls="tabs-3-1" aria-selected="false">
        Self-Signed Certs
      </a>
    </li></ul>


<div class="tab-content" id="tabs-3-content"><div class="tab-pane fade show active"
        id="tabs-3-0" role="tabpanel" aria-labelled-by="tabs-3-0-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AppServicesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Services.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-CustomerName</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApplicationServerIPv4Addresses</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;192.168.1.1&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-SkipLoadBalancer</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-app-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  <div class="tab-pane fade"
        id="tabs-3-1" role="tabpanel" aria-labelled-by="tabs-3-1-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AppServicesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Services.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApiGatewayBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-CustomerName</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ApplicationServerIPv4Addresses</span> <span style="color:#000">@</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;192.168.1.1&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-UseSelfSignedCertificates</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-SkipLoadBalancer</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-app-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  
</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AppServicesPath</code></td>
<td>Configure this value with the location of the App Services zip file on the server.</td>
</tr>
<tr>
<td><code>BlockPackagesPath</code></td>
<td>Configure this value with the location of the Block Packages zip file on the server.</td>
</tr>
<tr>
<td><code>ApiGatewayBasicAuthUserName</code></td>
<td>Configure this value with the username that will be used for Basic Authentication when making HTTPS requests to the API Gateway Service (e.g. starting production flows). <br /><br />Currently only Basic Authentication using a single user is supported, OAuth2 will be supported in a future release.<br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>ApiGatewayBasicAuthPwd</code></td>
<td>Configure this value with the password that will be used for Basic Authentication when making HTTPS requests to the API Gateway Service (e.g. starting production flows). This should be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>. <br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>CustomerName</code></td>
<td>A name identifying the platform being installed. This must have no spaces or symbols. It will be appended to the node names that are displayed in Service Fabric Explorer.</td>
</tr>
<tr>
<td><code>ApplicationServerIPv4Addresses</code></td>
<td>The IPv4 address of the server.</td>
</tr>
<tr>
<td><code>ServerCertificatePath</code></td>
<td>The local path of a .PFX certificate file on the server. Environment variables cannot be used. <br /><br />This is only needed if installing with CA Certificates (Recommended). The certificate should meet the <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites#certificate-requirements">Certificate Requirements</a>. <br /><br />This certificate will be used for: <ul><li>Securing communication between the Application Services.</li><li>Allowing Application Services to identify themselves to clients such as Gateway.</li><li>Preventing unauthorised nodes from joining the single node cluster.</li><li>Connecting to Service Fabric Explorer from each of the Application Servers.</li></ul>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    It is critical to set a reminder to <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/rollover-certificates">update certificates</a> in good time before they expire. If they expire then the platform will cease to function and <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> must be contacted for support.

</div>
</td>
</tr>
<tr>
<td><code>ServerCertificatePwd</code></td>
<td>The password for the .PFX certificate file specified in <code>ServerCertificatePath</code>. <br /><br /> This is only needed if installing with CA Certificates (Recommended).</td>
</tr>
<tr>
<td><code>UseSelfSignedCertificates</code></td>
<td>Installs Application Services and required infrastructure using generated Self-Signed Certificates rather than CA Certificates.  <br /><br /> Not recommended for production use.</td>
</tr>
<tr>
<td><code>SkipLoadBalancer</code></td>
<td>Installs Application Services and required infrastructure without installing a load balancer.</td>
</tr>
<tr>
<td><code>Credential</code></td>
<td>The credentials of the user which will be used to perform remote operations on the server. It must be a domain user that is a member of the local Administrators group on the server. <br /><br /> This does not need to be changed, a prompt will appear to enter this information when the script is run.</td>
</tr>
<tr>
<td><code>AcceptEULA</code></td>
<td>This does not need to be changed, the EULA will be accepted at a later stage.</td>
</tr>
<tr>
<td><code>FilePath</code></td>
<td>The filename that installation logs are written to.  If this should be written to a different location than where the installation files are then a full path should be specified.</td>
</tr>
</tbody>
</table>
<p>The <code>ApiGatewayBasicAuthUserName</code> and <code>ApiGatewayBasicAuthPwd</code> will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    More advanced configuration (such as changing ports) can be undertaken by modifying the <code>Cortex.Innovation.Install.Config.json</code> file but this shouldn&rsquo;t be required for most installations. More information about this can be found at <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/advanced-config-changes#single-server-without-ha">Advanced Application Server and Load Balancer Configuration Changes</a>.

</div>

</li>
<li>
<p>Save and close <code>Cortex.Innovation.Install.ps1</code>.</p>
</li>
</ol>
<h2 id="test-installation-script">Test Installation Script</h2>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-WhatIf</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-WhatIf</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to test the installation script.</p>
</li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on the server and press OK.</p>
</li>
<li>
<p>A password prompt will appear. Enter a password which will be used to create a user in RabbitMQ.</p>
</li>
<li>
<p>Wait for the command to finish. It will display the output of the installation command without making any changes to the system.</p>
</li>
<li>
<p>Check that there have been no errors in the script; these would appear in red in the console.</p>
<p>If there are no errors, continue to the next section; otherwise, check if the errors have any instructions for rectifying the issue and follow them.</p>
<p>If there are no useful instructions, check that all previous steps have been followed correctly and, if not, rectify it and run the command again. <br /><br />If this does not work, please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for further assistance. The <code>WhatIf</code> script will have created a temporary version of the config file in the script location, showing what changes would be made to it when the script runs. The name is appended with <code>-WhatIf</code> (e.g. <code>Cortex.Innovation.Install.Config-WhatIf.json</code>). This file can be provided when obtaining support.</p>
</li>
</ol>
<h2 id="run-installation-script">Run Installation Script</h2>
<ol>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to install HA Services and the required infrastructure.</p>
</li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on the server and press OK.</p>
</li>
<li>
<p>A password prompt will appear. Enter a password which will be used to create a user in RabbitMQ. This should be entered carefully and recorded as it may be needed if seeking support from <a href="https://support.cortex.co.uk/">Cortex Service Portal</a>. Press OK.</p>
</li>
<li>
<p>Wait for the script to finish running. This should take approximately 10 minutes.</p>
</li>
<li>
<p>Check that there have been no errors in the script; these would appear in red in the console.</p>
<p>If there are any errors, then please follow any instructions given within them to rectify the situation, check your configuration files, and retry the installation.</p>
<p>In some circumstances, retrying may error due to components being installed already. In this case please run the following command, followed by the original installation command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Uninstall</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-SkipLoadBalancer</span>
</span></span></code></pre></div><p>If the errors do not give any instructions on how to rectify, see <a href="/docs/reference/troubleshooting/installation#ts-during-installation">Troubleshooting During Installation</a> for further information; if this does not help then please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for assistance.</p>
</li>
</ol>
<h2 id="check-application-services">Check Application Services</h2>
<ol>
<li>
<p>Log on to the server.</p>
</li>
<li>
<p>Import the certificate, used in the <code>ServerCertificatePath</code> parameter of the <a href="#configure-installation-script">Configure Installation Script</a> section, to your <code>Current User</code> certificate store. This can be achieved by double clicking on the certificate .PFX file and following the wizard.</p>
<p>If using self-signed certificates, the certificate can be retrieved by using the <code>Manage Computer Certificates</code> tool in Windows to export the <code>CortexServerCertificate</code> from the <code>Personal</code> store and then importing it to the <code>Current User</code> store by double-clicking on it and following the wizard.</p>
</li>
<li>
<p>Open a web browser.</p>
</li>
<li>
<p>Navigate to <code>https://server.domain.com:9080/Explorer</code>, where <code>server.domain.com</code> is the fully qualified domain name of the server. Replace <code>9080</code> with new <code>httpGatewayEndpointPort</code> value if it was changed during configuration.</p>
<p>The screen should resemble that in the following figure:

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Single.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Cluster</h4>
            </figcaption>
    </figure>
</p>
<p>The status circles should be entirely green - this indicates that the node and all services and instances are healthy. Other status pages can be accessed by expanding items in the leftmost pane. Issues can be tracked down to the failing component by expanding items with warning triangles or error icons on. The next few diagrams show the status pages for a healthy system.</p>
<p>After expanding the application, clicking on any of the services should display a green circle and <code>Status = Active</code>:</p>

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Service%20-%20Single.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Service</h4>
            </figcaption>
    </figure>

<p>After expanding either of the services, clicking on any of the instances/partitions should display a green circle and <code>Status = Ready</code>:</p>

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Instance%20-%20Single.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Instance</h4>
            </figcaption>
    </figure>

<p>Clicking on any of the nodes at the bottom of the leftmost pane should display a green circle and <code>Status = Up</code>:</p>

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Node%20-%20Single.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Node</h4>
            </figcaption>
    </figure>

<p>If any warning triangles appear, wait for 5 minutes or so as the cluster may still be starting up. If the cluster looks OK, go to the next section.</p>
<p>If the warnings persist or anything on the screen goes red, expand the items to find the individual services and instances which have errors or warnings. Warnings should not be ignored as they can indicate that the service can’t start but is still in the retry phase. Error and warning messages should be displayed on the status screens and should indicate what is wrong.</p>
<p>If no useful message can be seen here, the service log files may contain more information. These can be found on the server at:</p>
<ul>
<li>%ProgramData%/Cortex/Cortex API Gateway Service</li>
<li>%ProgramData%/Cortex/Cortex Flow Execution Service</li>
</ul>
<p>If no solution can be found, please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for further assistance.</p>
</li>
</ol>
<h2 id="preserve-installation-files">Preserve installation files</h2>
<p>Ensure that the installation files are backed up or kept on the server, especially the scripts and config files that have been modified. This will make it easier to perform further actions in future, such as troubleshooting, certificate rollover, uninstallation, reinstallation and updates.</p>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server">Install Web Application Server</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cc1f5d1c0bcd59056e5d3f3ea7fe1e58">2.4 - Install the Web Application Server</h1>
    <div class="lead">Information about installing the Web Application Server.</div>
	<h1 id="install-the-web-application-server">Install the Web Application Server</h1>
<p>This guide describes how to install the Web Application Server components on the server. Please ensure that <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-application-server">Install Application Server</a> has been completed before starting this installation.</p>
<h2 id="make-installation-artefacts-available">Make Installation Artefacts Available</h2>
<ol>
<li>
<p>Copy the following artefacts to a folder on the server (the version numbers may differ):</p>
<ul>
<li>Cortex Innovation 2022.9 - Block Packages.zip</li>
<li>Cortex Innovation 2022.9 - Gateway.zip</li>
<li>Cortex Innovation 2022.9 - Flow Debugger Service.zip</li>
<li>Cortex Innovation 2022.9 - Web App Server Install Scripts.zip</li>
</ul>
</li>
<li>
<p>Extract the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts.zip</code> zip file to a folder with the same name.</p>
</li>
</ol>
<h2 id="install-prerequisites">Install Prerequisites</h2>
<h3 id="licensing">Licensing</h3>
<p>Ensure that a valid Cortex licence file named <code>Cortex.lic</code> exists on the server, in the location <code>%ProgramData%\Cortex\Licences</code>. If it does not, follow the instructions located at <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites#licensing-requirements">Licensing Requirements</a>.</p>
<h3 id="install-sql-server-or-sql-express">Install SQL Server or SQL Express</h3>
<ol>
<li>Use one of the following installation guides to install SQL Server or SQL Server Express:
<ul>
<li><a href="/pdfs/Cortex Innovation - SQL Server 2019 Installation Guide.pdf">Cortex Innovation - SQL Server 2019 Installation Guide</a></li>
<li><a href="/pdfs/Cortex Innovation - SQL Server 2016 Installation Guide.pdf">Cortex Innovation - SQL Server 2016 Installation Guide</a></li>
<li><a href="/pdfs/Cortex Innovation - SQL Server 2016 Express Installation Guide.pdf">Cortex Innovation - SQL Server 2016 Express Installation Guide</a></li>
</ul>
</li>
</ol>
<h3 id="install-microsoft-net-framework-471">Install Microsoft .NET Framework 4.7.1</h3>
<p>Gateway requires a minimum of Microsoft .NET Framework 4.7.1.</p>
<p>To find the version of the framework that is installed:</p>
<ol>
<li>On the Start menu, choose <code>Run</code>.</li>
<li>In the open box, enter <code>regedit.exe</code>. You must have administrative credentials to run regedit.exe.</li>
<li>In the Registry Editor, open the subkey <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full</code>.</li>
<li>If the <code>Full</code> subkey is not present, then you do not have the .NET Framework 4.5 or later installed.</li>
<li>Check for a <code>DWORD</code> value named <code>Release</code>. The existence of the Release DWORD indicates the .NET Framework 4.5 or newer has been installed on that computer. If the value is <code>461308</code> or over then at least .NET Framework 4.7.1 is installed and no further steps need to be taken. If it is not installed, continue with the following steps to install it.</li>
</ol>
<p>To install .NET Framework 4.7.1:</p>
<ol>
<li>Download the <a href="https://dotnet.microsoft.com/en-us/download/dotnet-framework/net471">.NET Framework 4.7.1</a> installer.</li>
<li>Double-click on the installer file to run it.</li>
<li>Follow the wizard to complete the installation.</li>
</ol>
<h3 id="install-microsoft-web-deploy">Install Microsoft Web Deploy</h3>
<ol>
<li>Check if Web Deploy is already installed by going to <code>Control Panel</code> → <code>Programs</code> → <code>Programs and Features</code>; if Web Deploy is already installed, it will be listed as <code>Microsoft Web Deploy</code>.</li>
<li>If it is not installed, download <a href="https://www.microsoft.com/en-gb/download/details.aspx?id=43717">Microsoft Web Deploy</a> version 3.0 or later (WebDeploy_amd64_en-US.exe) to the server.</li>
<li>Double-click the downloaded file to start the installation.</li>
<li>Follow the installation wizard to install Web Deploy; on the <code>Choose Setup Type</code> page select <code>Typical</code>.</li>
</ol>
<h3 id="install-visual-c-redistributable">Install Visual C++ Redistributable</h3>
<ol>
<li>Check if Visual C++ 2013 Redistributable (x64) is already installed by going to <code>Control Panel</code> → <code>Programs</code> → <code>Programs and Features</code>; if Visual C++ Redistributable is already installed, it will be listed as <code>Microsoft Visual C++ 2013 Redistributable (x64)</code>.</li>
<li>If it is not installed, download <a href="http://www.microsoft.com/en-us/download/details.aspx?id=40784">Visual C++ Redistributable 2013 (x64)</a>.</li>
<li>Double-click the downloaded file to start the installation.</li>
<li>Follow the installation wizard to install the Visual C++ Redistributable.</li>
</ol>
<h3 id="iis-role-setup-and-configuration">IIS Role Setup and Configuration</h3>
<h4 id="install-internet-information-services-iis">Install Internet Information Services (IIS)</h4>
<p>Install the required features by following these instructions:</p>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Web App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Run the <code>Cortex.Innovation.Install.WindowsFeatures.ps1</code> script using the following command, this may take a few minutes:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WindowsFeatures</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Check the output is as follows:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Web-WebSockets is installed
</span></span><span style="display:flex;"><span>Web-Asp-Net45 is installed
</span></span><span style="display:flex;"><span>Web-Net-Ext45 is installed
</span></span><span style="display:flex;"><span>Web-ISAPI-Ext is installed
</span></span><span style="display:flex;"><span>Web-ISAPI-Filter is installed
</span></span><span style="display:flex;"><span>Net-Framework-45-Core is installed
</span></span><span style="display:flex;"><span>Net-Framework-45-ASPNET is installed
</span></span><span style="display:flex;"><span>Web-Default-Doc is installed
</span></span><span style="display:flex;"><span>Web-Dir-Browsing is installed
</span></span><span style="display:flex;"><span>Web-Http-Errors is installed
</span></span><span style="display:flex;"><span>Web-Static-Content is installed
</span></span><span style="display:flex;"><span>Web-Http-Logging is installed
</span></span><span style="display:flex;"><span>Web-Http-Redirect is installed
</span></span><span style="display:flex;"><span>Web-Request-Monitor is installed
</span></span><span style="display:flex;"><span>Web-Stat-Compression is installed
</span></span><span style="display:flex;"><span>Web-Dyn-Compression is installed
</span></span><span style="display:flex;"><span>Web-Filtering is installed
</span></span><span style="display:flex;"><span>Web-Windows-Auth is installed
</span></span><span style="display:flex;"><span>Web-Mgmt-Console is installed
</span></span><span style="display:flex;"><span>Web-Mgmt-Service is installed
</span></span></code></pre></div></li>
</ol>
<h4 id="register-and-allow-net-clr-v4030319-with-iis">Register and Allow .NET CLR v4.0.30319 with IIS</h4>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Unless .NET CLR v4.0.30319 is registered and allowed with IIS, Gateway and Flow Debugger Service will not work.

</div>

<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Run the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">Dism</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#000">online</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#204a87">enable-feature</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#000">featurename</span><span style="color:#a40000">:</span><span style="color:#204a87">IIS-ASPNET45</span> <span style="color:#000;font-weight:bold">/</span><span style="color:#000">all</span>
</span></span></code></pre></div></li>
<li>
<p>Once PowerShell confirms that it has finished installing .NET CLR v4.0.30319, close the PowerShell window.</p>
</li>
</ol>
<h3 id="install-url-rewrite-module">Install URL Rewrite Module</h3>
<p>The URL Rewrite IIS Manager module is required to enable web applications on your server to rewrite URLs. This is needed to allow HTTP URLs to redirect to the equivalent HTTPS ones.</p>
<p>To install the URL Rewrite module take the following steps:</p>
<ol>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, select the server node.</li>
<li>Ensure that there is an icon with the title <code>URL Rewrite</code> under the <code>IIS</code> feature section:

    <figure class="centre">
        <img src=" /images/Url%20Rewrite%20Icon.png "/> <figcaption>
                <h4>Url Rewrite Module Icon</h4>
            </figcaption>
    </figure>
</li>
<li>If there is an icon, <code>URL Rewrite</code> module is installed and no further steps are required.</li>
<li>If there is no icon, the module is not installed and the following steps must be taken:
<ol>
<li>Download the <a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite</a> module installer.</li>
<li>Double-click on the installer file to run it.</li>
<li>Follow the wizard to complete the installation.</li>
<li>After successfully installing, close and reopen <code>IIS Manager</code>. The <code>URL Rewrite</code> icon should now be visible.</li>
</ol>
</li>
</ol>
<h3 id="add-https-firewall-rule">Add HTTPS Firewall Rule</h3>
<p>If any firewall is running on the server, it must be configured to allow communication inbound via TCP on the port configured for HTTPS (usually 443). See <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/configure-firewalls">Configure Firewalls</a> for information about adding rules to Windows Firewall.</p>
<h2 id="create-web-site">Create Web Site</h2>
<p>Gateway and Flow Debugger Service can either be installed to an existing web site or a newly created web site. If you are installing into an existing web site skip to <a href="#configure-web-site">Configure Web Site</a>.</p>
<p>The steps to create a new web site are:</p>
<ol>
<li>In Windows File Explorer, navigate to the default IIS folder (usually <code>%SystemDrive%\inetpub\wwwroot</code>, e.g. <code>C:\inetpub\wwwroot</code>).</li>
<li>Ensure there is a folder called <code>Cortex</code>; if not create it.</li>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, expand the server node.</li>
<li>Right-click the <code>Sites</code> node under the server and select <code>Add Website…</code>.</li>
<li>Set the <code>Site name</code> to <code>Cortex</code>.</li>
<li>Set the <code>Physical path</code> to the folder created above (e.g. <code>C:\inetpub\wwwroot\Cortex</code>), by clicking on the ellipses <code>…</code>, selecting the appropriate directory and clicking <code>OK</code>.</li>
<li>Click <code>OK</code>. If an existing site is already using the specified port, a warning will be displayed. Either click <code>No</code> and change the <code>Port</code> in the <code>Add Website</code> dialog, or click <code>Yes</code> and stop the other website.</li>
</ol>
<h2 id="configure-web-site">Configure Web Site</h2>
<p>The web site which the Gateway and Flow Debugger Service are installed under requires additional configuration.</p>
<h3 id="configure-https">Configure HTTPS</h3>
<p>Both the Gateway and Flow Debugger Service should be configured to use HTTPS:</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    For sites using self-signed SSL certificates, the HTTPS URL redirection will only work in Google Chrome browsers. For all other supported browsers, an SSL certificate signed by a Certificate Authority must be used to enable HTTPS URL redirection.

</div>

<ol>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, expand the server node.</li>
<li>Expand the <code>Sites</code> node under the server.</li>
<li>Right-click the web site where Gateway will be installed and select <code>Edit Bindings…</code>.</li>
<li>Click <code>Add…</code></li>
<li>Set Type to <code>https</code>.</li>
<li>Set the appropriate Port number (typically 443). The <code>Host name</code> box can be left blank.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Configuring your system to use a port other than the HTTPS default of 443 is not compatible with HTTP Strict Transport Security (HSTS). If your configuration requires HTTPS to run on a port other than 443, the HSTS configuration must be turned off. This can be achieved by configuring the <code>Add Strict-Transport-Security when HTTPS</code> rewrite rule’s <code>enabled</code> setting to <code>false</code> in web.config after installation.

</div>
</li>
<li>Select the SSL certificate that was used when <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-application-server#configure-installation-script">installing the Application Server</a>. If self-signed certificates were used, this will have the subject <code>CN=CortexServerCertificate</code>.</li>
<li>Click <code>OK</code>. If an existing site is already using the specified SSL port, a warning will be displayed. Either click <code>No</code> and change the <code>Port</code> in the <code>Add Site Binding</code> dialog, or click <code>Yes</code> and stop the other website.</li>
<li>It is recommended to remove the <code>http</code> site binding.</li>
</ol>
<h2 id="install-flow-debugger-service">Install Flow Debugger Service</h2>
<h3 id="get-application-pool-user">Get Application Pool User</h3>
<p>A domain user account is required for the Flow Debugger Service web application pool and must be created prior to performing the installation. In line with best practices, this account should not be used for any purposes other than those specified for the Flow Debugger Service. Alternatively, the <code>NETWORK SERVICE</code> user may also be used.</p>
<p>This user must currently have access to the default NuGet directory, in order to load block packages correctly. To add permissions for the user take the following steps:</p>
<ol>
<li>Navigate to <code>%SystemRoot%\System32\config\systemprofile\AppData\Roaming\</code> and create a new folder named <code>NuGet</code> if one does not exist.</li>
<li>Right-click on the <code>NuGet</code> folder and click <code>Properties</code>.</li>
<li>In the dialog, click the <code>Security</code> tab.</li>
<li>Click the <code>Edit...</code> button.</li>
<li>Click the <code>Add...</code> button.</li>
<li>Enter the username of the application pool user and click <code>OK</code>.</li>
<li>In the <code>Permissions</code> section at the bottom, check <code>Full control</code></li>
<li>Click <code>OK</code>.</li>
</ol>
<p>The user must be given <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions. To do this take the following steps:</p>
<ol>
<li>Navigate to <code>Start</code> -&gt; <code>Administrative Tools</code> -&gt; <code>Local Security Policy</code>.</li>
<li>In the Local Security Policy dialog, expand the <code>Local Policies</code> node then select <code>User Rights Assignment</code>.</li>
<li>Take the following steps for the <code>Log on as a service</code> and <code>Log on as a batch job</code> policies:
<ol>
<li>In the right-hand panel, double-click on the policy.</li>
<li>In the Properties dialog, click on the <code>Add User or Group</code> button.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    It is possible to use the <code>Advanced…</code> button to look up names rather than entering them manually. Various filters can be set to find the correct user or group more easily. Multiple users can be selected by holding down <code>CTRL</code> while clicking. <code>OK</code> adds the selected users or groups into the <code>Enter the object names to select</code> text box.

</div>
</li>
<li>Type the name of the application pool user account into the <code>Enter the object names to select</code> text box. Click the <code>Check Names</code> button to confirm that the user exists.</li>
<li>Click <code>OK</code> on the Select Users dialog, and then confirm the user is correct by clicking <code>OK</code> on the Properties dialog.</li>
</ol>
</li>
</ol>
<h3 id="configure-installation-script">Configure Installation Script</h3>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder, locate the <code>Cortex.Innovation.Install.FlowDebuggerService.ps1</code> script and open it with a text editor.</p>
</li>
<li>
<p>Choose the tab below that matches the configuration for this installation, then update the script to match, changing the parameters according to the details given below:</p>

        














        














    <ul class="nav nav-tabs" id="tabs-6" role="tablist"><li class="nav-item">
      <a class="nav-link active"
        id="tabs-6-0-tab" data-toggle="tab" href="#tabs-6-0" role="tab"
        aria-controls="tabs-6-0" aria-selected="true">
        CA Certs
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-6-1-tab" data-toggle="tab" href="#tabs-6-1" role="tab"
        aria-controls="tabs-6-1" aria-selected="false">
        Self-Signed Certs
      </a>
    </li></ul>


<div class="tab-content" id="tabs-6-content"><div class="tab-pane fade show active"
        id="tabs-6-0" role="tabpanel" aria-labelled-by="tabs-6-0-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FlowDebuggerService</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerServicePath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Flow Debugger Service.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$AppPoolIdentity</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-flow-debugger-service-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  <div class="tab-pane fade"
        id="tabs-6-1" role="tabpanel" aria-labelled-by="tabs-6-1-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FlowDebuggerService</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerServicePath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Flow Debugger Service.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-BlockPackagesPath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Block Packages.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthUserName</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-FlowDebuggerBasicAuthPwd</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-UseSelfSignedCertificates</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$AppPoolIdentity</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-flow-debugger-service-install-log.txt&#34;</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  
</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FlowDebuggerServicePath</code></td>
<td>Configure this value with the location of the Flow Debugger Service zip file on the server.</td>
</tr>
<tr>
<td><code>BlockPackagesPath</code></td>
<td>Configure this value with the location of the Block Packages zip file on the server.</td>
</tr>
<tr>
<td><code>FlowDebuggerBasicAuthUserName</code></td>
<td>Configure this value with the username that will be used for Basic Authentication when Gateway makes HTTPS requests to the Flow Debugger Service. <br /><br />For security reasons it is recommended that the default value <code>BasicAuthUser</code> should be changed.<br /><br />Currently only Basic Authentication using a single user is supported, OAuth2 will be supported in a future release.<br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>FlowDebuggerBasicAuthPwd</code></td>
<td>Configure this value with the password that will be used for Basic Authentication when Gateway makes HTTPS requests to the Flow Debugger Service. <br /><br />This password should be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>. For security reasons it is recommended that the default value <code>ADA9883B11BD4CDC908B8131B57944A4</code> should be changed.<br /><br />This value will be needed <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server#install-gateway">later, when installing Gateway</a>.</td>
</tr>
<tr>
<td><code>UseSelfSignedCertificates</code></td>
<td>Enables Flow Debugger Service to communicate with Gateway using generated Self-Signed Certificates rather than CA Certificates.  <br /><br /> Not recommended for production use.</td>
</tr>
<tr>
<td><code>Credential</code></td>
<td>The credentials of the user that will be used to run the <code>Debugger</code> application pool in IIS. <br /><br /> This does not need to be changed, a prompt will appear to enter this information when the script is run.</td>
</tr>
<tr>
<td><code>AcceptEULA</code></td>
<td>This does not need to be changed, the EULA will be accepted at a later stage.</td>
</tr>
<tr>
<td><code>FilePath</code></td>
<td>The filename that installation logs are written to.  If this should be written to a different location than where the installation files are then a full path should be specified.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save and close <code>Cortex.Innovation.Install.FlowDebuggerService.ps1</code>.</p>
</li>
</ol>
<h3 id="run-installation-script">Run Installation Script</h3>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Web App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FlowDebuggerService</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to install the Flow Debugger Service.</p>
</li>
<li>
<p>A credentials prompt will appear. Enter the credentials of the user that should run the <code>Debugger</code> application pool in IIS. If using the <code>NETWORK SERVICE</code> user, enter any user as the username and leave the password blank; the <code>NETWORK SERVICE</code> user will need to be selected in the final step.</p>
</li>
<li>
<p>Wait for the script to finish running. This should take approximately 2 minutes.</p>
</li>
<li>
<p>An error may have appeared saying:</p>
<pre tabindex="0"><code>The Windows Process Activation Service service is not started.
</code></pre><p>This can be ignored.</p>
</li>
<li>
<p>Check that there have been no other errors in the script; these would appear in red in the console.</p>
<p>If there are any errors, then please follow any instructions given within them to rectify the situation, and retry the installation.</p>
<p>If the errors do not give any instructions on how to rectify, please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for further assistance.</p>
</li>
<li>
<p>If using <code>NETWORK SERVICE</code> for the application pool user:</p>
<ol>
<li>Open Internet Information Services (IIS) Manager.</li>
<li>On the left, expand the server node.</li>
<li>Click <code>Application Pools</code>.</li>
<li>Right-click on the <code>Debugger</code> application pool and select <code>Advanced Settings...</code>.</li>
<li>In the <code>Advanced Settings</code> dialog, click on <code>Identity</code> and then click the ellipses (<code>...</code>).</li>
<li>In the <code>Application Pool Identity</code> dialog, select <code>Built-in account</code>, then select <code>NetworkService</code> from the drop-down, then click <code>OK</code>.</li>
<li>Right-click on the <code>Debugger</code> application pool and click <code>Recycle...</code>.</li>
</ol>
</li>
</ol>
<h2 id="install-gateway">Install Gateway</h2>
<h3 id="get-application-pool-user-1">Get Application Pool User</h3>
<p>A domain user account is required for the Gateway web application pool and must be created prior to performing the installation
below.</p>
<p>This user account is required to enable Gateway to access the Cortex database, with the following roles:</p>
<ul>
<li>dbcreator</li>
<li>public</li>
</ul>
<p>To add roles to database users take the following steps:</p>
<ol>
<li>
<p>Open SQL Server Management Studio on the server and log in.</p>
</li>
<li>
<p>Expand the server node, then <code>Security</code> then <code>Logins</code>.</p>
</li>
<li>
<p>If the user that will run the Gateway application pool is not in the list of logins, take the following steps, otherwise skip to step 4:</p>
<ol>
<li>Right-click the <code>Logins</code> node and click <code>New Login...</code>.</li>
<li>Enter the application pool user in the <code>Login name</code> box.</li>
<li>On the left pane, click <code>Server Roles</code>.</li>
<li>Check <code>public</code> and <code>dbcreator</code></li>
<li>Click <code>OK</code>.</li>
</ol>
</li>
<li>
<p>If the user that will run the Gateway application pool is in the list of logins, take the following steps:</p>
<ol>
<li>Right-click on the application pool user.</li>
<li>Click <code>Properties</code>.</li>
<li>On the left pane, click <code>Server Roles</code>.</li>
<li>Check <code>public</code> and <code>dbcreator</code>.</li>
<li>Click <code>OK</code>.</li>
</ol>
</li>
</ol>
<p>In line with best practices, this account should not be given administrator rights, nor should it be used for any purposes other than those specified for Gateway.</p>
<p>The user must be given <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions. To do this take the following steps:</p>
<ol>
<li>Navigate to <code>Start</code> -&gt; <code>Administrative Tools</code> -&gt; <code>Local Security Policy</code>.</li>
<li>In the Local Security Policy dialog, expand the <code>Local Policies</code> node then select <code>User Rights Assignment</code>.</li>
<li>Take the following steps for the <code>Log on as a service</code> and <code>Log on as a batch job</code> policies:
<ol>
<li>In the right-hand panel, double-click on the policy.</li>
<li>In the Properties dialog, click on the <code>Add User or Group</code> button.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    It is possible to use the <code>Advanced…</code> button to look up names rather than entering them manually. Various filters can be set to find the correct user or group more easily. Multiple users can be selected by holding down <code>CTRL</code> while clicking. <code>OK</code> adds the selected users or groups into the <code>Enter the object names to select</code> text box.

</div>
</li>
<li>Type the name of the application pool user account into the <code>Enter the object names to select</code> text box. Click the <code>Check Names</code> button to confirm that the user exists.</li>
<li>Click <code>OK</code> on the Select Users dialog, and then confirm the user is correct by clicking <code>OK</code> on the Properties dialog.</li>
</ol>
</li>
</ol>
<h3 id="create-gateway-application-pool">Create Gateway Application Pool</h3>
<ol>
<li>Open Internet Information Services (IIS) Manager.</li>
<li>Select and right-click the <code>Application Pools</code> node under the server and select <code>Add Application Pool…</code></li>
<li>Set <code>Name</code> to <code>Cortex Gateway</code>.</li>
<li>Ensure that the <code>.NET CLR version</code> is set to <code>.NET CLR Version v4.0.30319</code> (This may be configured by default).</li>
<li>Ensure that the <code>Managed pipeline mode</code> is set to <code>Integrated</code> (This may be configured by default).</li>
<li>Click <code>OK</code></li>
<li>Right click on the created application pool and select <code>Advanced Settings…</code></li>
<li>Click the <code>...</code> next to <code>Identity</code> (under Process Model) to open a dialog, then select <code>Custom Account</code> and <code>Set...</code>.</li>
<li>Enter the username and password for the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a>.</li>
<li>Click <code>OK</code> to close the <code>Set Credentials</code> dialog.</li>
<li>Click <code>OK</code> to close the <code>Application Pool Identity</code> dialog.</li>
<li>Click <code>OK</code> to close the <code>Advanced Settings</code> dialog.</li>
</ol>
<h3 id="create-new-web-application">Create New Web Application</h3>
<ol>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, expand the server node.</li>
<li>Right-click on the <a href="#create-web-site">site</a> the application should be installed under and select <code>Add Application…</code></li>
<li>Set the <code>Alias</code> to <code>gateway</code>. This must be lowercase.</li>
<li>Click <code>Select…</code> and from the Application pool dropdown select the <code>Cortex Gateway</code> application pool and click <code>OK</code>.</li>
<li>Set the <code>Physical path</code> to <code>C:\inetpub\wwwroot\Cortex\Gateway</code> by clicking on the ellipses <code>…</code> and selecting the appropriate directory. Create the <code>C:\inetpub\wwwroot\Cortex\Gateway</code> directory if it does not already exist.</li>
<li>Click <code>OK</code>.</li>
</ol>
<h3 id="configure-iis-site-redirect-to-the-specified-web-application-optional">Configure IIS Site Redirect to the Specified Web Application (Optional)</h3>
<p>If the site hosting the Gateway web application is a newly created Cortex site or an existing site that doesn’t have its own content, it is recommended to redirect the site URL to the <code>gateway</code> web application URL, e.g. <code>https://FullyQualifiedDomainName</code> to <code>https://FullyQualifiedDomainName/gateway</code>.</p>
<ol>
<li>Open Internet Information Services (IIS) Manager.</li>
<li>Select the site hosting the <code>gateway</code> web application and from IIS settings double-click the <code>HTTP Redirect</code> icon.</li>
<li>Click the check box <code>Redirect requests to this destination</code>.</li>
<li>Enter <code>https://FullyQualifiedDomainName/gateway</code>, replacing <code>FullyQualifiedDomainName</code> with the FQDN of the server.</li>
<li>In the <code>Redirect Behaviour</code> section, click <code>Only redirect requests to content in this directory (not subdirectories)</code>.</li>
<li>In <code>Actions</code> click the <code>Apply</code> button.</li>
</ol>
<h3 id="configure-installation-script-1">Configure Installation Script</h3>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder, locate the <code>Cortex.Innovation.Install.Gateway.ps1</code> script and open it with a text editor.</p>
</li>
<li>
<p>Configure the script according to the details given below:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Gateway</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-GatewayPackagePath</span> <span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Gateway.zip&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-GatewayApplicationIISPath</span> <span style="color:#4e9a06">&#34;Cortex\gateway&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ModelDBContextConnectionString</span> <span style="color:#4e9a06">&#34;Data Source=localhost;Initial Catalog=CortexWeb;Integrated Security=True;MultipleActiveResultSets=True&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-AuthContextConnectionString</span> <span style="color:#4e9a06">&#34;Data Source=localhost;Initial Catalog=CortexWeb.Auth;Integrated Security=True;MultipleActiveResultSets=True&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-SignalRContextConnectionString</span> <span style="color:#4e9a06">&#34;Data Source=localhost;Initial Catalog=CortexWeb.SignalR;Integrated Security=True;MultipleActiveResultSets=True&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-FeatureFlags</span> <span style="color:#4e9a06">&#34;InnovationId&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricApiGatewayEndpoint</span> <span style="color:#4e9a06">&#34;https://server.domain.com:8722/&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricUsingSelfSignedCertificates</span> <span style="color:#000">$false</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricApiGatewayBasicAuthUsername</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-ServiceFabricApiGatewayBasicAuthPassword</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerEndpoint</span> <span style="color:#4e9a06">&#34;https://server.domain.com/debugger/api/&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerBasicAuthUsername</span> <span style="color:#4e9a06">&#34;BasicAuthUser&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerBasicAuthPassword</span> <span style="color:#4e9a06">&#34;ADA9883B11BD4CDC908B8131B57944A4&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-DotNetFlowDebuggerUsingSelfSignedCertificates</span> <span style="color:#000">$false</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-Test:</span><span style="color:#000">$Test</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">-AcceptEULA:</span><span style="color:#000">$AcceptEula</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">*&gt;&amp;</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-gateway-install-log.txt&#34;</span>
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GatewayPackagePath</code></td>
<td>Configure this value with the location of the <code>Cortex Innovation 2022.9 - Gateway.zip</code> file on the installation server.</td>
</tr>
<tr>
<td><code>GatewayApplicationIISPath</code></td>
<td>Change to the correct <code>Site Name/Application</code> if either was modified from the defaults (<code>Cortex/gateway</code>) when creating the <a href="#create-web-site">website</a> or <a href="#create-new-web-application">application</a>.</td>
</tr>
<tr>
<td><code>ModelDBContextConnectionString</code></td>
<td>If SQL Server was installed as the default instance, change the <code>Data Source</code>in the connection string to <code>localhost</code>.<br /><br />If SQL Server was installed as a named instance, change it to <code>.\{instanceName}</code> replacing <code>{instanceName}</code> with the name of the instance. <br /><br />This will set the <code>ModelDBContextConnectionString</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>AuthContextConnectionString</code></td>
<td>If SQL Server was installed as the default instance, change the <code>Data Source</code>in the connection string to <code>localhost</code>.<br /><br />If SQL Server was installed as a named instance, change it to <code>.\{instanceName}</code> replacing <code>{instanceName}</code> with the name of the instance. <br /><br />This will set the <code>AuthContextConnectionString</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>SignalRContextConnectionString</code></td>
<td>If SQL Server was installed as the default instance, change the <code>Data Source</code>in the connection string to <code>localhost</code>.<br /><br />If SQL Server was installed as a named instance, change it to <code>.\{instanceName}</code> replacing <code>{instanceName}</code> with the name of the instance. <br /><br />This will set the <code>SignalRContextConnectionString</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>FeatureFlags</code></td>
<td>Replace <code>InnovationId</code> with the Cortex Innovation feature identifier, which should have been provided by Cortex when fulfilling the <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites#licensing-requirements">Licensing Requirements</a>, if it wasn&rsquo;t it should be requested using <a href="https://support.cortex.co.uk/">Cortex Service Portal</a>.<br /><br />This will set the <code>FeatureFlags</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricApiGatewayEndpoint</code></td>
<td>Replace <code>server.domain.com</code> with the fully qualified domain name of the server. The port should be specified as <code>8722</code> and there must be a trailing slash, e.g. <code>https://server.domain.com:8722/</code>.<br /><br />This will set the <code>ServiceFabricApiGatewayEndpoint</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricUsingSelfSignedCertificates</code></td>
<td>Configure the value as <code>$false</code> if you used valid CA certificates when <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-application-server#configure-installation-script">installing the Application Server</a>, <code>$true</code> if you used self-signed certificates.<br /><br />This will set the <code>ServiceFabricUsingSelfSignedCertificates</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricApiGatewayBasicAuthUsername</code></td>
<td>This must be changed if you used a non-default <code>ApiGatewayBasicAuthUserName</code> when <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-application-server#configure-installation-script">installing the Application Server</a>; if so, this value must be configured to the one used.<br /><br />This will set the <code>ServiceFabricApiGatewayBasicAuthUsername</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>ServiceFabricApiGatewayBasicAuthPassword</code></td>
<td>This must be changed if you used a non-default <code>ApiGatewayBasicAuthPassword</code> when <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-application-server#configure-installation-script">installing the Application Server</a>; if so, this value must be configured to the one used. It can be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>.<br /><br />This will set the <code>ServiceFabricApiGatewayBasicAuthPassword</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerEndpoint</code></td>
<td>Replace <code>server.domain.com</code> with the fully qualified domain name of the Web Application Server.<br /><br />This will set the <code>DotNetFlowDebuggerEndpoint</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerBasicAuthUsername</code></td>
<td>This must be changed if you used a non-default <code>FlowDebuggerBasicAuthUserName</code> when <a href="#configure-installation-script">installing the Flow Debugger Service</a>; if so, this value must be configured to the one used.<br /><br />This will set the <code>DotNetFlowDebuggerBasicAuthUsername</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerBasicAuthPassword</code></td>
<td>This must be changed if you used a non-default <code>FlowDebuggerBasicAuthPassword</code> when <a href="#configure-installation-script">installing the Flow Debugger Service</a>; if so, this value must be configured to the one used. It can be <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/encrypt-text">Cortex Encrypted</a>.<br /><br />This will set the <code>DotNetFlowDebuggerBasicAuthPassword</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>DotNetFlowDebuggerUsingSelfSignedCertificates</code></td>
<td>Configure the value as <code>$false</code> if you are using valid CA certificates to secure the site containing Gateway and Flow Debugger Service, <code>$true</code> if using self-signed certificates.<br /><br />This will set the <code>DotNetFlowDebuggerUsingSelfSignedCertificates</code> value in the Gateway web.config.</td>
</tr>
<tr>
<td><code>Test</code></td>
<td>This does not need to be changed, it will be set at a later stage.</td>
</tr>
<tr>
<td><code>AcceptEULA</code></td>
<td>This does not need to be changed, the EULA will be accepted at a later stage.</td>
</tr>
<tr>
<td><code>FilePath</code></td>
<td>The filename that installation logs are written to.  If this should be written to a different location than where the installation files are then a full path should be specified.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save and close <code>Cortex.Innovation.Install.Gateway.ps1</code>.</p>
</li>
</ol>
<h3 id="test-installation-script">Test Installation Script</h3>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Web App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Gateway</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-Test</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-Test</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to test the configuration.
In the event of any errors, there will be an error message displayed at the end of the output with a line confirming the Error Count.</p>
</li>
</ol>
<h3 id="run-installation-script-1">Run Installation Script</h3>
<ol>
<li>
<p>Ensure the Gateway application pool is stopped:</p>
<ol>
<li>Open Internet Information Service (IIS) Manager.</li>
<li>In the left pane, expand the server node.</li>
<li>Click <code>Application Pools</code> to display a list of the Application Pools.</li>
<li>Right-click the <code>Cortex Gateway</code> application pool and select <code>Stop</code>.</li>
</ol>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Failure to stop the application pool will result in a permissions error when installing Gateway.

</div>

</li>
<li>
<p>Type the following command into PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Gateway</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span>
</span></span></code></pre></div></li>
<li>
<p>Please read the End User Licence Agreement which can be found <a href="https://www.cortex-ia.com/end-user-licence-agreement/">here</a>. Once you agree to the terms, add the flag <code>-AcceptEULA</code> to the command entered above, e.g:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\&lt;</span><span style="color:#000">CortexInnovationInstallScriptName</span><span style="color:#000;font-weight:bold">&gt;.</span><span style="color:#000">ps1</span> <span style="color:#000">-AcceptEULA</span>
</span></span></code></pre></div></li>
<li>
<p>Run the PowerShell command to install Gateway.
In the event of any errors, there will be an error message displayed at the end of the output with a line confirming the Error Count.</p>
</li>
<li>
<p>Ensure that the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a> has <code>Full control</code> access to the Gateway folder created in <a href="#create-new-web-application">Create New Web Application</a>:</p>
<ol>
<li>Navigate to <code>C:\inetpub\wwwroot\Cortex\</code>.</li>
<li>Right-click the <code>Gateway</code> folder and click <code>Properties</code>.</li>
<li>In the <code>Gateway Properties</code> dialog, click the <code>Security</code> tab.</li>
<li>Click the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a> within the <code>Group or user names</code> section.</li>
<li>In the <code>Permissions</code> section, ensure the user has <code>Full control</code> checked. If not:
<ol>
<li>Click the <code>Edit...</code> button.</li>
<li>Select the user identified in <a href="#get-application-pool-user-1">Get Application Pool User</a> within the <code>Group or user names</code> section.</li>
<li>In the <code>Permissions</code> section, check <code>Full control</code>.</li>
<li>Click <code>OK</code>, then wait for <code>Windows Security</code> to update the security information to the folder.</li>
<li>Click <code>OK</code>.</li>
</ol>
</li>
</ol>
</li>
<li>
<p>Start the Gateway application pool:</p>
<ol>
<li>Open Internet Information Service (IIS) Manager.</li>
<li>In the left pane, expand the server node.</li>
<li>Click <code>Application Pools</code> to display a list of the Application Pools.</li>
<li>Right-click the <code>Cortex Gateway</code> application pool and select <code>Start</code>.</li>
</ol>
</li>
<li>
<p>Once the application pool has been started, the site will be available on <code>&lt;protocol&gt;://&lt;host&gt;:&lt;port&gt;/&lt;webapplicationname&gt;</code>, e.g. <code>https://localhost/gateway</code>.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    If the application pool does not stay started, ensure that the user it runs as has <code>Log on as a service</code> and <code>Log on as a batch job</code> permissions or belongs to a group that has those permissions.

</div>
</p>
</li>
</ol>
<h2 id="preserve-installation-files">Preserve installation files</h2>
<p>Ensure that the installation files are backed up or kept on the server, especially the scripts and config files that have been modified. This will make it easier to perform further actions in future, such as troubleshooting, certificate rollover, uninstallation, reinstallation and updates.</p>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/setup-gateway">Setup Gateway</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-94866b9144c7c00ad81be52bc6e7996f">2.5 - Setup Gateway</h1>
    <div class="lead">Information about setting up Cortex Gateway for first-time use.</div>
	<h1 id="setup-gateway">Setup Gateway</h1>
<p>This guide describes how to setup Gateway. Please ensure that <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/install-web-application-server">Install Web Application Server</a> has been completed before taking these steps.</p>
<h2 id="gateway-initial-setup">Gateway Initial Setup</h2>
<p>Log on to Gateway and run through the setup wizard:</p>
<ol>
<li>
<p>Open a <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites#web-browser-requirements">supported web browser</a> and navigate to <code>&lt;protocol&gt;://&lt;host&gt;:&lt;port&gt;/&lt;webapplicationname&gt;</code>, e.g. <code>https://localhost/gateway</code>.</p>
<p>If an error message is displayed in the browser, wait a few minutes and refresh the page as it is possible that the website was still starting.</p>
</li>
<li>
<p>Log on using the default credentials that Gateway deploys with:</p>
<p>Username: <code>administrator</code></p>
<p>Password: <code>Adm1n1strat0r</code></p>
</li>
<li>
<p>On a newly installed system, you will be presented with a Setup Wizard at this point, which will guide you through some basic configuration steps:</p>
<ul>
<li><a href="#account-details">Account Details</a></li>
<li><a href="#ldap-connection">LDAP Connection</a></li>
<li><a href="#ldap-authorisation">LDAP Authorisation</a></li>
</ul>
</li>
<li>
<p>Follow the steps in the setup wizard to configure the relevant areas:</p>
<h3 id="account-details">Account Details</h3>
<ol>
<li>Click <code>Next Step</code>:

    <figure class="centre">
        <img src=" /images/Gateway%20Setup1.png "/> <figcaption>
                <h4>Initial Setup Screen</h4>
            </figcaption>
    </figure>
</li>
<li>Enter an email address for the Administrator and click <code>Next Step</code>:

    <figure class="centre">
        <img src=" /images/Gateway%20Setup2.png "/> <figcaption>
                <h4>Administrator Details Screen</h4>
            </figcaption>
    </figure>
</li>
<li>Change the Administrator password to a unique, secret password and click <code>Next Step</code>:

    <figure class="centre">
        <img src=" /images/Gateway%20Setup3.png "/> <figcaption>
                <h4>Change Password Screen</h4>
            </figcaption>
    </figure>
</li>
</ol>
<h3 id="ldap-connection">LDAP Connection</h3>
<ol>
<li>
<p>Enter the details of your Active Directory server and provide a Username and Password for a user with read access to it:</p>
<p>A connection to an Active Directory server must be established in order to assign authorisation rights to users.</p>
<ol>
<li>In the <code>Server</code> field, enter the Hostname, FQDN or IP Address of the Active Directory server that Gateway should use to authenticate and authorise users.</li>
<li>In the <code>Port</code> field, enter the port number of the Active Directory server. The well-known port for LDAP traffic is <code>389</code>; if SSL encryption is used, the well-known port is <code>636</code>.</li>
<li>If an SSL connection is to be used, tick the box <code>Use SSL</code>.</li>
<li>In the <code>Username</code> field, enter a valid username of a user that has read permissions for the Active Directory server.</li>
<li>In the <code>Password</code> field, enter the password of the user entered in the previous step.</li>
<li>To reduce the scope of any Active Directory searches, add one or more base DNs (Distinguished Names). For each base DN click <code>Add</code> and enter the full LDAP path e.g <code>CN=group, OU=organisational unit, DC=domain, DC=com</code>. These will be used as the roots of any Active Directory searches performed. For more information about distinguished names see <a href="https://msdn.microsoft.com/en-us/library/aa366101(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/aa366101(v=vs.85).aspx</a>.</li>
</ol>
</li>
<li>
<p>Click <code>Test Connection</code> to validate the connection and the user credentials entered and click <code>Next Step</code>.</p>
</li>
</ol>

    <figure class="centre">
        <img src=" /images/Gateway%20Setup4.png "/> <figcaption>
                <h4>LDAP Connection Screen</h4>
            </figcaption>
    </figure>

<h3 id="ldap-authorisation">LDAP Authorisation</h3>
<ol>
<li>
<p>If the authorisation grid fails to load first time round, click <code>Retry</code>.</p>
</li>
<li>
<p>Assign access permissions to Active Directory groups:</p>
<p>To allow users to access the various roles within Gateway, it is first necessary to assign them the appropriate access rights.
Gateway currently supports four roles, but only two are relevant for Cortex Innovation:</p>
<ul>
<li>Admin</li>
<li>Studio</li>
</ul>
<p>To give a user access to a role, set access for a group or Organisational Unit (OU) that the user is a member of:</p>
<ol>
<li>Expand the groups or OUs, or search for the group or OU, to be assigned one or more roles.</li>
<li>Check the relevant roles for each group. Checking a parent group will cascade the setting to all child groups.</li>
</ol>

        <figure class="centre">
            <img src=" /images/Gateway%20Setup5.png "/> <figcaption>
                    <h4>LDAP Authorisation Screen</h4>
                </figcaption>
        </figure>

</li>
<li>
<p>Click <code>Complete Setup</code> to commit the changes.</p>
</li>
<li>
<p>To test the permissions, log out as Administrator and then log in as a user with <code>Studio</code> permissions.</p>
</li>
</ol>
</li>
</ol>
<h2 id="configure-the-gateway-databases-to-use-transparent-data-encryption">Configure the Gateway Databases to use Transparent Data Encryption</h2>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Transparent Data Encryption cannot be applied to SQL Express, only SQL Server instances.

</div>

<p>Once Gateway has been configured, if you wish to encrypt the databases using <a href="https://learn.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption?view=sql-server-ver15">Transparent Data Encryption</a> for improved security, this should now be performed by following the steps in <a href="/docs/getting-started/on-premise/install-innovation-only/advanced/tde">Configuring TDE</a>.</p>
<h2 id="next-steps">Next Steps?</h2>
<ol>
<li><a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/try-it-out">Try it out</a></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-933fcb8cde93f65d148be379416ec5de">2.6 - Try it out</h1>
    <div class="lead">Information about trying out Cortex Innovation for the first time.</div>
	<h1 id="try-it-out">Try it out</h1>
<p>This guide describes how to try out a new Innovation installation to make sure it is working. Please ensure that <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/setup-gateway">Setup Gateway</a> has been completed before taking these steps.</p>
<h2 id="test-debugging-flows">Test Debugging Flows</h2>
<p>Test the platform by creating a new flow and executing it using the following steps:</p>
<ol>
<li>Click on the <code>Flows</code> charm, then the <code>+</code> button and click <code>Group</code> to open a dialog.</li>
<li>Enter a name for the group, configure the <code>Permission Groups</code> and click <code>OK</code> to create the group.</li>
<li>Click on the group to open it (refresh the page if it does not appear).</li>
<li>Inside the group, click the <code>+</code> button again and click on <code>Flow</code> to open a dialog. If the menu item is not present, it means that the <code>FeatureFlags</code> in the <code>CortexGateway.SetParameters.xml</code> file was not set properly when installing Gateway. See <a href="/docs/reference/troubleshooting/installation#ts-no-innovation">Troubleshooting</a> for more information.</li>
<li>Enter a name for the flow, configure the <code>Permission Groups</code> and click <code>OK</code> to create the flow.</li>
<li>The flow should be displayed with a start flow block and end flow block. A list of block palettes should be displayed down the left hand side:

    <figure>
        <img src=" /images/New%20Innovation%20Flow%20View.PNG "/> <figcaption>
                <h4>New Flow - Number of palettes may differ</h4>
            </figcaption>
    </figure>

If the blocks in the flow do not display or the palettes are not visible, see <a href="/docs/reference/troubleshooting/installation#ts-no-blocks">Troubleshooting</a> for more information.</li>
<li>Add a <code>Set Variable</code> block and connect it between the start and end blocks.</li>
<li>Click the <code>Set Variable</code> block to open the Property Editor.</li>
<li>Set the <code>Value</code> property to the expression <code>DateTimeOffset.Now</code>.</li>
<li>Type <code>Result</code> into the <code>Variable</code> property and click <code>Create Result</code>.</li>
<li>In the Variable Editor, set <code>Is Output Variable?</code> to <code>true</code> for the new <code>Result</code> variable.</li>
<li>Set a breakpoint on the end block and start the flow. An execution token should appear, the <code>Result</code> variable should show the current time. If the token does not appear, try refreshing the page.</li>
<li>Continue or stop the execution.</li>
<li>Commit the flow.</li>
</ol>
<h2 id="test-publishing-production-flows">Test Publishing Production Flows</h2>
<ol>
<li>Log in to Gateway with a user that has the <code>Admin</code> role.</li>
<li>Click on the <code>Settings</code> charm, then <code>Packages</code>.</li>
<li>Click <code>Add Package Definition</code>. Enter a package name and select the new flow to add to the package. Click <code>Save</code> to save the new package.</li>
<li>Click <code>Publish</code>. A success message should appear. If it doesn&rsquo;t it means that either one or more of the parameters prefixed with <code>Service Fabric</code> in the <code>CortexGateway.SetParameters.xml</code> file was not set properly when installing Gateway, or the Application Services aren&rsquo;t healthy. See <a href="/docs/reference/troubleshooting/installation#ts-no-publish">Troubleshooting</a> for more information.</li>
</ol>
<h2 id="test-executing-production-flows">Test Executing Production Flows</h2>
<ol>
<li>
<p>Open an HTTP client, such as <a href="https://www.postman.com/downloads/">Postman</a>. Make a request with the following format:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Action</td>
<td>POST</td>
</tr>
<tr>
<td>URL</td>
<td>https://{FQDN of server}:8722/api/default/default/flows/{Flow Name}/executions?packageName={Package Name}<br />e.g. https://server.domain.com:8722/api/default/default/flows/NewFlow/executions?packageName=NewPackage</td>
</tr>
<tr>
<td>Content Type</td>
<td>application/json</td>
</tr>
<tr>
<td>Body</td>
<td>{}</td>
</tr>
<tr>
<td>Authentication</td>
<td>Basic</td>
</tr>
<tr>
<td>Username</td>
<td>The value used for <code>ApiGatewayBasicAuthUserName</code> when installing Application Services</td>
</tr>
<tr>
<td>Password</td>
<td>The value used for <code>ApiGatewayBasicAuthPwd</code> when installing Application Services (Unencrypted)</td>
</tr>
</tbody>
</table>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    If you used self-signed certificates when installing the server you will need to disable SSL certificate validation in your HTTP client.

</div>

</li>
<li>
<p>The request should return a JSON object with the output variables of the flow e.g. <code>{ &quot;Output&quot;: &quot;2022-03-09T07:35:16+0000&quot; }</code>.</p>
</li>
<li>
<p>Cortex Innovation has now been verified and is ready to use.</p>
</li>
</ol>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d17aa11112d961718e83172daed190bc">3 - Advanced Setup</h1>
    <div class="lead">Supporting information about installing Cortex Innovation with non-default configurations.</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-27c95e9e19a361fc42704f7dc74835e5">3.1 - Advanced Application Server and Load Balancer Configuration Changes</h1>
    <div class="lead">Information about installing Cortex Innovation with non-default installation values.</div>
	<h1 id="advanced-application-server-and-load-balancer-configuration-changes">Advanced Application Server and Load Balancer Configuration Changes</h1>
<p>Advanced configuration (such as port changes) can be undertaken by taking the following steps before running the PowerShell script. Some values will be modified by the script and they will take precedence, but those parameters can be removed from the script and this file used entirely if required.</p>
<h2 id="multiple-server-with-ha">Multiple Server With HA</h2>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - Installation Scripts</code> folder, locate the file <code>Cortex.Innovation.Install.Config.json</code> and open it with a text editor.</p>
</li>
<li>
<p>Change the configuration file according to your cluster, referring to the following example and details:</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;customers&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;isPrimary&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;rules&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clientConnectionEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8001&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clusterConnectionEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8002&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;leaseDriverEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8003&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;serviceConnectionEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8004&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;httpGatewayEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;9080&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;reverseProxyEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;9081&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;applicationPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;10010-10500&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;ephemeralPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;10501-20000&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;loadBalancer&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>        <span style="color:#204a87;font-weight:bold">&#34;installDirectory&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;%ProgramData%\\loadbalancer&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>        <span style="color:#204a87;font-weight:bold">&#34;iPAddress&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;192.168.20.178&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;loadBalancerSnmpPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;162&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;snmpReceiverServicePort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;10001&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>        <span style="color:#204a87;font-weight:bold">&#34;loadBalancerTlsPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;443&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>        <span style="color:#204a87;font-weight:bold">&#34;apiGatewayServicePort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8722&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>        <span style="color:#204a87;font-weight:bold">&#34;adminCertificate&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;loadBalancerCertificate&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;servers&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;serverName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;iPAddress&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;192.168.1.1&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;serverName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;app-server2&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;iPAddress&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;192.168.1.2&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;serverName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;app-server3&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;iPAddress&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;192.168.1.3&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;servers&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;faultDomain&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fd:/fd1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;serverCertificate&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;serverCert&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">&#34;app-server2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;faultDomain&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fd:/fd2&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;serverCertificate&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;serverCert&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">&#34;app-server3&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;faultDomain&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fd:/fd3&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;serverCertificate&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;serverCert&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;rules&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;windowsSmbRemoteRegistry&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;135&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;137&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;138&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;139&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;445&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqAmqpPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;5671&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqEpmdPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;4369&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqErlangDistributionClientPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;35672-35682&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqErlangDistributionServerPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;25672&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqManagementApiPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;15671&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;serverCertificates&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;serverCert&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pfxCertificatePath&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;C:\\Certificates\\wildCardCert.pfx&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pfxCertificatePassword&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;pfxPassword&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pemRootCertificatePath&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;adminCertificates&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;loadBalancerCert&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pfxCertificatePath&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;C:\\Certificates\\lbCert.pfx&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pfxCertificatePassword&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;pfxPassword&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pemRootCertificatePath&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
<table>
<thead>
<tr>
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>A name identifying the platform being installed. This should have no spaces or symbols. It will be appended to the node names that are displayed in the Service Fabric management tool.</td>
</tr>
<tr>
<td>16-24</td>
<td>If the bundled load balancer is not being used, delete these lines</td>
</tr>
<tr>
<td>17</td>
<td>A local empty or non-existent directory on the load balancer server that the load balancer can be installed in. The directory path will be created if it does not exist. The installation user must have permissions to create and write to directories here. Ensure that all backslashes are escaped with another backslash. Environment variables may be used.</td>
</tr>
<tr>
<td>18</td>
<td>The IPv4 address of the server that the load balancer should run on.</td>
</tr>
<tr>
<td>21</td>
<td>The port that the HTTPS load balancer server should run on. This port should not be in use by anything else.</td>
</tr>
<tr>
<td>22</td>
<td>The port that the API Gateway Service is running on the Application Servers. This should be 8722.</td>
</tr>
<tr>
<td>23</td>
<td>The name of a certificate entry in the adminCertificates section. If this line is removed, an auto-generated self-signed certificate will be used.</td>
</tr>
<tr>
<td>27, 31, 35</td>
<td>The short computer names of the Application Servers. These must not contain the domain. The installation will be run on the first of these nodes.</td>
</tr>
<tr>
<td>28, 32, 36</td>
<td>The respective IPv4 addresses of the Application Servers.</td>
</tr>
<tr>
<td>42, 46, 50</td>
<td>These keys should be changed to the computer names of the Application Servers to match those on lines 26, 30 and 24</td>
</tr>
<tr>
<td>44, 48, 52</td>
<td>The name of a certificate entry in the serverCertificates section. This should be the same for all Application Servers. If these lines are removed, an auto-generated self-signed certificate will be used. Self-signed certificates are not recommended for production systems.</td>
</tr>
<tr>
<td>73-75</td>
<td>Skip configuring these lines if self-signed certificates are being used.</td>
</tr>
<tr>
<td>80-82</td>
<td>Skip configuring these lines if self-signed certificates are being used or if the bundled load balancer is not being used.</td>
</tr>
<tr>
<td>74</td>
<td>This is the local path of a .PFX certificate file on the first Application Server, containing a full chain certificate with private key. Ensure that all backslashes are escaped with another backslash. Environment variables cannot be used.</td>
</tr>
<tr>
<td>75</td>
<td>The password used to secure the .PFX file.</td>
</tr>
<tr>
<td>76</td>
<td>This only needs to be used if the installation has failed due to a missing root certificate. See <a href="/docs/reference/troubleshooting/installation#ts-no-root-certificate">Troubleshooting Root Certificate Error</a> for information.</td>
</tr>
<tr>
<td>81</td>
<td>This is the local path of a .PFX certificate file on the first Application Server, containing a full chain certificate with private key. Ensure that all backslashes are escaped with another backslash. Environment variables cannot be used.</td>
</tr>
<tr>
<td>82</td>
<td>The password used to secure the .PFX file.</td>
</tr>
<tr>
<td>83</td>
<td>This only needs to be used if the installation has failed due to a missing root certificate. See <a href="/docs/reference/troubleshooting/installation#ts-no-root-certificate">Troubleshooting Root Certificate Error</a> for information.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save and close the config file.</p>
</li>
</ol>
<h2 id="single-server-without-ha">Single Server Without HA</h2>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - Installation Scripts</code> folder, locate the file <code>Cortex.Innovation.Install.Config.json</code> and open it with a text editor.</p>
</li>
<li>
<p>Change the configuration file according to your cluster, referring to the following example and details:</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span></span><span style="background-color:#dfdfdf"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;customers&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Customer1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;isPrimary&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;rules&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clientConnectionEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8001&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clusterConnectionEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8002&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;leaseDriverEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8003&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;serviceConnectionEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;8004&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;httpGatewayEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;9080&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;reverseProxyEndpointPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;9081&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;applicationPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;10010-10500&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;ephemeralPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;10501-20000&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;servers&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;serverName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>          <span style="color:#204a87;font-weight:bold">&#34;iPAddress&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;192.168.1.1&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;servers&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">&#34;app-server1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;faultDomain&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fd:/fd1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;serverCertificate&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;serverCert&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;rules&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;windowsSmbRemoteRegistry&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;135&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;137&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;138&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;139&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;445&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqAmqpPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;5671&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqEpmdPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;4369&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqErlangDistributionClientPorts&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;35672-35682&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqErlangDistributionServerPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;25672&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rabbitMqManagementApiPort&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;15671&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;serverCertificates&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;serverCert&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pfxCertificatePath&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;C:\\Certificates\\wildCardCert.pfx&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pfxCertificatePassword&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;pfxPassword&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>      <span style="color:#204a87;font-weight:bold">&#34;pemRootCertificatePath&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
<table>
<thead>
<tr>
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>A name identifying the platform being installed. This should have no spaces or symbols. It will be appended to the node names that are displayed in the Service Fabric management tool.</td>
</tr>
<tr>
<td>18</td>
<td>The short computer names of the node. This must not contain the domain. The installation will be run on the this node.</td>
</tr>
<tr>
<td>19</td>
<td>The IPv4 address of the node.</td>
</tr>
<tr>
<td>25</td>
<td>This key should be changed to the computer names of the node to match that on line 18</td>
</tr>
<tr>
<td>27</td>
<td>The name of a certificate entry in the serverCertificates section. If this line is removed, an auto-generated self-signed certificate will be used. Self-signed certificates are not recommended for production systems.</td>
</tr>
<tr>
<td>48-50</td>
<td>Skip configuring these lines if self-signed certificates are being used.</td>
</tr>
<tr>
<td>48</td>
<td>This is the local path of a .PFX certificate file on the server, containing a full chain certificate with private key. Ensure that all backslashes are escaped with another backslash. Environment variables cannot be used.</td>
</tr>
<tr>
<td>49</td>
<td>The password used to secure the .PFX file.</td>
</tr>
<tr>
<td>50</td>
<td>This only needs to be used if the installation has failed due to a missing root certificate. See <a href="/docs/reference/troubleshooting/installation#ts-no-root-certificate">Troubleshooting Root Certificate Error</a> for information.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save and close the config file.</p>
</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e89dbf42fe66aa13ba7cac5050f57f99">3.2 - Configure Firewalls</h1>
    <div class="lead">Information about configuring Firewalls, e.g. adding rules.</div>
	<h1 id="configure-firewalls">Configure Firewalls</h1>
<h2 id="add-inbound-rules-to-windows-firewall">Add Inbound Rules to Windows Firewall</h2>
<p>To set up inbound rules for Windows Firewall take the following steps for each rule that you want to add:</p>
<ol>
<li>Navigate to <code>Start</code> → <code>Administrative Tools</code> → <code>Windows Firewall with Advanced Security</code>.</li>
<li>In the left-hand panel, click on the <code>Inbound Rules</code> node.</li>
<li>In the right-hand panel, click on <code>New Rule</code>.</li>
<li>In the New Inbound Rule Wizard, select the <code>Port</code> option then click on the <code>Next &gt;</code>
button.</li>
<li>Select either <code>TCP</code> or <code>UDP</code> depending on the rule that is being made.</li>
<li>Select <code>Specific local ports</code>.</li>
<li>Enter the required ports in a comma separated list (e.g. <code>443, 80</code>) in the text box and press <code>Next &gt;</code>.</li>
<li>Select <code>Allow the connection</code> then click <code>Next &gt;</code>.</li>
<li>Click <code>Next &gt;</code> again, then add an identifiable name for the rule</li>
<li>Click <code>Finish</code>.</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ba4fd09d99fc26e56ae5fa878d6fa11b">3.3 - Configure the Gateway Databases to use Transparent Data Encryption</h1>
    <div class="lead">Information about configuring Gateway Databases to use Transparent Data Encryption.</div>
	<h1 id="configure-the-gateway-databases-to-use-transparent-data-encryption">Configure the Gateway Databases to use Transparent Data Encryption</h1>
<p>Once the <a href="/docs/getting-started/on-premise/install-innovation-only/multiple-server-with-ha/setup-gateway">Gateway Setup</a> steps have been completed, if you wish to encrypt the databases using <a href="https://learn.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption?view=sql-server-ver15">Transparent Data Encryption</a> (TDE) for improved security, this should now be performed.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    TDE cannot be applied to SQL Express, only SQL Server instances.

</div>

<p>Enabling TDE on the databases ensures that the data is encrypted on disk. The process to do this requires that you:</p>
<ul>
<li>Create a master key in the master database with a strong password. This password must be remembered and/or saved in a secure location to enable decryption of the database later.</li>
<li>Create a certificate within SQL Server.</li>
<li>Backup the certificate and store it in a secure location. If a database needed to be restored elsewhere for any reason the certificate will need to be imported to the new server.</li>
<li>Create a database encryption key in each user database to be encrypted.</li>
<li>Enable encryption on the database.</li>
</ul>
<p>To enable TDE on the suite of Gateway Databases you should complete the following steps:</p>
<ol>
<li>
<p>Open SQL Server Management Studio.</p>
</li>
<li>
<p>Open the <code>Cortex.Install.TDE.sql</code> script included within the <code>Cortex Innovation 2022.9 - Web App Server Install Scripts</code> folder.


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This script will attempt to encrypt all Cortex Databases that exist on the system. Any that do not exist will be skipped. If you do not wish to encrypt all existing Cortex Databases then you should contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for assistance with script modification.

</div>
</p>
</li>
<li>
<p>Set the <code>@sPassword</code> parameter value to a password that you wish to use. 

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This password must be set to a value that is not a blank or empty string, it cannot be <code>null</code> and the script will not execute if it is not changed from the pre-populated value of <code>StrongPassword</code>. The password must also meet your system’s minimum security requirements.

</div>
</p>
</li>
<li>
<p>You can change the names of the certificate and the name of the master key by changing the <code>@sCertName</code> and <code>@sKeyName</code> parameters if you so wish.</p>
</li>
<li>
<p>You can change the location that the certificate and key are backed up to by changing the value of the <code>@sBackupLocation</code> parameter.</p>
<p>The location must already exist, and there must not be any files within the specified location with the same name as the certificate or master key names that have been specified.</p>
<p>The user that this script will be executed as must also have write permissions to this location.</p>
</li>
<li>
<p>Once the parameters have been set appropriately you should now save the script.</p>
<p>We recommended that the modified script is saved out to file (taking care to observe your own organisation&rsquo;s security policies for password management), before it is executed. This may help facilitate the support process if anything goes wrong.</p>
</li>
<li>
<p>Click <code>Execute</code> to run the script. It may take several minutes to execute depending on the size of the databases.</p>
</li>
<li>
<p>Once the script has completed successfully, you should move the backed-up certificate and master key to a secure location and the password specified should also be stored securely.</p>
</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-473627ed5fdaf469986dd76997848b94">3.4 - Create Self-Signed Certificates</h1>
    <div class="lead">Information about creating and installing self-signed certificates.</div>
	<h1 id="create-self-signed-certificates">Create Self-Signed Certificates</h1>
<p>Self-signed certificates should be generated using OpenSSL which is bundled in the Cortex Web App Server Install Scripts:</p>
<h2 id="setup-openssl-in-powershell">Setup OpenSSL in PowerShell</h2>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Make a directory in which to store the certificates by running the following command, changing the path as required:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">mkdir</span> <span style="color:#000">C:</span><span style="color:#000;font-weight:bold">\</span><span style="color:#000">Certificates</span>
</span></span></code></pre></div></li>
<li>
<p>Navigate PowerShell to inside the certificates folder created above, using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Certificates&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Temporarily add OpenSSL to the Path environment variable of your system by running the following command, modifying the path according to the location of <code>openssl.exe</code> in the installation scripts on the machine:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">$env:PATH</span> <span style="color:#000;font-weight:bold">+=</span> <span style="color:#4e9a06">&#34;;C:\Cortex Innovation 2022.9 - Web App Server Install Scripts\OpenSSL&#34;</span>
</span></span></code></pre></div></li>
</ol>
<h2 id="generate-the-root-ca-certificate">Generate the Root CA Certificate</h2>
<ol>
<li>
<p>Create the Root CA private key by running the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">openssl</span> <span style="color:#000">genrsa</span> <span style="color:#000">-out</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">key</span> <span style="color:#0000cf;font-weight:bold">4096</span>
</span></span></code></pre></div></li>
<li>
<p>Generate the Root CA certificate signed with the private key:</p>
<ol>
<li>
<p>Copy the following text into a text editor:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">RANDFILE</span>		<span style="color:#ce5c00;font-weight:bold">=</span> .rnd
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> ca <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_ca</span>	<span style="color:#ce5c00;font-weight:bold">=</span> CA_default	<span style="color:#8f5902;font-style:italic"># The default ca section</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> CA_default <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Directory and file locations.</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># SHA-1 is deprecated, so use SHA-2 instead.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_md</span>        <span style="color:#ce5c00;font-weight:bold">=</span> sha256
</span></span><span style="display:flex;"><span><span style="color:#000">policy</span>            <span style="color:#ce5c00;font-weight:bold">=</span> policy_strict
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> policy_strict <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># The root CA should only sign intermediate certificates that match.</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># See the POLICY FORMAT section of `man ca`.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName</span>             <span style="color:#ce5c00;font-weight:bold">=</span> match
</span></span><span style="display:flex;"><span><span style="color:#000">stateOrProvinceName</span>     <span style="color:#ce5c00;font-weight:bold">=</span> match
</span></span><span style="display:flex;"><span><span style="color:#000">organizationName</span>        <span style="color:#ce5c00;font-weight:bold">=</span> match
</span></span><span style="display:flex;"><span><span style="color:#000">organizationalUnitName</span>  <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#000">commonName</span>              <span style="color:#ce5c00;font-weight:bold">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress</span>            <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> req <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Options for the `req` tool (`man req`).</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_bits</span>        <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#000">distinguished_name</span>  <span style="color:#ce5c00;font-weight:bold">=</span> req_distinguished_name
</span></span><span style="display:flex;"><span><span style="color:#000">string_mask</span>         <span style="color:#ce5c00;font-weight:bold">=</span> utf8only
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># SHA-1 is deprecated, so use SHA-2 instead.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_md</span>          <span style="color:#ce5c00;font-weight:bold">=</span> sha256
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Extension to add when the -x509 option is used.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">x509_extensions</span>     <span style="color:#ce5c00;font-weight:bold">=</span> v3_ca
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> req_distinguished_name <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName</span>				<span style="color:#ce5c00;font-weight:bold">=</span> Country Name <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span> letter code<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName_min</span>			<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName_max</span>			<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stateOrProvinceName</span>		<span style="color:#ce5c00;font-weight:bold">=</span> State or Province Name <span style="color:#ce5c00;font-weight:bold">(</span>full name<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">localityName</span>			<span style="color:#ce5c00;font-weight:bold">=</span> Locality Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, city<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>0.organizationName		<span style="color:#ce5c00;font-weight:bold">=</span> Organization Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, company<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">organizationalUnitName</span>	<span style="color:#ce5c00;font-weight:bold">=</span> Organizational Unit Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, section<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">commonName</span>			<span style="color:#ce5c00;font-weight:bold">=</span> Common Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, your website<span style="color:#a40000">&#39;</span>s domain name<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">commonName_max</span>			<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">64</span>
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress</span>			<span style="color:#ce5c00;font-weight:bold">=</span> Email Address
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress_max</span>		<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">40</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Optionally, specify some defaults.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName_default</span>             <span style="color:#ce5c00;font-weight:bold">=</span> GB
</span></span><span style="display:flex;"><span><span style="color:#000">stateOrProvinceName_default</span>     <span style="color:#ce5c00;font-weight:bold">=</span> Hampshire
</span></span><span style="display:flex;"><span><span style="color:#000">localityName_default</span>            <span style="color:#ce5c00;font-weight:bold">=</span> Southampton
</span></span><span style="display:flex;"><span>0.organizationName_default      <span style="color:#ce5c00;font-weight:bold">=</span> Cortex Ltd
</span></span><span style="display:flex;"><span><span style="color:#000">organizationalUnitName_default</span>	<span style="color:#ce5c00;font-weight:bold">=</span> Cortex 
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress_default</span>			<span style="color:#ce5c00;font-weight:bold">=</span> info@cortex.co.uk
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> v3_ca <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Extensions for a typical CA (`man x509v3_config`).</span>
</span></span><span style="display:flex;"><span><span style="color:#000">subjectKeyIdentifier</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">hash</span>
</span></span><span style="display:flex;"><span><span style="color:#000">authorityKeyIdentifier</span> <span style="color:#ce5c00;font-weight:bold">=</span> keyid:always,issuer
</span></span><span style="display:flex;"><span><span style="color:#000">basicConstraints</span> <span style="color:#ce5c00;font-weight:bold">=</span> critical, CA:true
</span></span><span style="display:flex;"><span><span style="color:#000">keyUsage</span> <span style="color:#ce5c00;font-weight:bold">=</span> critical, digitalSignature, cRLSign, keyCertSign
</span></span></code></pre></div></li>
<li>
<p>Save the file as <code>ca.cnf</code> in the directory created for the certificates above.</p>
</li>
<li>
<p>In the PowerShell window, run the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">openssl</span> <span style="color:#000">req</span> <span style="color:#000">-sha256</span> <span style="color:#000">-x509</span> <span style="color:#000">-new</span> <span style="color:#000">-nodes</span> <span style="color:#000">-key</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">key</span> <span style="color:#000">-days</span> <span style="color:#0000cf;font-weight:bold">3650</span> <span style="color:#000">-out</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">pem</span> <span style="color:#000">-config</span> <span style="color:#000">ca</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">cnf</span>
</span></span></code></pre></div></li>
<li>
<p>Press <code>Enter</code> for all parameters except the Common Name. For this enter <code>Cortex CA</code>.</p>
</li>
</ol>
</li>
<li>
<p>Package your public and private key in a pkcs12 encrypted file (to install with certmgr on windows) by running the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">openssl</span> <span style="color:#000">pkcs12</span> <span style="color:#000">-export</span> <span style="color:#000">-inkey</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">key</span> <span style="color:#000">-in</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">pem</span> <span style="color:#000">-out</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">pfx</span>
</span></span></code></pre></div></li>
<li>
<p>Enter a memorable string as the Export Password when asked, this will be needed when adding the certificate to certmgr.</p>
</li>
<li>
<p>Double click on the <code>cortexCA.pfx</code> file in the certificates folder to import the certificate into the Windows Certificate Store. Perform the following steps:</p>
<ol>
<li>Select <code>Local Machine</code> then click <code>Next</code>.</li>
<li>Click <code>Next</code>.</li>
<li>Enter the Export Password which the certificate was generated with then click <code>Next</code>.</li>
<li>Select <code>Place all certificates in the following store</code>.</li>
<li>Click <code>Browse…</code>.</li>
<li>Select <code>Trusted Root Certification Authorities</code>, click <code>OK</code> then click <code>Next</code>.</li>
<li>Click <code>Finish</code>.</li>
</ol>
</li>
</ol>
<h2 id="generate-the-certificate">Generate the Certificate</h2>
<ol>
<li>
<p>Create a private key for the SSL cert by running the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">openssl</span> <span style="color:#000">genrsa</span> <span style="color:#000">-out</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">key</span> <span style="color:#0000cf;font-weight:bold">2048</span>
</span></span></code></pre></div></li>
<li>
<p>Generate the SSL certificate request:</p>
<ol>
<li>
<p>Copy the following text into a text editor:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">RANDFILE</span>		<span style="color:#ce5c00;font-weight:bold">=</span> .rnd
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> ca <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_ca</span>	<span style="color:#ce5c00;font-weight:bold">=</span> CA_default	<span style="color:#8f5902;font-style:italic"># The default ca section</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> CA_default <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># SHA-1 is deprecated, so use SHA-2 instead.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_md</span>        <span style="color:#ce5c00;font-weight:bold">=</span> sha256
</span></span><span style="display:flex;"><span><span style="color:#000">policy</span>            <span style="color:#ce5c00;font-weight:bold">=</span> policy_loose
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> policy_loose <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Allow the intermediate CA to sign a more diverse range of certificates.</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># See the POLICY FORMAT section of the `ca` man page.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName</span>             <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#000">stateOrProvinceName</span>     <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#000">localityName</span>            <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#000">organizationName</span>        <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#000">organizationalUnitName</span>  <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#000">commonName</span>              <span style="color:#ce5c00;font-weight:bold">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress</span>            <span style="color:#ce5c00;font-weight:bold">=</span> optional
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> req <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Options for the `req` tool (`man req`).</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_bits</span>        <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#000">distinguished_name</span>  <span style="color:#ce5c00;font-weight:bold">=</span> req_distinguished_name
</span></span><span style="display:flex;"><span><span style="color:#000">string_mask</span>         <span style="color:#ce5c00;font-weight:bold">=</span> utf8only
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># SHA-1 is deprecated, so use SHA-2 instead.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">default_md</span>          <span style="color:#ce5c00;font-weight:bold">=</span> sha256
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Extension to add when the -x509 option is used.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">x509_extensions</span>     <span style="color:#ce5c00;font-weight:bold">=</span> v3_req
</span></span><span style="display:flex;"><span><span style="color:#000">req_extensions</span>      <span style="color:#ce5c00;font-weight:bold">=</span> v3_req
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> req_distinguished_name <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName</span>			<span style="color:#ce5c00;font-weight:bold">=</span> Country Name <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span> letter code<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName_min</span>			<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName_max</span>			<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stateOrProvinceName</span>		<span style="color:#ce5c00;font-weight:bold">=</span> State or Province Name <span style="color:#ce5c00;font-weight:bold">(</span>full name<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">localityName</span>			<span style="color:#ce5c00;font-weight:bold">=</span> Locality Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, city<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>0.organizationName		<span style="color:#ce5c00;font-weight:bold">=</span> Organization Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, company<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">organizationalUnitName</span>	<span style="color:#ce5c00;font-weight:bold">=</span> Organizational Unit Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, section<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">commonName</span>			<span style="color:#ce5c00;font-weight:bold">=</span> Common Name <span style="color:#ce5c00;font-weight:bold">(</span>eg, your website<span style="color:#a40000">&#39;</span>s domain name<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">commonName_max</span>			<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">64</span>
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress</span>			<span style="color:#ce5c00;font-weight:bold">=</span> Email Address
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress_max</span>		<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">40</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Optionally, specify some defaults.</span>
</span></span><span style="display:flex;"><span><span style="color:#000">countryName_default</span>             <span style="color:#ce5c00;font-weight:bold">=</span> GB
</span></span><span style="display:flex;"><span><span style="color:#000">stateOrProvinceName_default</span>     <span style="color:#ce5c00;font-weight:bold">=</span> Hampshire
</span></span><span style="display:flex;"><span><span style="color:#000">localityName_default</span>            <span style="color:#ce5c00;font-weight:bold">=</span> Southampton
</span></span><span style="display:flex;"><span>0.organizationName_default      <span style="color:#ce5c00;font-weight:bold">=</span> Cortex Ltd
</span></span><span style="display:flex;"><span><span style="color:#000">organizationalUnitName_default</span>  <span style="color:#ce5c00;font-weight:bold">=</span> Cortex 
</span></span><span style="display:flex;"><span><span style="color:#000">emailAddress_default</span>	       <span style="color:#ce5c00;font-weight:bold">=</span> info@cortex.co.uk
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> v3_req <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">basicConstraints</span> <span style="color:#ce5c00;font-weight:bold">=</span> CA:FALSE
</span></span><span style="display:flex;"><span><span style="color:#000">keyUsage</span> <span style="color:#ce5c00;font-weight:bold">=</span> nonRepudiation, digitalSignature, keyEncipherment
</span></span><span style="display:flex;"><span><span style="color:#000">subjectAltName</span> <span style="color:#ce5c00;font-weight:bold">=</span> @alt_names
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span> alt_names <span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Specify all DNS and/or IP addresses that clients can use to access the secured resource.</span>
</span></span><span style="display:flex;"><span>DNS.1 <span style="color:#ce5c00;font-weight:bold">=</span> MACHINE-NAME 
</span></span><span style="display:flex;"><span>DNS.2 <span style="color:#ce5c00;font-weight:bold">=</span> FULLY QUALIFIED MACHINE NAME
</span></span><span style="display:flex;"><span>DNS.3 <span style="color:#ce5c00;font-weight:bold">=</span> localhost 
</span></span><span style="display:flex;"><span>IP.1 <span style="color:#ce5c00;font-weight:bold">=</span> IP ADDRESS
</span></span><span style="display:flex;"><span>IP.2 <span style="color:#ce5c00;font-weight:bold">=</span> 127.0.0.1 
</span></span></code></pre></div></li>
<li>
<p>Modify the section <code>[alt_names]</code> to include all the required DNS names and IP addresses that clients can use to access the secured resource.
Each DNS name or IP address entry must be suffixed with <code>.N</code> where <code>N</code> is the unique index of the DNS name or IP address entry; see below for examples:</p>
<table>
<thead>
<tr>
<th>Resource URL</th>
<th>Configuration to add</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>https://cortex.co.uk/gateway</code></td>
<td><code>DNS.1 = cortex.co.uk</code></td>
</tr>
<tr>
<td><code>https://internal.cortex.co.uk/gateway</code></td>
<td><code>DNS.2 = internal.cortex.co.uk</code></td>
</tr>
<tr>
<td><code>https://10.0.0.0/gateway</code></td>
<td><code>IP.1 = 10.0.0.0</code></td>
</tr>
<tr>
<td><code>https://192.168.1.100/gateway</code></td>
<td><code>IP.2 = 192.168.1.100</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save the file as <code>san.cnf</code> in the directory created for the certificates above.</p>
</li>
<li>
<p>In the PowerShell window, run the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">openssl</span> <span style="color:#000">req</span> <span style="color:#000">-new</span> <span style="color:#000">-sha256</span> <span style="color:#000">-key</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">key</span> <span style="color:#000">-out</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">req</span> <span style="color:#000">-extensions</span> <span style="color:#000">v3_req</span> <span style="color:#000">-config</span> <span style="color:#000">san</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">cnf</span>
</span></span></code></pre></div></li>
<li>
<p>Press <code>Enter</code> for everything except the Common Name. For this enter <code>Cortex</code>.</p>
</li>
<li>
<p>Sign the request with a previously generated Root CA by running the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">openssl</span> <span style="color:#000">x509</span> <span style="color:#000">-req</span> <span style="color:#000">-sha256</span> <span style="color:#000">-in</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">req</span> <span style="color:#000">-CA</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">pem</span> <span style="color:#000">-CAkey</span> <span style="color:#000">cortexCA</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">key</span> <span style="color:#000">-CAcreateserial</span> <span style="color:#000">-out</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">pem</span> <span style="color:#000">-days</span> <span style="color:#0000cf;font-weight:bold">3650</span> <span style="color:#000">-extensions</span> <span style="color:#000">v3_req</span> <span style="color:#000">-extfile</span> <span style="color:#000">san</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">cnf</span>
</span></span></code></pre></div></li>
<li>
<p>Package your public and private key in a pkcs12 encrypted file (to install with certmgr on windows) by running the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000">openssl</span> <span style="color:#000">pkcs12</span> <span style="color:#000">-export</span> <span style="color:#000">-inkey</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">key</span> <span style="color:#000">-in</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">pem</span> <span style="color:#000">-out</span> <span style="color:#000">cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">pfx</span>
</span></span></code></pre></div></li>
<li>
<p>Enter a memorable string as the Export Password when asked, this will be needed when adding the certificate to certmgr.</p>
</li>
</ol>
</li>
</ol>
<h2 id="import-the-certificate">Import the Certificate</h2>
<ol>
<li>Double click on the <code>cortex.pfx</code> file in the certificates folder to get the certificate imported to the Windows Certificate Store. Perform the following steps:
<ol>
<li>Select <code>Local Machine</code> then click <code>Next</code>.</li>
<li>Click <code>Next</code>.</li>
<li>Enter the Export Password which the certificate was generated with then click <code>Next</code>.</li>
<li>Select <code>Place all certificates in the following store</code>.</li>
<li>Click <code>Browse…</code>.</li>
<li>Select <code>Personal</code>, click <code>OK</code> then click <code>Next</code>.</li>
<li>Click <code>Finish</code>.</li>
</ol>
</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ee76c0361d921fa7f68149bce1441127">3.5 - Encrypt Text</h1>
    <div class="lead">Information about encrypting text using the Cortex Encryptor.</div>
	<h1 id="encrypt-text">Encrypt Text</h1>
<p>To encrypt text using the Cortex Encryptor PowerShell module:</p>
<ol>
<li>
<p>Extract the <code>Cortex Innovation 2022.9 - Encryptor.zip</code> file to a folder with the same name.</p>
</li>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - Encryptor</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - Encryptor&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>In the Windows PowerShell (x64) window, run the following command to import the module:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">Import-Module</span> <span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Encryptor</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">psd1</span>
</span></span></code></pre></div></li>
<li>
<p>In the Windows PowerShell (x64) window, run the following command to encrypt text, replacing <code>text to encrypt</code> with the text that you want to encrypt:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">ConvertTo-EncryptedText</span> <span style="color:#000">-Text</span> <span style="color:#4e9a06">&#34;text to encrypt&#34;</span>
</span></span></code></pre></div><p>The command will return the encrypted text, beginning with <code>#_</code>. This step can be repeated for any texts that need to be encrypted.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note:</h4>

    The <code>Import-Module</code> command will need to be repeated every time a new PowerShell window is used. To install the PowerShell module so that it is always available, follow the instructions laid out <a href="https://learn.microsoft.com/en-us/powershell/scripting/developer/module/installing-a-powershell-module?view=powershell-7.2">here</a>.

</div>

</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5e3a44a25a94bb5b847acae8a02fc8bb">3.6 - Port Requirements for Application Servers and Load Balancer</h1>
    <div class="lead">Information about the ports opened when installing Cortex Innovation.</div>
	<h1 id="port-requirements-for-application-servers-and-load-balancer">Port Requirements for Application Servers and Load Balancer</h1>
<p>Cortex Innovation and Microsoft Service Fabric open a range of firewall ports between the servers and specific services. Some of them are opened during installation, others are opened dynamically as needed. These are opened on Windows Firewall. If any other firewall exists between the servers, it will be necessary to configure this selection of rules on it. Most ports may be altered if another program overlaps with them, the description will say if this is not possible.</p>
<h2 id="cortex-innovation-ports">Cortex Innovation Ports</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default Port(s)</th>
<th>Protocol</th>
<th>Direction</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cortex.RabbitMqAmqpPorts</td>
<td>The port used by AMQP 0-9-1 and 1.0 clients with TLS. <strong>This cannot currently be changed.</strong></td>
<td>5671</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.RabbitMqEpmdPorts</td>
<td>The port used by epmd, a peer discovery service used by RabbitMQ nodes and CLI tools. <strong>This cannot currently be changed.</strong></td>
<td>4369</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.RabbitMqErlangDistribut ionClientPorts</td>
<td>The ports used by CLI tools (Erlang distribution client ports) for communication with nodes and is allocated from a dynamic range (computed as Erlang dist port + 10000 through dist port + 10010). <strong>This cannot currently be changed.</strong></td>
<td>35672-35682</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.RabbitMqErlangDistribut ionServerPort</td>
<td>The port used for RabbitMQ inter-node and CLI tools communication (Erlang distribution server port) and is allocated from a dynamic range (limited to a single port by default, computed as AMQP port + 20000). <strong>This cannot currently be changed.</strong></td>
<td>25672</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.RabbitMqManagement ApiPort</td>
<td>The port used by the RabbitMQ management plugin. <strong>This cannot currently be changed.</strong></td>
<td>15671</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.WindowsSmbRemote Registry</td>
<td>The ports used by Windows SMB and Remote Registry service.</td>
<td>135, 137, 138, 139, 445</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.ServiceFabric.Customer1. ClusterConnectionEndpointPort</td>
<td>The port used by the client to connect to the cluster when client APIs are used.</td>
<td>8001</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.ServiceFabric.Customer1. ClientConnectionEndpointPort</td>
<td>The port where the nodes communicate with each other.</td>
<td>8002</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
<tr>
<td>Cortex.ServiceFabric.Customer1. ServiceConnectionEndpointPort</td>
<td>The port used by the applications and services deployed on a node to communicate with the Service Fabric client on that particular node.</td>
<td>8004</td>
<td>TCP</td>
<td>Inbound</td>
</tr>
</tbody>
</table>
<h2 id="microsoft-service-fabric-firewall-rules-present-on-all-application-servers-with-domain-public-and-private-profiles">Microsoft Service Fabric Firewall Rules (present on all Application Servers, with Domain, Public and Private Profiles)</h2>
<p>These rules will all appear in Windows Firewall with names starting with ‘{CustomerName}.{NodeName} WindowsFabric’.</p>
<table>
<thead>
<tr>
<th>Name in Rule</th>
<th>Name in Config</th>
<th>Description</th>
<th>Default Port(s)</th>
<th>Protocol(s)</th>
<th>Direction</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Processes</td>
<td>application Ports</td>
<td>The ports that are used by the Service Fabric applications. Service Fabric uses these ports whenever new dynamic ports are required. <strong>The application port range should be large enough to cater for the dynamic port allocation of the application. Currently at least 400 is recommended. This may change if new services are added. This range should not overlap the Dynamic Ports (ephemeralPorts) range as set in the configuration.</strong> <br /><br /> <strong>Program</strong>: Any</td>
<td>10010-10500</td>
<td>TCP, UDP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>BackupRestore Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric process which manages the backup and restore of Application Services. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_<AppID>\BRS.Code.Current\FabricBRS.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>CentralSecret Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric process which manages secrets. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_<AppID>\BRS.Code.Current\FabricCSS.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>DCA Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Diagnostics Collection Agent, which manages Diagnostic data. <br /> <br /> <strong>Program:</strong> %ProgramFiles%\Microsoft Service Fabric\bin\ Fabric\DCA.Code\FabricDCA.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Outbound</td>
</tr>
<tr>
<td>Dynamic Ports</td>
<td>ephemeral Ports</td>
<td>Override the <strong><a href="https://support.microsoft.com/kb/929851">dynamic ports used by the OS</a></strong>. Service Fabric uses a part of these ports as application ports, and the remaining are available for the OS. It also maps this range to the existing range present in the OS, so for all purposes, you can use the ranges given in the sample JSON files. <strong>Make sure that the difference between the start and the end ports is at least 255</strong>. You might run into conflicts if this difference is too low, because this range is shared with the OS. To see the configured dynamic port range, run netsh int ipv4 show dynamicport tcp. <br /> <br /> <strong>Program:</strong> Any</td>
<td>10501-20000</td>
<td>TCP, UDP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>EventStore Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric EventStore, which maintains events about the state of the Application Services. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\ES.Code.Current\ EventStore.Service.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>Fabric Gateway Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Gateway, which allows REST and management functions to access the Application Services. <br /> <br /> <strong>Program:</strong> %ProgramFiles%\Microsoft Service Fabric\bin\Fabric\ Fabric.Code\FabricGateway.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>Fabric Process</td>
<td>N/A</td>
<td>The port used by the main Service Fabric service. <br /> <br /> <strong>Program:</strong> %ProgramFiles%\Microsoft Service Fabric\bin\Fabric\ Fabric.Code\Fabric.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>FabricUpgrade Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Upgrade service. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\US.Code.Current\FabricUS.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>FaultAnalysis Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Fault Analysis service. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\FAS.Code.Current\FabricFAS.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>FileStore Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric File Store service, which manages the application file store and image store. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\FileStoreService.Code.Current\ FileStoreService.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>GatewayResource Manager Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Gateway Resource Manager, which provides APIs to manage the Application Services and other resources. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\GRM.Code.Current\FabricGRM.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>HTTP App Gateway</td>
<td>reverse Proxy Endpoint Port</td>
<td><strong>This port cannot be changed at the current time. If it is already in use, please contact Cortex for assistance.</strong> The reverse proxy endpoint. For more information, see <strong><a href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-reverseproxy">Service Fabric reverse proxy</a></strong>. <br /> <br /> <strong>Program:</strong> Any</td>
<td>9081</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>Http Gateway</td>
<td>http Gateway Endpoint Port</td>
<td>The port used by Service Fabric Explorer to connect to the cluster. <strong>This changes the port used to connect to the Service Fabric management portal as part of the post-install checks.</strong> <br /> <br /> <strong>Program:</strong> Any</td>
<td>9080</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>Infrastructure Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Infrastructure Service. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\IS.Code.Current\FabricIS.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>Lease Driver</td>
<td>lease Driver Endpoint Port</td>
<td>The port used by the cluster lease driver to find out if the nodes are still active. <br /> <br /> <strong>Program:</strong> Any</td>
<td>9002</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>ManagedIdentity TokenService Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Managed Identity Token Service. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\MITS.Code.Current\ ManagedIdentityTokenService.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>RepairManager Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Repair Manager Service. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\RM.Code.Current\FabricRM.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
<tr>
<td>Upgrade Orchestration Service Process</td>
<td>N/A</td>
<td>The port used by the Service Fabric Upgrade Orchestration service. <br /> <br /> <strong>Program:</strong> %ProgramData%\SF\<CustomerName>.<Node Name>\Fabric\work\Applications\ __FabricSystem_App*\UOS.Code.Current\FabricUOS.exe</td>
<td>Any</td>
<td>TCP</td>
<td>Inbound, Outbound</td>
</tr>
</tbody>
</table>
<h2 id="cortex-application-service-rules">Cortex Application Service Rules</h2>
<p>Each service has an endpoint which is used to communicate with Service Fabric and the RabbitMQ message broker. These are configured in the ServiceManifest.xml file within each package in the ApplicationPackages\Cortex directory of the installation media. These ports cannot be used by any other program. If they do clash with another program, they may be changed but additional configuration changes may be necessary, as described in the description of each port. The Application ports must not lie in the ephemeralPorts range.</p>
<table>
<thead>
<tr>
<th>Name of Service</th>
<th>Description</th>
<th>Default Port(s)</th>
<th>Protocol(s)</th>
<th>Direction</th>
<th>Program</th>
</tr>
</thead>
<tbody>
<tr>
<td>API Gateway</td>
<td>The port providing an entry into the API Gateway service. This is used by Cortex Gateway to communicate with the Application Services. <strong>If this is changed then it will be necessary to use the updated value in the</strong> <strong>&quot;<strong><strong>Service Fabric Api Gateway Endpoint</strong></strong>&quot; parameter of SetParameters.xml when configuring Cortex Gateway later in this document.</strong></td>
<td>8722</td>
<td>TCP, UDP</td>
<td>Inbound, Outbound</td>
<td>Any</td>
</tr>
<tr>
<td>Flow Execution</td>
<td>The ports providing communication between other services and the stateful Cortex Flow Execution service. These are dynamic ports managed by Service Fabric.</td>
<td>Dynamic – Uses the application ports</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2 id="cortex-load-balancer-rules">Cortex Load Balancer Rules</h2>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Only applicable for installations with HA.

</div>

<p>The load balancer server must be able to retrieve traffic via HTTPS. The following firewall ports are opened by the installer (these rules will all appear in Windows Firewall with names starting with <code>{CustomerName}</code>):</p>
<table>
<thead>
<tr>
<th>Name in Rule</th>
<th>Name in Config</th>
<th>Default Port(s)</th>
<th>Protocol(s)</th>
<th>Direction</th>
<th>Program</th>
</tr>
</thead>
<tbody>
<tr>
<td>GoBetweenTlsPort</td>
<td>loadBalancerTlsPort</td>
<td>443</td>
<td>TCP</td>
<td>Inbound</td>
<td>Any</td>
</tr>
</tbody>
</table>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2154296292afc725b4661ad2c7ef9ec7">3.7 - Rollover CA certificates</h1>
    <div class="lead">Information about updating the certificates on a single or multi-server Cortex platform which uses CA certificates.</div>
	<h1 id="rollover-ca-certificates">Rollover CA certificates</h1>


<div class="pageinfo pageinfo-primary">
<p>This process MUST be undertaken before certificates expire, otherwise your system will become unusable. If certificates have already expired, contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> at the earliest opportunity.</p>
<p>Only platforms which use CA certificates can have their certificates updated using this mechanism. Systems using self-signed certificates must be reinstalled.</p>
<p>This mechanism cannot be used to switch from self-signed to CA certificates; that requires a reinstall.</p>

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    Updating the certificates on a single-server system with no high availability will result in downtime while the upgrade takes place. Ensure that this is undertaken at a suitable time. Systems with high availability will use a rollover mechanism which should not result in any downtime.

</div>

<h2 id="application-server">Application Server</h2>
<h3 id="prerequisites">Prerequisites</h3>
<h4 id="certificate-requirements">Certificate Requirements</h4>
<p>A new, valid X.509 certificate needs to be obtained to update the certificates.</p>
<p>The certificate can be obtained from a Certificate Authority, such as <a href="https://letsencrypt.org/">Let’s Encrypt</a>, and must meet the following requirements:</p>
<ul>
<li>Subject field must be in a wildcard format, pertaining to the domain of the Application Servers (e.g. <code>CN=*.domain.com</code>).</li>
<li>Subject alternative names must include any additional host names that should be able to be used to access the API Gateway Service.</li>
<li>Certificate file must be in a .PFX file format, with a known password.</li>
<li>Certificate file must contain the full chain of certificates.</li>
<li>Certificate file must include the private key.</li>
<li>Key Usage extension must have a value of <code>Digital Signature, Key Encipherment (a0)</code>.</li>
<li>Enhanced Key Usage must include <code>Server Authentication</code> and <code>Client Authentication</code>.</li>
</ul>
<p>This file should be placed in a known location on the Application Server where the certificate update script will be run. This location will be required when running the update script.</p>
<p>If required, a separate X.509 SSL certificate can be obtained to be used by the load balancer to communicate with the Application Services. It must meet all of the other requirements laid out above, except the subject field can also be the FQDN of the load balancer (e.g. <code>CN=machine-name.domain.com</code>).</p>
<h3 id="configure-update-certificates-script">Configure Update Certificates Script</h3>
<ol>
<li>
<p>In the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder, locate the <code>Cortex.Innovation.Update.Certificates.ps1</code> script and open it with a text editor.</p>
</li>
<li>
<p>Choose the tab below that matches the configuration for this installation, then update the script to match, changing the parameters according to the details given below:</p>

        














        














    <ul class="nav nav-tabs" id="tabs-3" role="tablist"><li class="nav-item">
      <a class="nav-link active"
        id="tabs-3-0-tab" data-toggle="tab" href="#tabs-3-0" role="tab"
        aria-controls="tabs-3-0" aria-selected="true">
        Multiple Servers with HA
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-3-1-tab" data-toggle="tab" href="#tabs-3-1" role="tab"
        aria-controls="tabs-3-1" aria-selected="false">
        Single Server without HA
      </a>
    </li></ul>


<div class="tab-content" id="tabs-3-content"><div class="tab-pane fade show active"
        id="tabs-3-0" role="tabpanel" aria-labelled-by="tabs-3-0-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Update</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Certificates</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ClientCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ClientCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  <div class="tab-pane fade"
        id="tabs-3-1" role="tabpanel" aria-labelled-by="tabs-3-1-tab"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Update</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Certificates</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-ConfigFileName</span> <span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Install</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePath</span> <span style="color:#4e9a06">&#34;C:\Install\Certificates\cert.pfx&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-ServerCertificatePwd</span> <span style="color:#4e9a06">&#34;myPassword&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-SkipLoadBalancer</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">-Credential</span> <span style="color:#000">$Credential</span>
</span></span><span style="display:flex;"><span>        </span></span></code></pre></div></div>
  
</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ServerCertificatePath</code></td>
<td>The local path of a new, valid .PFX certificate file on the server. Environment variables cannot be used. <br /><br />The certificate should meet the <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites#certificate-requirements">Certificate Requirements</a>. <br /><br />This certificate will be used for: <ul><li>Securing communication between the Application Services.</li><li>Allowing Application Services to identify themselves to clients such as Gateway.</li><li>Preventing unauthorised nodes from joining the single node cluster.</li><li>Connecting to Service Fabric Explorer from each of the Application Servers.</li></ul></td>
</tr>
<tr>
<td><code>ServerCertificatePwd</code></td>
<td>The password for the .PFX certificate file specified in <code>ServerCertificatePath</code>.</td>
</tr>
<tr>
<td><code>ClientCertificatePath</code></td>
<td>The local path of a .PFX certificate file on the first Application Server in the <code>ApplicationServerIPv4Addresses</code> list. This can be the same certificate as the <code>ServerCertificatePath</code>. Environment variables cannot be used. <br /><br />This is only needed if installing with CA Certificates (Recommended) and using the Built-In Load Balancer. The certificate should meet the <a href="/docs/getting-started/on-premise/install-innovation-only/single-server-without-ha/prerequisites#certificate-requirements">Certificate Requirements</a>.<br /><br />This certificate will be used for: <ul><li>Securing communication between the load balancer and the nodes on the Application Servers.</li></ul></td>
</tr>
<tr>
<td><code>ClientCertificatePwd</code></td>
<td>The password for the .PFX certificate file specified in <code>ClientCertificatePath</code>. <br /><br /> This is only needed if using the Built-In Load Balancer.</td>
</tr>
<tr>
<td><code>SkipLoadBalancer</code></td>
<td>Updates certificates without updating a load balancer.</td>
</tr>
<tr>
<td><code>Credential</code></td>
<td>The credentials of the user which will be used to perform remote operations on the server. It must be a domain user that is a member of the local Administrators group on the server. <br /><br /> This does not need to be changed, a prompt will appear to enter this information when the script is run.</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h3 id="test-update-certificates-script">Test Update Certificates Script</h3>
<ol>
<li>
<p>Open a Windows PowerShell (x64) window as administrator.</p>
</li>
<li>
<p>Navigate PowerShell to inside the <code>Cortex Innovation 2022.9 - App Server Install Scripts</code> folder using the following command, modifying the path as necessary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#204a87">cd </span><span style="color:#4e9a06">&#34;C:\Install\Cortex Innovation 2022.9 - App Server Install Scripts&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Test <code>Cortex.Innovation.Update.Certificates.ps1</code> by running the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Update</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Certificates</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000">-WhatIf</span>
</span></span></code></pre></div></li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on the server and press OK.</p>
</li>
<li>
<p>Wait for the command to finish. It will display the output of the certificate update command without making any changes to the system.</p>
</li>
<li>
<p>Check that there have been no errors in the script; these would appear in red in the console.</p>
<p>If there are no errors, continue to the next section; otherwise, check if the errors have any instructions for rectifying the issue and follow them.</p>
<p>If there are no useful instructions, check that all previous steps have been followed correctly and, if not, rectify it and run the command again. <br /><br />If this does not work, please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for further assistance. The <code>WhatIf</code> script will have created a temporary version of the config file in the script location, showing what changes would be made to it when the script runs. The name is appended with <code>-WhatIf</code> (e.g. <code>Cortex.Innovation.Install.Config-WhatIf.json</code>). This file can be provided when obtaining support.</p>
</li>
</ol>
<h3 id="run-update-certificates-script">Run Update Certificates Script</h3>
<ol>
<li>
<p>Update the certificates for the Application Services and the required infrastructure by running the following command (<code>Tee-Object</code> will write output to both the PowerShell console and a log file, the <code>FilePath</code> value can be changed if required):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#000">Cortex</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Innovation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Update</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Certificates</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ps1</span> <span style="color:#000;font-weight:bold">|</span> <span style="color:#204a87">Tee-Object</span> <span style="color:#000">-FilePath</span> <span style="color:#4e9a06">&#34;cortex-app-certificate-update-log.txt&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>A credentials prompt will appear. Enter credentials of a domain user that is a member of the local Administrators group on the server and press OK.</p>
</li>
<li>
<p>Wait for the script to finish running. This should take approximately 10 minutes.</p>
</li>
<li>
<p>Check that there have been no errors in the script; these would appear in red in the console.</p>
<p>If there are any errors, then please follow any instructions given within them to rectify the situation.</p>
<p>If the errors do not give any instructions on how to rectify, see <a href="/docs/reference/troubleshooting/installation#ts-during-installation">Troubleshooting During Installation</a> for further information; if this does not help then please contact <a href="https://support.cortex.co.uk/">Cortex Service Portal</a> for assistance.</p>
</li>
</ol>
<h3 id="check-application-services">Check Application Services</h3>
<ol>
<li>
<p>Log on to the server.</p>
</li>
<li>
<p>Import the certificate, used in the <code>ServerCertificatePath</code> parameter of the <a href="#configure-update-certificates-script">Configure Update Certificates Script</a> section, to your <code>Current User</code> certificate store. This can be achieved by double clicking on the certificate .PFX file and following the wizard.</p>
</li>
<li>
<p>Open a web browser.</p>
</li>
<li>
<p>Navigate to <code>https://server.domain.com:9080/Explorer</code>, where <code>server.domain.com</code> is the fully qualified domain name of the server. Replace <code>9080</code> with new <code>httpGatewayEndpointPort</code> value if it was changed during configuration.</p>
<p>The screen should resemble that in the following figure:

    <figure>
        <img src=" /images/Service%20Fabric%20Explorer%20-%20Single.png "/> <figcaption>
                <h4>Healthy Service Fabric Explorer Cluster</h4>
            </figcaption>
    </figure>
</p>
<p>The status circles should be entirely green - this indicates that the node and all services and instances are healthy. Other status pages can be accessed by expanding items in the leftmost pane. Issues can be tracked down to the failing component by expanding items with warning triangles or error icons on.</p>
<p>If there is still a warning that the certificate is close to expiring, wait a few hours and refresh the page and it should go away. It can take some time for the certificate to rollover.</p>
</li>
</ol>
<h2 id="web-application-server">Web Application Server</h2>
<p>If the Web Applications also use an expiring certificate, it will also need to be updated:</p>
<h3 id="import-the-certificate">Import the Certificate</h3>
<p>If using a single server and using the same certificates for both the Application Services and Web Applications, a new certificate will already be installed. Otherwise, follow the following instructions to import the new certificate for use with the Web Applications:</p>
<ol>
<li>Put the new, valid certificate in <code>.pfx</code> format on the Web Application Server.</li>
<li>Double click on the certificate file to open the install certificate wizard.</li>
<li>Select <code>Local Machine</code> then click <code>Next</code>.</li>
<li>Click <code>Next</code>.</li>
<li>Enter the Export Password which the certificate was generated with then click <code>Next</code>.</li>
<li>Select <code>Place all certificates in the following store</code>.</li>
<li>Click <code>Browse…</code>.</li>
<li>Select <code>Personal</code>, click <code>OK</code> then click <code>Next</code>.</li>
<li>Click <code>Finish</code>.</li>
</ol>
<h3 id="apply-the-certificate">Apply the Certificate</h3>
<ol>
<li>Open Internet Information Services (IIS) Manager.</li>
<li>In the left-hand pane of Internet Information Service (IIS) Manager, expand the server node.</li>
<li>Right-click on the Site node (usually <code>Cortex</code>) which contains the Debugger and Gateway.</li>
<li>Click <code>Edit Bindings...</code></li>
<li>Click on the <code>https</code> binding and click <code>Edit...</code>.</li>
<li>Click the SSL Certificate <code>Select...</code> button and select the new certificate from the table. Click <code>OK</code> to close the dialog.</li>
<li>Click <code>OK</code> to close Edit Bindings dialog.</li>
<li>Click <code>Close</code> to close the Bindings dialog.</li>
<li>Open Gateway in a browser. Click the padlock icon next to the URL. The certificate displayed should be the updated one.</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0ae9cc41688a1f099f28b887538ab98d">3.8 - SSL Best Practices</h1>
    <div class="lead">Information about the recommended security settings for Innovation servers.</div>
	<h1 id="ssl-best-practices">SSL Best Practices</h1>
<p>A collection of registry settings can be applied during installation to guarantee your server is only using the recommended encryption algorithms and TLS protocols:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Name</th>
<th>Enabled</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ciphers</td>
<td>AES 128/128</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>AES 256/256</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>Triple DES 168</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>DES 56/56</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>NULL</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>RC2 128/128</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>RC2 40/128</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>RC2 56/128</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>RC4 128/128</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>RC4 40/128</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>RC4 56/128</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>RC4 64/128</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Hashes</td>
<td>MD5</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>SHA</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>SHA256</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>SHA384</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>SHA512</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>KeyExchangeAlgorithms</td>
<td>Diffie-Hellman</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>ECDH</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>PKCS</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Protocols</td>
<td>Multi-Protocol Unified Hello</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>PCT 1.0</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>SSL 2.0</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>SSL 3.0</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS 1.0</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS 1.1</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS 1.2</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Cipher Suites</td>
<td>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA25</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_RSA_WITH_AES_256_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_RSA_WITH_AES_128_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_AES_256_GCM_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_AES_128_GCM_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_AES_256_CBC_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_AES_128_CBC_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_AES_256_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_AES_128_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_3DES_EDE_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_DSS_WITH_AES_256_CBC_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_DSS_WITH_AES_128_CBC_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_DSS_WITH_AES_256_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_DSS_WITH_AES_128_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_RC4_128_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_RC4_128_MD5</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_NULL_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_RSA_WITH_NULL_SHA</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_PSK_WITH_AES_256_GCM_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_PSK_WITH_AES_128_GCM_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_PSK_WITH_AES_256_CBC_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_PSK_WITH_AES_128_CBC_SHA256</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_PSK_WITH_NULL_SHA384</td>
<td>✕</td>
</tr>
<tr>
<td></td>
<td>TLS_PSK_WITH_NULL_SHA256</td>
<td>✕</td>
</tr>
</tbody>
</table>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Warning</h4>

    Disabling specific TLS versions or specific Cipher Suites can have impact on Cortex components themselves as well as their communication capabilities with third party systems and services, e.g. Flow Debugger Service executing flows with blocks which communicate with 3rd parties via PowerShell or REST. All parties communicating together must support a shared protocol version and cipher suite, otherwise they will not be able to establish a secure communication link between each other.

</div>


</div>



    
	
  

    
	
  



          </main>
        </div>
      </div>
      

<footer class="bg-dark row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-12 col-sm-12 text-center py-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/cortex_software">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Facebook" aria-label="Facebook">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/cortexintelligentautomation/">
      <i class="fab fa-facebook"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Vimeo" aria-label="Vimeo">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://vimeo.com/cortexautomationsoftware">
      <i class="fab fa-vimeo"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/10975051">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="YouTube" aria-label="YouTube">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/channel/UCZwlagVEozhAjmUySYx8YlA">
      <i class="fab fa-youtube"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
    </div>
    <div class="row">
      <div class="col-6 col-sm-6 text-xs-center order-sm-1">
        
        
        
<ul class="list-unstyled">
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Privacy Policy">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.cortex-ia.com/gdpr-privacy-policy/">
      Privacy Policy
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Terms and Conditions">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.cortex-ia.com/terms-conditions/">
      Terms and Conditions
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Disclaimer">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.cortex-ia.com/disclaimer/">
      Disclaimer
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="Registration Number: 05023238">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://find-and-update.company-information.service.gov.uk/company/05023238">
      Registration Number: 05023238
    </a>
  </li>
  
  <li data-toggle="tooltip" data-placement="top" aria-label="VAT Number: GB204612157">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.tax.service.gov.uk/check-vat-number/enter-vat-details">
      VAT Number: GB204612157
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-6 text-right text-xs-center order-sm-2"> 
        <ul class="list-unstyled">
          
            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="22 Kings Park Road">
      22 Kings Park Road
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="Southampton, SO15 2AT">
      Southampton, SO15 2AT
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="&#43;44 23 8254 8990">
      &#43;44 23 8254 8990
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="info@cortex-ia.com">
      info@cortex-ia.com
  </li>

            
  <li class="text-white" data-toggle="tooltip" data-placement="top" aria-label="Southampton, SO15 2AT">
      Southampton, SO15 2AT
  </li>

          
        </ul>
      </div>
    </div>
    <div class="row">
      <div class="col-12 col-sm-12 text-center order-sm-1 copyright-container">
        Copyright &copy; 2023 Cortex Limited. All Rights Reserved
	
      </div>
    </div>
  </div>
</footer>






    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>













<script src="/js/main.min.357cdcbd77fb614ceb215987dafe216ba8720b4aa10ecd38bccb7c0013e32f2a.js" integrity="sha256-NXzcvXf7YUzrIVmH2v4ha6hyC0qhDs04vMt8ABPjLyo=" crossorigin="anonymous"></script>




  </body>
</html>
