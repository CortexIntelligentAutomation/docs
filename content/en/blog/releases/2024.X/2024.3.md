---
title: "2024.3"
linkTitle: "2024.3"
date: 2024-04-08
author: Paul Arnold ([@paulmarnold](https://twitter.com/paulmarnold))
---

## Summary

The 2024.3 [Fast Track][] release is now available.

## Download Artefacts

Installation artefacts can be requested by raising a case in the [{{% ctx %}} Service Portal][].

## Release Notes

### Overview

2024.3 is the next [Fast Track][] release of {{% ctx %}} and improves on the [2024.1][] release in the following areas:

* Performance
* Observability
* Capability
* Documentation

This release shows [performance improvements][Platform Performance Improvements] in a number of areas:

* [Caching added to Provisioning service][Caching Added to the Provisioning Service] in order to reduce the number of messages sent throughout the HA Platform
* [HealthCheck enabled for the Triggers service after provisioning][HealthCheck Enabled for the Triggers Service after Provisioning]
* General [Load Balancer healthcheck improvements][Load Balancer HealthCheck Improvements]

Observability within the HA Platform has been improved in a number of ways:

* [A new Platform property has been added to provide more information in logs][A New Platform Property has been Added to Provide more Information in Logs]
* [Type and Method properties have been added to all logs][Type and Method Added to Platform Logs]
* [Request duration is now logged in seconds instead of milliseconds][Request Duration is now Logged in Seconds Instead of Milliseconds]
* [Grafana and Promtail updated to use the new and updated log properties][Grafana and Promtail Updated to use the New and Updated Log Properties] to prevent issues with [potentially breaking][Potentially Breaking - Platform] changes
* [Custom Tags can be passed through logs via HTTP request headers][Custom Tags can be Passed Through Logs via HTTP Request Headers] to add custom tags to any log related to the API request made
* [Exception Tags has been added to logs related to exceptions][Exception Tags Added to Logs Related to Exceptions or Problem Details] to provide more information within a log when an issue occurs
* [Result Tag has been updated for API Gateway Service logs][Result Tag Updated for API Gateway Service Logs] to provide more information within a log when an issue occurs
* [Flow Logging Control][] has been added, to allow for logging to be turned on and off for all flows executing within the platform
* [Block Logging Control][] has been added, to allow for logging to be turned on and off for all blocks executing within the platform
* Details related to [running executions can be viewed in real-time][Running Executions can be Viewed in Real-Time]

Upgrades have been added for both [Single Server][A New Single Server Upgrade Script has been Added to the Installation Artefacts] and [Multi Server][A New Multi Server Upgrade Script has been Added to the Installation Artefacts] deployments, including new documentation being created for upgrading a 2024.1 {{% ctx %}} Platform to 2024.3. Additionally, [a new Flow Upgrader tool has been created to upgrade flows][A New Flow Upgrader Tool has been Created to Upgrade Flows] which allows for flows to be upgraded between versions to mitigate potentially breaking as a result of changes related to blocks. This is not required for upgrading the platform from 2024.1 to 2024.3

[Block icons][Block Icon Redesign] within the {{% ctx %}} platform have been redesigned. The refresh includes new icons for every block updating the consistency of design and accessibility of colours used within flows.

The [ExecuteDataCommand][Improved Blocks] block has been improved as part of this release of the platform, adding a new Parameter type for requests made to Oracle data sources. This allows for specifying the type and direction of the parameter, and provides the capability for processes like passing large data sets (CLOB) to an Oracle stored procedure.

The [installation process of the {{% ctx %}} Innovation Platform has been improved][improved installation] and has been updated further to remove references to hard coded drive paths, and now uses environment variables.

Finally, this [Product Portal][] includes updates related to:

* The [improved blocks][Improved Blocks] and data types
* [Exceptions][] and [Data Types][] that were marked as Work In Progess
* The [improved installation][]

Also, new documentation has been added to reflect the new [platform upgrade process][Upgrade Instructions].

### Components

| <nobr> Release Component </nobr>                                               | Version       | Updated                     | Update Type                 | Breaking Change | Notes                                                                                                                                                                                   |
|--------------------------------------------------------------------------------|---------------|-----------------------------|-----------------------------|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <nobr>[{{% ctx %}} Innovation Core Application][] </nobr>                      | 44.4.1.24210  | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} API Gateway Service][] </nobr>              | 34.3.2.24210  | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Authorisation Service][]                    | 4.0.5.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Concurrency Management Service][] </nobr>   | 3.0.5.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Configuration Management Service][] </nobr> | 3.2.2.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Data Storage Service][] </nobr>             | 4.0.6.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Execution Management Service][] </nobr>     | 4.0.7.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Licence Management Service][] </nobr>       | 4.0.5.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Package Management Service][] </nobr>       | 8.0.7.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Provisioning Service][] </nobr>             | 9.0.5.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Scheduling Service][] </nobr>               | 4.1.0.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Triggers Service][] </nobr>                 | 6.1.0.24210   | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>[{{% ctx %}} Innovation Execution Application][] </nobr>                 | 30.2.0.24210  | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>&nbsp; &nbsp; > [{{% ctx %}} Execution Service][] </nobr>                | 14.1.3.24210  | Yes                         | Major                       | Potential       | Major changes occurred between releases, these changes are related to the format of log files and are [potentially breaking][Potentially Breaking - Platform] between 2024.1 and 2024.3 |
| <nobr>[{{% ctx %}} Gateway][Gateway], including [{{% ctx %}} Studio][] </nobr> | 10.12.1.24210 | Yes                         | Minor                       | No              |                                                                                                                                                                                         |
| <nobr>[{{% ctx %}} Blocks Package][Blocks] </nobr>                             | 43.7.2.24210  | Yes                         | Minor                       | No              |                                                                                                                                                                                         |
| <nobr>[{{% ctx %}} Interaction Portal][Interaction Portal] </nobr>             | 1.0.1.24150   | Yes                         | Patch                       | No              |                                                                                                                                                                                         |
| <nobr>{{% ctx %}} App Server Install Scripts </nobr>                           | 5.1.0.24140   | Yes                         | Minor                       | No              |                                                                                                                                                                                         |
| <nobr>{{% ctx %}} Web App Server Install Scripts </nobr>                       | 7.1.0.24140   | Yes                         | Minor                       | No              |                                                                                                                                                                                         |
| <nobr>{{% ctx %}} Licence Fingerprint Generator </nobr>                        | 3.0.0.23470   | No                          | N/A                         | N/A             |                                                                                                                                                                                         |
| <nobr>{{% ctx %}} Encryption Key Generator </nobr>                             | 1.2.0.23470   | No                          | N/A                         | N/A             |                                                                                                                                                                                         |
| <nobr>{{% ctx %}} Encryptor </nobr>                                            | 3.0.0.23460   | Yes                         | Major                       | No              | Major changes occurred between internal development releases, however, these changes are not breaking between 2024.1 and 2024.3                                                         |
| <nobr>{{% ctx %}} Flows Upgrader </nobr>                                       | 1.1.0.24210   | <nobr>First Release </nobr> | <nobr>First Release </nobr> | N/A             |                                                                                                                                                                                         |

### Features

#### Platform Performance Improvements

##### Caching Added to the Provisioning Service

Caching has been added to the [Provisioning Service][{{% ctx %}} Provisioning Service] in order to reduce the number of messages sent throughout the HA Platform and improve the performance of running flows.

The cache has been added with the following rules to limit memory growth within the Provisioning Service:

* Items are removed from the cache if they have not been accessed within one hour
* Items are removed from the cache when the related package version is published or unpublished
* Items related to the "default" package of the system are removed from the cache when "default" package or version is changed or updated

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} Provisioning Service][]

##### HealthCheck Enabled for the Triggers Service after Provisioning

When the [Triggers Service][{{% ctx %}} Triggers Service] is provisioned by the [Provisioning Service][{{% ctx %}} Provisioning Service], a request will be made from the Provisioning Service to the built-in Load Balancer updating the configuration and enabling health checks for the Triggers Service. This allows the Load Balancer to route messages to healthy and available Triggers Services. Previously, the health check for the Triggers Service would unnecessarily execute when a Triggers Service had not been provisioned.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} Provisioning Service][]
  * [{{% ctx %}} Triggers Service][]

##### Load Balancer HealthCheck Improvements

The built-in Load Balancer has been improved to more efficiently check if both the [API Gateway Service][{{% ctx %}} API Gateway Service] and the [Triggers Service][{{% ctx %}} Triggers Service] are healthy and available, now checking which partitions are available and routing messages and requests to healthy services.

Affected Components:

* {{% ctx %}} App Server Install Scripts

#### Platform Observability

##### A New Platform Property has been Added to Provide more Information in Logs

A new property called `Platform` has been added to all logs, which replaces `Service`, containing information related to the platform in which the log was written.

`Platform` contains the following information:

``` json
"Platform": {
  "Node": {
    "Name": "_Node_0",
    "IpAddressOrFqdn": "machine.address",
    "Versions" : {
      "OperatingSystem": "Microsoft Windows NT 10.0.19045.0",
      "DotNet": "6.0.26",
      "ServiceFabric": "10.0.1949.9590",
      "NServiceBus": "7.8.4",
      "Rabbitmq": "3.10.6",
      "Erlang": "25.0.4",
      "$type": "VersionDetails"
    },
    "$type": "NodeDetails"
  },
  "Application": {
    "Name": "fabric:/Core/Services",
    "Type": "Cortex.Innovation.Core",
    "Version": "41.3.0.24130",
    "$type": "ServiceFabricApplicationDetails"
  },
  "Service": {
    "Name": "fabric:/Core/Services/ApiGateway",
    "Type": "ApiGateway",
    "Version": "32.2.0.24130",
    "PartitionId": "4cf98b39-3093-42c4-b88a-6ad4711cf389",
    "ReplicaOrInstanceId": "133511894962823718",
    "$type": "ServiceFabricServiceDetails"
  },
  "Version": "2024.3",
  "$type": "PlatformDetails"
}
```

| Property Name                          | Notes                                                                                 |
|----------------------------------------|---------------------------------------------------------------------------------------|
| `Platform.Node.Name`                   | Name of the node in which the log was written                                         |
| `Platform.Node.IpAddressOrFqdn`        | IP Address or Fully Qualified Domain Name of the machine in which the log was written |
| `Platform.Versions.OperatingSystem`    | Operating system name and version of the machine in which the log was written         |
| `Platform.Versions.DotNet`             | Version of DotNet used by the machine in which the log was written                    |
| `Platform.Versions.ServiceFabric`      | Version of ServiceFabric used by the machine in which the log was written             |
| `Platform.Versions.NServiceBus`        | Version of NServiceBus used by the machine in which the log was written               |
| `Platform.Versions.Rabbitmq`           | Version of Rabbitmq used by the machine in which the log was written                  |
| `Platform.Versions.Erlang`             | Version of Erlang used by the machine in which the log was written                    |
| `Platform.Application.Name`            | Name of the application in which the log was written                                  |
| `Platform.Application.Type`            | Type of the application in which the log was written                                  |
| `Platform.Application.Version`         | Version of the application type in which the log was written                          |
| `Platform.Service.Name`                | Name of the service in which the log was written                                      |
| `Platform.Service.Type`                | Type of the service in which the log was written                                      |
| `Platform.Service.Version`             | Version of the service type in which the log was written                              |
| `Platform.Service.PartitionId`         | PartitionId of the service in which the log was written                               |
| `Platform.Service.ReplicaOrInstanceId` | ReplicaOrInstanceId of the service in which the log was written                       |
| `Platform.Version`                     | Version of {{% ctx %}}                                                                |

Note: If anything was processing logs generated by the platform, references to the `Event.Service` property will need to be updated to use the new nested `Event.Platform.Service` property, otherwise references to the old `Event.Service` property will break.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Authorisation Service][]
  * [{{% ctx %}} Concurrency Management Service][]
  * [{{% ctx %}} Configuration Management Service][]
  * [{{% ctx %}} Data Storage Service][]
  * [{{% ctx %}} Execution Management Service][]
  * [{{% ctx %}} Licence Management Service][]
  * [{{% ctx %}} Package Management Service][]
  * [{{% ctx %}} Provisioning Service][]
  * [{{% ctx %}} Scheduling Service][]
  * [{{% ctx %}} Triggers Service][]
* [{{% ctx %}} Innovation Execution Application][]
  * [{{% ctx %}} Execution Service][]

##### Type and Method Added to Logs

The `Event.Type` property has been updated to contain a friendly name for any log written by the platform and a new property called `Event.Method` has been added to all logs, containing the Method in which the log was written.

These properties can be used to more easily filter and group logs programmatically.

Note: If anything was processing logs generated by the platform, references to the `Event.Type` property will need to be updated to use the new `Event.Method` property, otherwise references to the old `Event.Type` property will break.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Authorisation Service][]
  * [{{% ctx %}} Concurrency Management Service][]
  * [{{% ctx %}} Configuration Management Service][]
  * [{{% ctx %}} Data Storage Service][]
  * [{{% ctx %}} Execution Management Service][]
  * [{{% ctx %}} Licence Management Service][]
  * [{{% ctx %}} Package Management Service][]
  * [{{% ctx %}} Provisioning Service][]
  * [{{% ctx %}} Scheduling Service][]
  * [{{% ctx %}} Triggers Service][]
* [{{% ctx %}} Innovation Execution Application][]
  * [{{% ctx %}} Execution Service][]

##### Request Duration is now Logged in Seconds Instead of Milliseconds

The `Event.Duration.InMilliseconds` property has been replaced with the `Event.Duration.InSeconds` property, which contains the duration of the event being logged in seconds instead of milliseconds.

Note: If anything was processing logs generated by the platform, references to the `Event.Duration.InMilliseconds` property will need to be updated to use the new `Event.Duration.InSeconds` property, otherwise references to the old `Event.Duration.InMilliseconds` property will break.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Authorisation Service][]
  * [{{% ctx %}} Concurrency Management Service][]
  * [{{% ctx %}} Configuration Management Service][]
  * [{{% ctx %}} Data Storage Service][]
  * [{{% ctx %}} Execution Management Service][]
  * [{{% ctx %}} Licence Management Service][]
  * [{{% ctx %}} Package Management Service][]
  * [{{% ctx %}} Provisioning Service][]
  * [{{% ctx %}} Scheduling Service][]
  * [{{% ctx %}} Triggers Service][]
* [{{% ctx %}} Innovation Execution Application][]
  * [{{% ctx %}} Execution Service][]

##### Grafana and Promtail Updated to use the New and Updated Log Properties

Grafana and Promtail have been updated to use the following changed properties within logs:

* [A New Platform Property has been Added to Provide more Information in Logs][]
* [Request Duration is now Logged in Seconds Instead of Milliseconds][]
* [Type and Method Added to Platform Logs][]

Affected Components:

* Grafana
* Promtail
  
##### Custom Tags can be Passed Through Logs via Http Request Headers

A new custom HTTP request header, `customTags`, can be used when making any request to [{{% ctx %}} API Gateway Service][] in order to add custom tags to any log related to the API request made.

The `customTags` header allows for a `Dictionary<string, object>`to be passed in along the header, which is then used as a collection of custom tags that will be added to any log related to the initial API request made.

For example when the following value is passed through the `customTags` header:

```json
{"CustomTag.String":"String value", "CustomTag.Integer":1234, "CustomTag.Boolean": true}
```

It results in the following `Event.Tags.Custom` property being included within all related logs:

```json
"Custom": {
    "CustomTag.String": "String value",
    "CustomTag.Integer": 1234,
    "CustomTag.Boolean": true
},
```

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Authorisation Service][]
  * [{{% ctx %}} Concurrency Management Service][]
  * [{{% ctx %}} Configuration Management Service][]
  * [{{% ctx %}} Data Storage Service][]
  * [{{% ctx %}} Execution Management Service][]
  * [{{% ctx %}} Licence Management Service][]
  * [{{% ctx %}} Package Management Service][]
  * [{{% ctx %}} Provisioning Service][]
  * [{{% ctx %}} Scheduling Service][]
  * [{{% ctx %}} Triggers Service][]
* [{{% ctx %}} Innovation Execution Application][]
  * [{{% ctx %}} Execution Service][]

##### Exception Tags Added to Logs Related to Exceptions

Logs related to Exceptions have had the following tags added to the `Event.Tags.Cortex` property:

* `Exception.Type` - This tag contains the type of exception that has been thrown
* `Exception.Category` - This optional tag contains the category of the exception that has been thrown, it is only added to the tags if the exception has a category property
* `Exception.ErrorCode` - This optional tag contains the error code of the exception that has been thrown, it is only added to the tags if the exception has an error code property

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Authorisation Service][]
  * [{{% ctx %}} Concurrency Management Service][]
  * [{{% ctx %}} Configuration Management Service][]
  * [{{% ctx %}} Data Storage Service][]
  * [{{% ctx %}} Execution Management Service][]
  * [{{% ctx %}} Licence Management Service][]
  * [{{% ctx %}} Package Management Service][]
  * [{{% ctx %}} Provisioning Service][]
  * [{{% ctx %}} Scheduling Service][]
  * [{{% ctx %}} Triggers Service][]
* [{{% ctx %}} Innovation Execution Application][]
  * [{{% ctx %}} Execution Service][]

##### Result Tag Updated for API Gateway Service Logs

Successful [API Gateway Service][{{% ctx %}} API Gateway Service] requests generate logs with the `Event.Tags.Cortex.Result` value set to `"Success"`. Unsuccessful API Gateway Service requests return a [ProblemDetails][] JSON object that provides information related to the error that occurred, and will generate logs with the `Event.Tags.Cortex.Result` value set to the type of the ProblemDetails, showing why the request has failed.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]

##### Flow Logging Control

An API route has been added to the [API Gateway Service][{{% ctx %}} API Gateway Service] which allows for configuration of logging for flows running within the {{% ctx %}} Platform. The flow logging `LogLevel` can be changed and updated at runtime.

Flow logging can be configured using the following request:

| Property       | Value                                                                                                                                                              |
|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Action         | PUT                                                                                                                                                                |
| URL            | https://{FQDN of API Gateway Server or Load Balancer}/api/default/default/applications/Execution/services/engine/blocks/packages/versions/executions/flows/logging |
| Content Type   | application/json                                                                                                                                                   |
| Body           | LogLevel (e.g. `0`, would be `LogLevel.Trace`)                                                                                                                     |
| Authentication | Basic                                                                                                                                                              |
| Username       | The value used for `ApiGatewayBasicAuthUsername` when installing Application Services                                                                              |
| Password       | The value used for `ApiGatewayBasicAuthPassword` when installing Application Services (Unencrypted)                                                                |

If flow logging is set to a `LogLevel` between `LogLevel.Trace` (`0`) and `LogLevel.Critical` (`5`) then flow logging will be enabled in the [Execution Service][{{% ctx %}} Execution Service]. Any flow logs with a `LogLevel` lower than the configured `LogLevel` for the platform will not be logged. Information regarding the types of log level and what logs are written at a given level can be found below:

| Log Level                                  | Execution Service Logs written at this Log Level   |
|--------------------------------------------|----------------------------------------------------|
| <nobr>`LogLevel.Trace` (`0`) </nobr>       | None                                               |
| <nobr>`LogLevel.Debug` (`1`) </nobr>       | Logs written when: a flow completes successfully   |
| <nobr>`LogLevel.Information` (`2`) </nobr> | None                                               |
| <nobr>`LogLevel.Warning` (`3`) </nobr>     | None                                               |
| <nobr>`LogLevel.Error` (`4`) </nobr>       | Logs written when: a flow completes unsuccessfully |
| <nobr>`LogLevel.Critical` (`5`) </nobr>    | None                                               |
| <nobr>`LogLevel.None` (`6`) </nobr>        | Turns off Flow Logging                             |

If a Log Level above `LogLevel.Critical` (`5`) is provided, then flow logging across the platform will be disabled.

Note: Flow logging should have a minimal impact on the performance of running flows.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Configuration Management Service][]
* [{{% ctx %}} Innovation Execution Application][]
  * [{{% ctx %}} Execution Service][]

##### Block Logging Control

An API route has been added to the [API Gateway Service][{{% ctx %}} API Gateway Service] which allows for configuration of logging for blocks running within the {{% ctx %}} Platform. The block logging `LogLevel` can be changed and updated at runtime.

Block logging can be configured using the following request:

| Property       | Value                                                                                                                                                                                |
|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Action         | PUT                                                                                                                                                                                  |
| URL            | https://{FQDN of API Gateway Server or Load Balancer}/api/default/default/applications/Execution/services/engine/blocks/packages/versions/executions/flows/workspaces/blocks/logging |
| Content Type   | application/json                                                                                                                                                                     |
| Body           | LogLevel (e.g. `0`, would be `LogLevel.Trace`)                                                                                                                                       |
| Authentication | Basic                                                                                                                                                                                |
| Username       | The value used for `ApiGatewayBasicAuthUsername` when installing Application Services                                                                                                |
| Password       | The value used for `ApiGatewayBasicAuthPassword` when installing Application Services (Unencrypted)                                                                                  |

If block logging is set to a `LogLevel` between `LogLevel.Trace` (`0`) and `LogLevel.Critical` (`5`) then block logging will be enabled in the [Execution Service][{{% ctx %}} Execution Service]. Any block logs with a `LogLevel` lower than the configured `LogLevel` for the platform will not be logged. Information regarding the types of log level and what logs are written at a given level can be found below:

| Log Level                                  | Execution Service Logs written at this Log Level   |
|--------------------------------------------|----------------------------------------------------|
| <nobr>`LogLevel.Trace` (`0`) </nobr>       | None                                               |
| <nobr>`LogLevel.Debug` (`1`) </nobr>       | Logs written when: a block executes successfully   |
| <nobr>`LogLevel.Information` (`2`) </nobr> | None                                               |
| <nobr>`LogLevel.Warning` (`3`) </nobr>     | None                                               |
| <nobr>`LogLevel.Error` (`4`) </nobr>       | Logs written when: a block executes unsuccessfully |
| <nobr>`LogLevel.Critical` (`5`) </nobr>    | None                                               |
| <nobr>`LogLevel.None` (`6`) </nobr>        | Turns off Block Logging                            |

If a Log Level above `LogLevel.Critical` (`5`) is provided, then block logging across the platform will be disabled.

Note: Block logging will have a large impact on the performance of running flows, it is advised to only turn block logging on when investigating issues with running flows.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Configuration Management Service][]
* [{{% ctx %}} Innovation Execution Application][]
  * [{{% ctx %}} Execution Service][]

##### Running Executions can be Viewed in Real-Time

The Package Management page within [Gateway][] has been updated to include an overview of all executions running within the platform.

A column named `Running Executions` has been added to the package management grid, showing the total number of executions running for all package versions.

Also, a `Running Executions` tab has been added to the package definition view shown when a specific version of a package has been selected. This new tab shows a table of details related to any running executions for the selected package version. The following information is displayed for each executions:

* Flow Name - The name of the executing flow
* Execution Id - The Id of the execution
* Started At - The time at which the execution started
* Duration - The total duration of the execution

The `Running Executions` grid will be updated every 10 seconds, refreshing all data accordingly.

This lays the foundations in future releases for allowing control of both production and debug executions at runtime using the `Running Executions` grid, such as: stopping, pausing, resuming, and debugging.

Affected Components:

* [{{% ctx %}} Innovation Core Application][]
  * [{{% ctx %}} API Gateway Service][]
  * [{{% ctx %}} Execution Management Service][]
* [{{% ctx %}} Gateway][Gateway]

#### Platform Upgrades

##### A New Single Server Upgrade Script has been Added to the Installation Artefacts

A new script for upgrading Single Server deployments of the {{% ctx %}} Platform has been created. [Upgrade Instructions][] have been added for how to use this script to upgrade a system from 2024.1 to 2024.3.

Affected Components:

* {{% ctx %}} App Server Install Scripts

##### A New Multi Server Upgrade Script has been Added to the Installation Artefacts

A new script for upgrading Multi Server deployments of the {{% ctx %}} Platform has been created. [Upgrade Instructions][] have been added for how to use this script to upgrade a system from 2024.1 to 2024.3.

The Multi Server upgrade script also upgrades Gobetween on the Load Balancer, this includes updating any health check mechanisms and persists settings within the load balancer. [Upgrade Instructions][] have been added for how to use this script to upgrade a system from 2024.1 to 2024.3.

Affected Components:

* {{% ctx %}} App Server Install Scripts

##### A New Flow Upgrader Tool has been Created to Upgrade Flows

A new Flows Upgrader tool has been added that allows users to upgrade flows so that they are compatible when upgrading the {{% ctx %}} platform. This will only be required if there are breaking or potentially breaking changes related to the flows or blocks when upgrading the platform.

In order to use this tool:

* Flows must be exported to a studio package (e.g. `"{name}.studiopkg"`)
* Open powershell and navigate to the folder where the tool is located
* Run the tool using powershell pointed at the exported studio package (e.g. `.\Cortex.Upgrade.FlowsUpgrader.exe "C:\temp\{name}.studiopkg"`)
* The original studio package will be left unchanged, but a new upgraded package will be created (e.g. `"{name}-{previous version}UpgradedTo{new version}.studiopkg"`)

Note: This is not required for upgrading the platform from 2024.1 to 2024.3 as there are no breaking or potentially breaking changes related to the flows or blocks as part of this release.

In future releases this may be integrated into the upgrade scripts or gateway in order to automatically upgrade flows when upgrading to a new version of the {{% ctx %}} platform.

Affected Components:

* {{% ctx %}} Flows Upgrader

#### Block Icon Redesign

All block icons within the {{% ctx %}} Platform have been redesigned. The refresh includes new icons for every block updating the consistency of design and accessibility of colours used within flows.

The following changes have been made for block icons:

* All Exception Handling blocks are now red and triangle shaped (except the Handle Flow Exception block, which is rectangle due to containing a workspace)
* All Action blocks are now blue and square
* All Action blocks have consistent designs based on their palette
* All Decision blocks are now yellow and diamond shaped
* All Workspace blocks are now grey (except the Handle Flow Exception block, which is red due to being an exception handling block) and rectangle shaped

Further improvements may be made to the design of block icons in a future release.

Affected Components:

* [{{% ctx %}} Block Packages][Blocks]
* [{{% ctx %}} Gateway][Gateway]

#### Improved Blocks

The following [Blocks][] have been improved as part of this release of the platform:

* [Execute Data Command][ExecuteDataCommand] - Two new parameter types have been added for requests made to Oracle data sources: [OracleParameter][] and [OracleParameters][]. These allow for specifying the type and direction of the parameter, and provides the capability for processes like passing large data sets (CLOB) to an Oracle stored procedure.
* [Log Event][LogEventBlock] - has been improved to use the new log format used throughout the platform

Affected Components:

* [{{% ctx %}} Block Packages][Blocks]

#### Improved Installation

The installation process of the {{% ctx %}} Platform has been improved in the following ways:

* The installation scripts have been updated further to remove references to hard coded drive paths, and now uses environment variables

Affected Components:

* {{% ctx %}} App Server Install Scripts
* {{% ctx %}} Web App Server Install Scripts

#### Product Portal

This Product Portal includes updates related to:

* The [improved blocks][Improved Blocks] and data types
* [Exceptions][] and [Data Types][] that were marked as Work In Progess
* The [improved installation][]

Also, new documentation has been added to reflect the new [platform upgrade process][Upgrade Instructions].

### Bug Fixes

The following bugs have been fixed in the 2024.3 release of the {{% ctx %}} Platform:

#### Platform Visibility

##### Log Level for the Triggers Service does not Update

Previously, when changing the log level of the platform, the triggers service would not be updated, this has now been fixed and the triggers service respects the log level set.

##### Platform Health Dashboard queries that use the JSON Parser can Cause Timeouts

Previously, a number of queries created using JSON parser within the Platform Health dashboard could cause Loki to use a large amount of memory leading to timeouts. This has been fixed by using a scoped JSON parser to create these queries.

##### Flow Execution Requests Dashboard queries that use the JSON Parser can Cause Timeouts

Previously, a number of queries created using JSON parser within the Flow Execution Requests dashboard could cause Loki to use a large amount of memory leading to timeouts. This has been fixed by using a scoped JSON parser to create these queries.

#### CORTEX Studio

##### Newly Created, Top-Level groups are not Displayed in Charms until the Authorisation has been Modified

Previously, newly created, Top-Level groups would not be displayed within the Charms until any change had been made to the Studio Authorisation, this has now been fixed.

##### Making changes to a Flow Before the Call to Update the Model Completes After a Commit can cause the Flow to be Corrupted

Previously, if a change is made to a flow after a commit but before the AreFlowsBehind call finishes, the flow had a chance of becoming corrupted. This has now been fixed.

#### Product Portal

##### Incorrect Text in Shortcut Links

A number of hyperlinks within the Product Portal were broken due to incorrect shortcodes causing incorrect text to be inserted into the URL, this has now been fixed.

### Deprecated Features

There are no features deprecated as part of the 2024.3 release of the {{% ctx %}} Platform.

### Removed Features

There are no features removed in the 2024.3 release of the {{% ctx %}} Platform.

### Potential Breaking Changes

The following features have introduced potentially breaking changes in the 2024.3 release of the {{% ctx %}} Platform:

#### Platform Visibility

The following features have changed the format of log files generated by the {{% ctx %}} Platform:

* [A New Platform Property has been Added to Provide more Information in Logs][]
* [Request Duration is now Logged in Seconds Instead of Milliseconds][]
* [Type and Method Added to Platform Logs][]

Grafana and Promtail have been [updated to use the new and updated properties][Grafana and Promtail Updated to use the New and Updated Log Properties].

Note: If anything was processing logs generated by the platform, references to the old properties will need to be updated to use the new or updated properties instead.

### Breaking Changes

There are no known breaking changes as part of the 2024.3 release of the {{% ctx %}} Platform.

### Known Limitations

There are no known known limitations added as part of the 2024.3 release of the {{% ctx %}} Platform:

## Version Support

### Operating Systems

{{% alert color="warning" title="Important" %}}Windows Server 2016 support has been removed.{{% /alert %}}

| OS Type | Supported Versions |
|-|-|-|
| Windows | <ul><li>Server 2019</li><li>Server 2022</li></ul> |
| Linux | Linux is not currently supported |

### 7.X Compatibility

| 7.X Version | Is compatible? | Notes                                        |
|-------------|----------------|----------------------------------------------|
| 7.2         | Yes            |                                              |
| 7.1         | No             | Need to upgrade 7.1 to 7.2 for compatibility |
| 7.0         | No             | Need to upgrade 7.0 to 7.2 for compatibility |

## Install Instructions

If you are installing a new 2024.3 platform or adding it to an existing 7.2 Installation see the guidance below; otherwise, if you are upgrading from an existing 2024.1 platform refer to the [Upgrade Instructions][].

Installing {{% ctx %}} Only:

* [Multiple Server - With HA][Innovation Only - Multiple Server - With HA]
* [Single Server - Without HA][Innovation Only - Single Server - Without HA]

Adding {{% ctx %}} to a 7.2 Installation:

* [Multiple Server - With HA][Adding Innovation to a 7.2 Installation - Multiple Server - With HA]
* [Single Server - Without HA][Adding Innovation to a 7.2 Installation - Single Server - Without HA]

## Upgrade Instructions

if you are upgrading from an existing 2024.1 platform see the guidance below:

Upgrading {{% ctx %}}:

* [Multiple Server - With HA][Upgrade - Multiple Server - With HA]
* [Single Server - Without HA][Upgrade - Single Server - Without HA]

## Upcoming Releases

Releases are currently forecast to be made available on:

| Release | Release Type   | Forecast Release Date               |
|---------|----------------|-------------------------------------|
| 2024.5  | [Fast Track][] | Week commencing 3rd June 2024       |
| 2024.7  | [Release][]    | Week commencing 29th July 2024      |
| 2024.9  | [Fast Track][] | Week commencing 23rd September 2024 |
| 2024.11 | [Fast Track][] | Week commencing 18th November 2024  |

Any changes to these forecasts will be announced via the [News channel][].

[{{% ctx %}} Innovation Core Application]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.MainDoc" version="2024.3" >}}
[{{% ctx %}} API Gateway Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.ApiGatewayService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Authorisation Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.AuthorisationService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Concurrency Management Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.ConcurrencyManagementService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Configuration Management Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.ConfigurationManagementService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Data Storage Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.DataStorageService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Execution Management Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.ExecutionManagementService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Licence Management Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.LicenceManagementService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Package Management Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.PackageManagementService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Provisioning Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.ProvisioningService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Scheduling Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.SchedulingService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Triggers Service]: {{< url path="Cortex.Guides.CortexInnovation.CoreApplication.Services.TriggersService.MainDoc" version="2024.3" >}}
[{{% ctx %}} Innovation Execution Application]: {{< url path="Cortex.Guides.CortexInnovation.ExecutionApplication.MainDoc" version="2024.3" >}}
[{{% ctx %}} Execution Service]: {{< url path="Cortex.Guides.CortexInnovation.ExecutionApplication.Services.ExecutionService.MainDoc" version="2024.3" >}}
[Interaction Portal]: {{< url path="Cortex.Guides.CortexInteractionPortal.MainDoc" version="2024.3" >}}

[Platform Performance Improvements]: {{< ref "#platform-performance-improvements" >}}
[Caching Added to the Provisioning Service]: {{< ref "#caching-added-to-the-provisioning-service" >}}
[HealthCheck Enabled for the Triggers Service after Provisioning]: {{< ref "#healthcheck-enabled-for-the-triggers-service-after-provisioning" >}}
[Load Balancer HealthCheck Improvements]: {{< ref "#load-balancer-healthcheck-improvements" >}}

[A New Platform Property has been Added to Provide more Information in Logs]: {{< ref "#a-new-platform-property-has-been-added-to-provide-more-information-in-logs" >}}
[Request Duration is now Logged in Seconds Instead of Milliseconds]: {{< ref "#request-duration-is-now-logged-in-seconds-instead-of-milliseconds" >}}
[Type and Method Added to Platform Logs]: {{< ref "#type-and-method-added-to-logs" >}}
[Custom Tags can be Passed Through Logs via HTTP Request Headers]: {{< ref "#custom-tags-can-be-passed-through-logs-via-http-request-headers" >}}
[Exception Tags Added to Logs Related to Exceptions or Problem Details]: {{< ref "#exception-tags-added-to-logs-related-to-exceptions" >}}
[Result Tag Updated for API Gateway Service Logs]: {{< ref "#result-tag-updated-for-api-gateway-service-logs" >}}
[Flow Logging Control]: {{< ref "#flow-logging-control" >}}
[Block Logging Control]: {{< ref "#block-logging-control" >}}
[Running Executions can be Viewed in Real-Time]: {{< ref "#running-executions-can-be-viewed-in-real-time" >}}
[Grafana and Promtail Updated to use the New and Updated Log Properties]: {{< ref "#grafana-and-promtail-updated-to-use-the-new-and-updated-log-properties" >}}

[A New Flow Upgrader Tool has been Created to Upgrade Flows]: {{< ref "#a-new-flow-upgrader-tool-has-been-created-to-upgrade-flows" >}}
[A New Single Server Upgrade Script has been Added to the Installation Artefacts]: {{< ref "#a-new-single-server-upgrade-script-has-been-added-to-the-installation-artefacts" >}}
[A New Multi Server Upgrade Script has been Added to the Installation Artefacts]: {{< ref "#a-new-multi-server-upgrade-script-has-been-added-to-the-installation-artefacts" >}}

[Block Icon Redesign]: {{< ref "#block-icon-redesign" >}}

[Improved Blocks]: {{< ref "#improved-blocks" >}}
[Product Portal]: {{< ref "#product-portal" >}}

[Upgrade Instructions]: {{< ref "#upgrade-instructions" >}}
[improved installation]: {{< ref "#improved-installation" >}}
[Potentially Breaking - Platform]: {{< ref "#platform-visibility-1" >}}

[News channel]: {{< url path="Cortex.Blogs.News.MainDoc" >}}

[Blocks]: {{< url path="Cortex.Reference.Blocks.MainDoc" version="2024.3" >}}
[Data Types]: {{< url path="Cortex.Reference.DataTypes.MainDoc" version="2024.3" >}}
[Exceptions]: {{< url path="Cortex.Reference.Exceptions.MainDoc" version="2024.3" >}}

[ExecuteDataCommand]: {{< url path="Cortex.Reference.Blocks.Data.ExecuteDataCommand.ExecuteDataCommand.MainDoc" version="2024.3" >}}

[Innovation Only - Single Server - Without HA]: {{< url path="Cortex.GettingStarted.OnPremise.InstallInnovationOnly.SingleServerWithoutHA.MainDoc" version="2024.3" >}}
[Innovation Only - Multiple Server - With HA]: {{< url path="Cortex.GettingStarted.OnPremise.InstallInnovationOnly.MultipleServerWithHA.MainDoc" version="2024.3" >}}

[Adding Innovation to a 7.2 Installation - Single Server - Without HA]: {{< url path="Cortex.GettingStarted.OnPremise.AddInnovationTo72.SingleServerWithoutHA.MainDoc" version="2024.3" >}}
[Adding Innovation to a 7.2 Installation - Multiple Server - With HA]: {{< url path="Cortex.GettingStarted.OnPremise.AddInnovationTo72.MultipleServerWithHA.MainDoc" version="2024.3" >}}

[Upgrade - Single Server - Without HA]: {{< url path="Cortex.Guides.UpgradeCortex.2024.1to2024.3.SingleServerWithoutHA.MainDoc" version="2024.3" >}}
[Upgrade - Multiple Server - With HA]: {{< url path="Cortex.Guides.UpgradeCortex.2024.1to2024.3.MultipleServerWithHA.MainDoc" version="2024.3" >}}

[{{% ctx %}} Studio]: {{< url path="Cortex.Guides.Studio.MainDoc" version="2024.3" >}}
[Gateway]: {{< url path="Cortex.Guides.Gateway.MainDoc" version="2024.3" >}}
[LogEventBlock]: {{< url path="Cortex.Reference.Blocks.Logs.LogEvent.LogEvent.MainDoc" version="2024.3" >}}

[{{% ctx %}} Service Portal]: {{< url path="Cortex.ServicePortal.MainDoc" version="2024.3" >}}

[Fast Track]: {{< url path="Cortex.Reference.Glossary.F-J.FastTrack" version="2024.3" >}}
[Release]: {{< url path="Cortex.Reference.Glossary.P-T.Release" version="2024.3" >}}

[ProblemDetails]: {{< url path="RFC.ProblemDetails" version="2024.3" >}}
[2024.1]: {{< url path="Cortex.Blogs.Releases.2024.1.MainDoc" version="2024.3" >}}
[OracleParameters]: {{< url path="Cortex.Reference.DataTypes.Data.OracleParameters.MainDoc" >}}
[OracleParameter]: {{< url path="Cortex.Reference.DataTypes.Data.OracleParameter.MainDoc" >}}
